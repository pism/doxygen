<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: src/coupler/ocean/Pico.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0171d4959defe1f65341fde2c6309901.html">coupler</a></li><li class="navelem"><a class="el" href="dir_6e55f98886d6263fe65a923e6d28b13c.html">ocean</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Pico.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Pico_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (C) 2012-2019, 2021 Constantine Khrulev, Ricarda Winkelmann, Ronja Reese, Torsten</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// Albrecht, and Matthias Mengel</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// This file is part of PISM.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// PISM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// terms of the GNU General Public License as published by the Free Software</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Foundation; either version 2 of the License, or (at your option) any later</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// version.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// PISM is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// details.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// along with PISM; if not, write to the Free Software</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// Please cite this model as:</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">// 1.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">// Antarctic sub-shelf melt rates via PICO</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">// R. Reese, T. Albrecht, M. Mengel, X. Asay-Davis and R. Winkelmann</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">// The Cryosphere, 12, 1969-1985, (2018)</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">// DOI: 10.5194/tc-12-1969-2018</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// 2.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// A box model of circulation and melting in ice shelf caverns</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">// D. Olbers &amp; H. Hellmer</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">// Ocean Dynamics (2010), Volume 60, Issue 1, pp 141â€“153</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// DOI: 10.1007/s10236-009-0252-z</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_math.h&gt;</span> <span class="comment">// GSL_NAN</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;pism/coupler/util/options.hh&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;pism/geometry/Geometry.hh&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;pism/util/ConfigInterface.hh&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;pism/util/IceGrid.hh&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;pism/util/Mask.hh&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;pism/util/Time.hh&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;pism/util/Vars.hh&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;pism/util/iceModelVec.hh&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pico_8hh.html">Pico.hh</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PicoGeometry_8hh.html">PicoGeometry.hh</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PicoPhysics_8hh.html">PicoPhysics.hh</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepism.html">pism</a> {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepism_1_1mask_af201676abc8faf30d74dd8fc50b60942.html#af201676abc8faf30d74dd8fc50b60942">ocean</a> {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a23dfe83390c7326c1f1ca27fd17ede43.html#a23dfe83390c7326c1f1ca27fd17ede43">   51</a></span>&#160;<a class="code" href="classpism_1_1ocean_1_1Pico_a23dfe83390c7326c1f1ca27fd17ede43.html#a23dfe83390c7326c1f1ca27fd17ede43">Pico::Pico</a>(<a class="code" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a> grid)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  : <a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel.html">CompleteOceanModel</a>(grid, std::shared_ptr&lt;<a class="code" href="classpism_1_1ocean_1_1OceanModel.html">OceanModel</a>&gt;()),</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    m_Soc(m_grid, <span class="stringliteral">&quot;pico_salinity&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    m_Soc_box0(m_grid, <span class="stringliteral">&quot;pico_salinity_box0&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    m_Toc(m_grid, <span class="stringliteral">&quot;pico_temperature&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    m_Toc_box0(m_grid, <span class="stringliteral">&quot;pico_temperature_box0&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    m_T_star(m_grid, <span class="stringliteral">&quot;pico_T_star&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    m_overturning(m_grid, <span class="stringliteral">&quot;pico_overturning&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    m_basal_melt_rate(m_grid, <span class="stringliteral">&quot;pico_basal_melt_rate&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">WITH_GHOSTS</a>),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    m_geometry(grid),</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    m_n_basins(0),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    m_n_boxes(0),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    m_n_shelves(0) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="structpism_1_1ForcingOptions.html">ForcingOptions</a> opt(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;ctx(), <span class="stringliteral">&quot;ocean.pico&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">auto</span> buffer_size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;input.forcing.buffer_size&quot;</span>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classpism_1_1File.html">File</a> file(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, opt.<a class="code" href="structpism_1_1ForcingOptions_a5a9f2c92cf9f433d66e67ea0bd9fa810.html#a5a9f2c92cf9f433d66e67ea0bd9fa810">filename</a>, <a class="code" href="namespacepism_a976f562815a4de361bb1474e03db50d7.html#a976f562815a4de361bb1474e03db50d7a9a7c1c8a7a0101aa5968351fe1f6481a">PISM_NETCDF3</a>, <a class="code" href="namespacepism_aa10f25436946de00942fa3e84be9daf5.html#aa10f25436946de00942fa3e84be9daf5ac6201c2d87c567fd609d24016ecf2d49">PISM_READONLY</a>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a> = <a class="code" href="classpism_1_1IceModelVec2T_a386db681cacb1d187123dae4139570bc.html#a386db681cacb1d187123dae4139570bc">IceModelVec2T::ForcingField</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>,</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                                                file,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                                <span class="stringliteral">&quot;theta_ocean&quot;</span>,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                                <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// no standard name</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                buffer_size,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                                                opt.<a class="code" href="structpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717.html#a8950d4d2c7f8e49adff11b121573b717">periodic</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                <a class="code" href="namespacepism_ae50e2208404456d7dcfdca1da2484d23.html#ae50e2208404456d7dcfdca1da2484d23aa03926dd636ce1d977b1a8a9ed608c85">LINEAR</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a> = <a class="code" href="classpism_1_1IceModelVec2T_a386db681cacb1d187123dae4139570bc.html#a386db681cacb1d187123dae4139570bc">IceModelVec2T::ForcingField</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                                                   file,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                                   <span class="stringliteral">&quot;salinity_ocean&quot;</span>,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                                   <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// no standard name</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                                   buffer_size,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                                   opt.<a class="code" href="structpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717.html#a8950d4d2c7f8e49adff11b121573b717">periodic</a>,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                                   <a class="code" href="namespacepism_ae50e2208404456d7dcfdca1da2484d23.html#ae50e2208404456d7dcfdca1da2484d23aa03926dd636ce1d977b1a8a9ed608c85">LINEAR</a>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;set_attrs(<span class="stringliteral">&quot;climate_forcing&quot;</span>,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                           <span class="stringliteral">&quot;potential temperature of the adjacent ocean&quot;</span>,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                           <span class="stringliteral">&quot;Kelvin&quot;</span>, <span class="stringliteral">&quot;Kelvin&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;set_attrs(<span class="stringliteral">&quot;climate_forcing&quot;</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                              <span class="stringliteral">&quot;salinity of the adjacent ocean&quot;</span>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                              <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// computed salinity in ocean boxes</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;ocean salinity field&quot;</span>,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                  <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;ocean salinity field&quot;</span>, 0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// salinity input for box 1</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;ocean base salinity field&quot;</span>,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                       <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;g/kg&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">// computed temperature in ocean boxes</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;ocean temperature field&quot;</span>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                  <span class="stringliteral">&quot;K&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// temperature input for box 1</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;ocean base temperature&quot;</span>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                       <span class="stringliteral">&quot;K&quot;</span>, <span class="stringliteral">&quot;K&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;T_star field&quot;</span>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                     <span class="stringliteral">&quot;degree C&quot;</span>, <span class="stringliteral">&quot;degree C&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;cavity overturning&quot;</span>,</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                          <span class="stringliteral">&quot;m^3 s-1&quot;</span>, <span class="stringliteral">&quot;m^3 s-1&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>.<a class="code" href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">set_attrs</a>(<span class="stringliteral">&quot;model_state&quot;</span>, <span class="stringliteral">&quot;PICO sub-shelf melt rate&quot;</span>,</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                              <span class="stringliteral">&quot;m s-1&quot;</span>, <span class="stringliteral">&quot;m year-1&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>-&gt;metadata()[<span class="stringliteral">&quot;_FillValue&quot;</span>] = {0.0};</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ac66ebac084be47bbc824c91ccfac5f22.html#ac66ebac084be47bbc824c91ccfac5f22">m_n_boxes</a>  = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;ocean.pico.number_of_boxes&quot;</span>));</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_ada110aa8fbb292682dc1a3571b9b0a32.html#ada110aa8fbb292682dc1a3571b9b0a32">  134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_ada110aa8fbb292682dc1a3571b9b0a32.html#ada110aa8fbb292682dc1a3571b9b0a32">Pico::init_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1Geometry.html">Geometry</a> &amp;geometry) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  (void) geometry;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;* Initializing the Potsdam Ice-shelf Cavity mOdel for the ocean ...\n&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="structpism_1_1ForcingOptions.html">ForcingOptions</a> opt(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;ctx(), <span class="stringliteral">&quot;ocean.pico&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;init(opt.<a class="code" href="structpism_1_1ForcingOptions_a5a9f2c92cf9f433d66e67ea0bd9fa810.html#a5a9f2c92cf9f433d66e67ea0bd9fa810">filename</a>, opt.<a class="code" href="structpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717.html#a8950d4d2c7f8e49adff11b121573b717">periodic</a>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;init(opt.<a class="code" href="structpism_1_1ForcingOptions_a5a9f2c92cf9f433d66e67ea0bd9fa810.html#a5a9f2c92cf9f433d66e67ea0bd9fa810">filename</a>, opt.<a class="code" href="structpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717.html#a8950d4d2c7f8e49adff11b121573b717">periodic</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// This initializes the basin_mask</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a54267be1232c83aa000a2431f63749fa.html#a54267be1232c83aa000a2431f63749fa">init</a>(geometry.<a class="code" href="classpism_1_1Geometry_a6703744654fe7c676c448fbd2bd96372.html#a6703744654fe7c676c448fbd2bd96372">cell_type</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// FIXME: m_n_basins is a misnomer</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">max</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>())) + 1;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(4, <span class="stringliteral">&quot;PICO basin min=%f, max=%f\n&quot;</span>,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                 <a class="code" href="namespacepism_a9f181807bb07f129ee1ed1bc0508b7ee.html#a9f181807bb07f129ee1ed1bc0508b7ee">min</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>()),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                 <a class="code" href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">max</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>()));</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> physics(*<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;  -Using %d drainage basins and values: \n&quot;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <span class="stringliteral">&quot;   gamma_T= %.2e, overturning_coeff = %.2e... \n&quot;</span>,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a2f0ed0e4bc30938815c3da9b44c98c93.html#a2f0ed0e4bc30938815c3da9b44c98c93">gamma_T</a>(), physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a1af5188d6a5ca7909af42435d6f9209c.html#a1af5188d6a5ca7909af42435d6f9209c">overturning_coeff</a>());</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;  -Depth of continental shelf for computation of temperature and salinity input\n&quot;</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    <span class="stringliteral">&quot;   is set for whole domain to continental_shelf_depth=%.0f meter\n&quot;</span>,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                 physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a5ec8e74d0bbac3a7422954b7d52ca418.html#a5ec8e74d0bbac3a7422954b7d52ca418">continental_shelf_depth</a>());</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="comment">// read time-independent data right away:</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;buffer_size() == 1 and <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;buffer_size() == 1) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;update(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;ctx()-&gt;time()-&gt;current(), 0.0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;update(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;ctx()-&gt;time()-&gt;current(), 0.0);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordtype">double</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    ice_density   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.ice.density&quot;</span>),</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    water_density = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.sea_water.density&quot;</span>),</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>             = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.standard_gravity&quot;</span>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1OceanModel_a984ce69fa967ab45645647ab70f5a5f9.html#a984ce69fa967ab45645647ab70f5a5f9">compute_average_water_column_pressure</a>(geometry, ice_density, water_density, <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                        *<a class="code" href="classpism_1_1ocean_1_1OceanModel_a45913c628d6292edfd0f6344d79a7310.html#a45913c628d6292edfd0f6344d79a7310">m_water_column_pressure</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a7e51acb0ca855bd39cef93e5e9187554.html#a7e51acb0ca855bd39cef93e5e9187554">  179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a7e51acb0ca855bd39cef93e5e9187554.html#a7e51acb0ca855bd39cef93e5e9187554">Pico::define_model_state_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1File.html">File</a> &amp;output)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>().<a class="code" href="classpism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1.html#aa3a14430024efdba57118b95701484c1">define</a>(output);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1.html#aa3a14430024efdba57118b95701484c1">define</a>(output);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1.html#aa3a14430024efdba57118b95701484c1">define</a>(output);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1.html#aa3a14430024efdba57118b95701484c1">define</a>(output);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1OceanModel_a4532704c3d2917325a12750993e91779.html#a4532704c3d2917325a12750993e91779">OceanModel::define_model_state_impl</a>(output);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a5c62a82d203166de3f2ce56d70708b34.html#a5c62a82d203166de3f2ce56d70708b34">  189</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a5c62a82d203166de3f2ce56d70708b34.html#a5c62a82d203166de3f2ce56d70708b34">Pico::write_model_state_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1File.html">File</a> &amp;output)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>().<a class="code" href="classpism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574.html#aa51ad1c4387a5ea7cc4e2c0e94275574">write</a>(output);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574.html#aa51ad1c4387a5ea7cc4e2c0e94275574">write</a>(output);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>.<a class="code" href="classpism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574.html#aa51ad1c4387a5ea7cc4e2c0e94275574">write</a>(output);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574.html#aa51ad1c4387a5ea7cc4e2c0e94275574">write</a>(output);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1OceanModel_ab76f93a78d9202d2ab52b28079d9d0c3.html#ab76f93a78d9202d2ab52b28079d9d0c3">OceanModel::write_model_state_impl</a>(output);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">* Extend basal melt rates to grounded and ocean neighbors for consitency with subgl_melt.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">* Note that melt rates are then simply interpolated into partially floating cells, they</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">* are not included in the calculations of PICO.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="namespacepism_1_1ocean_ae05300cafae71ac5e2fbf4ce81ee763d.html#ae05300cafae71ac5e2fbf4ce81ee763d">  204</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="namespacepism_1_1ocean_ae05300cafae71ac5e2fbf4ce81ee763d.html#ae05300cafae71ac5e2fbf4ce81ee763d">extend_basal_melt_rates</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;cell_type,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                    <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keyword">auto</span> grid = basal_melt_rate.<a class="code" href="classpism_1_1IceModelVec_a7ec09c4ef26812d2a16d81db42f6b852.html#a7ec09c4ef26812d2a16d81db42f6b852">grid</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{&amp;cell_type, &amp;basal_melt_rate};</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*grid); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keyword">auto</span> M = cell_type.<a class="code" href="classpism_1_1IceModelVec2Int_a56178422403c26269619d01ded1716e4.html#a56178422403c26269619d01ded1716e4">box</a>(i, j);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordtype">bool</span> potential_partially_filled_cell =</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      ((M.ij == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9aeed831165149ebb8bf3426f0ace4a6c2">MASK_GROUNDED</a> or M.ij == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">MASK_ICE_FREE_OCEAN</a>) and</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;       (M.w  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or M.e  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        M.s  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or M.n  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        M.sw == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or M.nw == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        M.se == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> or M.ne == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a>));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (potential_partially_filled_cell) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keyword">auto</span> BMR = basal_melt_rate.<a class="code" href="classpism_1_1IceModelVec2S_a6f4c01a809febc2ca71158798285ee4e.html#a6f4c01a809febc2ca71158798285ee4e">box</a>(i, j);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordtype">int</span> N = 0;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordtype">double</span> melt_sum = 0.0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      melt_sum += M.nw == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.nw) : 0.0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      melt_sum += M.n  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.n)  : 0.0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      melt_sum += M.ne == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.ne) : 0.0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      melt_sum += M.e  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.e)  : 0.0;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      melt_sum += M.se == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.se) : 0.0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      melt_sum += M.s  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.s)  : 0.0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      melt_sum += M.sw == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.sw) : 0.0;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      melt_sum += M.w  == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> ? (++N, BMR.w)  : 0.0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (N != 0) { <span class="comment">// If there are floating neigbors, return average melt rates</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        basal_melt_rate(i, j) = melt_sum / N;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  } <span class="comment">// end of the loop over grid points</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a8b33ff5b2b9cef7abdf4ff49c53970c7.html#a8b33ff5b2b9cef7abdf4ff49c53970c7">  246</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a8b33ff5b2b9cef7abdf4ff49c53970c7.html#a8b33ff5b2b9cef7abdf4ff49c53970c7">Pico::update_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1Geometry.html">Geometry</a> &amp;geometry, <span class="keywordtype">double</span> t, <span class="keywordtype">double</span> dt) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;update(t, dt);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;update(t, dt);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>-&gt;average(t, dt);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>-&gt;average(t, dt);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// set values that will be used outside of floating ice areas</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">double</span> T_fill_value   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.fresh_water.melting_point_temperature&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">double</span> Toc_fill_value = <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a.html#a6c4ef010242e1a405186e8666345c17a">get_number</a>(<span class="stringliteral">&quot;_FillValue&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">double</span> Soc_fill_value = <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a.html#a6c4ef010242e1a405186e8666345c17a">get_number</a>(<span class="stringliteral">&quot;_FillValue&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordtype">double</span> M_fill_value   = <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a.html#a6c4ef010242e1a405186e8666345c17a">get_number</a>(<span class="stringliteral">&quot;_FillValue&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">double</span> O_fill_value   = <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a.html#a6c4ef010242e1a405186e8666345c17a">get_number</a>(<span class="stringliteral">&quot;_FillValue&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>-&gt;set(T_fill_value);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>.<a class="code" href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">set</a>(M_fill_value);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>.<a class="code" href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">set</a>(Toc_fill_value);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>.<a class="code" href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">set</a>(Soc_fill_value);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>.<a class="code" href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">set</a>(O_fill_value);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>.<a class="code" href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">set</a>(Toc_fill_value);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> physics(*<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness    = geometry.<a class="code" href="classpism_1_1Geometry_aeb24ce2e2ebe25d9df3065e7f81129e2.html#aeb24ce2e2ebe25d9df3065e7f81129e2">ice_thickness</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;cell_type = geometry.<a class="code" href="classpism_1_1Geometry_a6703744654fe7c676c448fbd2bd96372.html#a6703744654fe7c676c448fbd2bd96372">cell_type</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;bed_elevation    = geometry.<a class="code" href="classpism_1_1Geometry_a833ba4c25c003f5b37e93692cf9a8e56.html#a833ba4c25c003f5b37e93692cf9a8e56">bed_elevation</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// Geometric part of PICO</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_aa7fb8e10a6464f8a02ad1d7e92e65c5d.html#aa7fb8e10a6464f8a02ad1d7e92e65c5d">update</a>(bed_elevation, cell_type);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">// FIXME: m_n_shelves is not really the number of shelves.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">max</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>())) + 1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// Physical part of PICO</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// prepare ocean input temperature and salinity</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      std::vector&lt;double&gt; basin_temperature(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      std::vector&lt;double&gt; basin_salinity(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <a class="code" href="classpism_1_1ocean_1_1Pico_afd7f982d264e27182f0542d24e77c2a5.html#afd7f982d264e27182f0542d24e77c2a5">compute_ocean_input_per_basin</a>(physics,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                    <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>(),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                    <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a10151c037768ac889f7dcec96a8f1192.html#a10151c037768ac889f7dcec96a8f1192">continental_shelf_mask</a>(),</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                    *<a class="code" href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">m_salinity_ocean</a>,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                    *<a class="code" href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">m_theta_ocean</a>,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                    basin_temperature,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                    basin_salinity); <span class="comment">// per basin</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="classpism_1_1ocean_1_1Pico_a6b110bbe1316b217ceb3e2a819f13bab.html#a6b110bbe1316b217ceb3e2a819f13bab">set_ocean_input_fields</a>(physics,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                             ice_thickness,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                             cell_type,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                             <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>(),</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                             <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>(),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                             basin_temperature,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                             basin_salinity,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                             <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                             <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>); <span class="comment">// per shelf</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// Use the Beckmann-Goosse parameterization to set reasonable values throughout the</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// domain.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a787feae4282bd62ce60902c605c1b510.html#a787feae4282bd62ce60902c605c1b510">beckmann_goosse</a>(physics,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    ice_thickness,                <span class="comment">// input</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>(), <span class="comment">// input</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    cell_type,                    <span class="comment">// input</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>,                   <span class="comment">// input</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>,                   <span class="comment">// input</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    *<a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>,</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                    <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// In ice shelves, replace Beckmann-Goosse values using the Olbers and Hellmer model.</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a0a5db8c24da1e538420d8107c3d5b3a3.html#a0a5db8c24da1e538420d8107c3d5b3a3">process_box1</a>(physics,</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                 ice_thickness,                             <span class="comment">// input</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>(),              <span class="comment">// input</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_add7578365befdd60d228e295e0c8d252.html#add7578365befdd60d228e295e0c8d252">box_mask</a>(),                    <span class="comment">// input</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>,                                <span class="comment">// input</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>,                                <span class="comment">// input</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                 *<a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>,</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                 <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_af9b4ef432b4f97387a92ffc5c7cf5e23.html#af9b4ef432b4f97387a92ffc5c7cf5e23">process_other_boxes</a>(physics,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                        ice_thickness,                <span class="comment">// input</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>(), <span class="comment">// input</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_add7578365befdd60d228e295e0c8d252.html#add7578365befdd60d228e295e0c8d252">box_mask</a>(),       <span class="comment">// input</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        *<a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                        <a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="namespacepism_1_1ocean_ae05300cafae71ac5e2fbf4ce81ee763d.html#ae05300cafae71ac5e2fbf4ce81ee763d">extend_basal_melt_rates</a>(cell_type, <a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_a29087754df7e937d733813a087f94dea.html#a29087754df7e937d733813a087f94dea">m_shelf_base_mass_flux</a>-&gt;copy_from(<a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_a29087754df7e937d733813a087f94dea.html#a29087754df7e937d733813a087f94dea">m_shelf_base_mass_flux</a>-&gt;scale(physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a1e61e091c19e2e416ab4b3a4f8a67b42.html#a1e61e091c19e2e416ab4b3a4f8a67b42">ice_density</a>());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">double</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    ice_density   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.ice.density&quot;</span>),</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    water_density = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.sea_water.density&quot;</span>),</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>             = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.standard_gravity&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1OceanModel_a984ce69fa967ab45645647ab70f5a5f9.html#a984ce69fa967ab45645647ab70f5a5f9">compute_average_water_column_pressure</a>(geometry, ice_density, water_density, <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>,</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                        *<a class="code" href="classpism_1_1ocean_1_1OceanModel_a45913c628d6292edfd0f6344d79a7310.html#a45913c628d6292edfd0f6344d79a7310">m_water_column_pressure</a>);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a66785728fa968676f668b608e689dc5d.html#a66785728fa968676f668b608e689dc5d">  362</a></span>&#160;<a class="code" href="classpism_1_1MaxTimestep.html">MaxTimestep</a> <a class="code" href="classpism_1_1ocean_1_1Pico_a66785728fa968676f668b608e689dc5d.html#a66785728fa968676f668b608e689dc5d">Pico::max_timestep_impl</a>(<span class="keywordtype">double</span> t)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  (void) t;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1MaxTimestep.html">MaxTimestep</a>(<span class="stringliteral">&quot;ocean pico&quot;</span>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">//! Compute temperature and salinity input from ocean data by averaging.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//! We average the ocean data over the continental shelf reagion for each basin.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//! We use dummy ocean data if no such average can be calculated.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_afd7f982d264e27182f0542d24e77c2a5.html#afd7f982d264e27182f0542d24e77c2a5">  375</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_afd7f982d264e27182f0542d24e77c2a5.html#afd7f982d264e27182f0542d24e77c2a5">Pico::compute_ocean_input_per_basin</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> &amp;physics,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;basin_mask,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;continental_shelf_mask,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;salinity_ocean,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                         <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;theta_ocean,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                         std::vector&lt;double&gt; &amp;temperature,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                         std::vector&lt;double&gt; &amp;salinity)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  std::vector&lt;int&gt; <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// additional vectors to allreduce efficiently with IntelMPI</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  std::vector&lt;int&gt; countr(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  std::vector&lt;double&gt; salinityr(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  std::vector&lt;double&gt; temperaturer(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  temperature.resize(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  salinity.resize(<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> basin_id = 0; basin_id &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>; basin_id++) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    temperature[basin_id] = 0.0;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    salinity[basin_id]    = 0.0;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;theta_ocean, &amp;salinity_ocean, &amp;basin_mask, &amp;continental_shelf_mask };</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// compute the sum for each basin for region that intersects with the continental shelf</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// area and is not covered by an ice shelf. (continental shelf mask excludes ice shelf</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// areas)</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (continental_shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == 2) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordtype">int</span> basin_id = basin_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>[basin_id] += 1;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      salinity[basin_id] += salinity_ocean(i, j);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      temperature[basin_id] += theta_ocean(i, j);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// Divide by number of grid cells if more than zero cells belong to the basin. if no</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="comment">// ocean_contshelf_mask values intersect with the basin, count is zero. In such case,</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">// use dummy temperature and salinity. This could happen, for example, if the ice shelf</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="comment">// front advances beyond the continental shelf break.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>.data(), countr.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, salinity.data(), salinityr.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, temperature.data(), temperaturer.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// copy values</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>       = countr;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  salinity    = salinityr;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  temperature = temperaturer;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="comment">// &quot;dummy&quot; basin</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    temperature[0] = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_af935f34e21724796bec07643087ec105.html#af935f34e21724796bec07643087ec105">T_dummy</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    salinity[0]    = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a26f6621612f26b2f881b2ed7be2c826b.html#a26f6621612f26b2f881b2ed7be2c826b">S_dummy</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> basin_id = 1; basin_id &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>; basin_id++) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>[basin_id] != 0) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      salinity[basin_id] /= <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>[basin_id];</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      temperature[basin_id] /= <a class="code" href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a>[basin_id];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(5, <span class="stringliteral">&quot;  %d: temp =%.3f, salinity=%.3f\n&quot;</span>, basin_id, temperature[basin_id], salinity[basin_id]);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;PICO ocean WARNING: basin %d contains no cells with ocean data on continental shelf\n&quot;</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <span class="stringliteral">&quot;(no values with ocean_contshelf_mask=2).\n&quot;</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                        <span class="stringliteral">&quot;No mean salinity or temperature values are computed, instead using\n&quot;</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        <span class="stringliteral">&quot;the standard values T_dummy =%.3f, S_dummy=%.3f.\n&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                        <span class="stringliteral">&quot;This might bias your basal melt rates, check your input data carefully.\n&quot;</span>,</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                     basin_id, physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_af935f34e21724796bec07643087ec105.html#af935f34e21724796bec07643087ec105">T_dummy</a>(), physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a26f6621612f26b2f881b2ed7be2c826b.html#a26f6621612f26b2f881b2ed7be2c826b">S_dummy</a>());</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      temperature[basin_id] = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_af935f34e21724796bec07643087ec105.html#af935f34e21724796bec07643087ec105">T_dummy</a>();</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      salinity[basin_id]    = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a26f6621612f26b2f881b2ed7be2c826b.html#a26f6621612f26b2f881b2ed7be2c826b">S_dummy</a>();</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">//! Set ocean ocean input from box 0 as boundary condition for box 1.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">//! Set ocean temperature and salinity (Toc_box0, Soc_box0)</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">//! from box 0 (in front of the ice shelf) as inputs for</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">//! box 1, which is the ocean box adjacent to the grounding line.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">//!</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">//! We enforce that Toc_box0 is always at least the local pressure melting point.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a6b110bbe1316b217ceb3e2a819f13bab.html#a6b110bbe1316b217ceb3e2a819f13bab">  459</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a6b110bbe1316b217ceb3e2a819f13bab.html#a6b110bbe1316b217ceb3e2a819f13bab">Pico::set_ocean_input_fields</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> &amp;physics,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;mask,</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;basin_mask,</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;basin_temperature,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                  <span class="keyword">const</span> std::vector&lt;double&gt; &amp;basin_salinity,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                                  <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc_box0,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                  <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc_box0)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;ice_thickness, &amp;basin_mask, &amp;Soc_box0, &amp;Toc_box0, &amp;mask, &amp;shelf_mask };</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  std::vector&lt;int&gt; n_shelf_cells_per_basin(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a> * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  std::vector&lt;int&gt; n_shelf_cells(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  std::vector&lt;int&gt; cfs_in_basins_per_shelf(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a> * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">// additional vectors to allreduce efficiently with IntelMPI</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  std::vector&lt;int&gt; n_shelf_cells_per_basinr(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a> * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  std::vector&lt;int&gt; n_shelf_cellsr(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  std::vector&lt;int&gt; cfs_in_basins_per_shelfr(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a> * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>, 0);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">// 1) count the number of cells in each shelf</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">// 2) count the number of cells in the intersection of each shelf with all the basins</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordtype">int</span> s = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordtype">int</span> b = basin_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      n_shelf_cells_per_basin[s*<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>+b]++;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      n_shelf_cells[s]++;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="comment">// find all basins b, in which the ice shelf s has a calving front with potential ocean water intrusion</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordflow">if</span> (mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a>) {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="keyword">auto</span> M = mask.<a class="code" href="classpism_1_1IceModelVec2Int_a9765aea19a56e73b3089131d61c1f049.html#a9765aea19a56e73b3089131d61c1f049">star</a>(i, j);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">if</span> (M.n == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">MASK_ICE_FREE_OCEAN</a> or</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;            M.e == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">MASK_ICE_FREE_OCEAN</a> or</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;            M.s == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">MASK_ICE_FREE_OCEAN</a> or</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            M.w == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">MASK_ICE_FREE_OCEAN</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="keywordflow">if</span> (cfs_in_basins_per_shelf[s * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a> + b] != b) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            cfs_in_basins_per_shelf[s * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a> + b] = b;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, n_shelf_cells.data(),</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;              n_shelf_cellsr.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, n_shelf_cells_per_basin.data(),</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;              n_shelf_cells_per_basinr.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>*<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, cfs_in_basins_per_shelf.data(),</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;              cfs_in_basins_per_shelfr.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>*<a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="comment">// copy data</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    n_shelf_cells = n_shelf_cellsr;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    n_shelf_cells_per_basin = n_shelf_cells_per_basinr;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    cfs_in_basins_per_shelf = cfs_in_basins_per_shelfr;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>; s++) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 0; b &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>; b++) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">int</span> sb = s * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a> + b;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="comment">// remove ice shelf parts from the count that do not have a calving front in that basin</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (n_shelf_cells_per_basin[sb] &gt; 0 and cfs_in_basins_per_shelf[sb] == 0) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;          n_shelf_cells[s] -= n_shelf_cells_per_basin[sb];</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;          n_shelf_cells_per_basin[sb] = 0;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// now set potential temperature and salinity box 0:</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">int</span> low_temperature_counter = 0;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// make sure all temperatures are zero at the beginning of each time step</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    Toc_box0(i, j) = 0.0; <span class="comment">// in K</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    Soc_box0(i, j) = 0.0; <span class="comment">// in psu</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordtype">int</span> s = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> (mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == <a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">MASK_FLOATING</a> and s &gt; 0) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">// note: shelf_mask = 0 in lakes</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      assert(n_shelf_cells[s] &gt; 0);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordtype">double</span> N = <a class="code" href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">std::max</a>(n_shelf_cells[s], 1); <span class="comment">// protect from division by zero</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="comment">// weighted input depending on the number of shelf cells in each basin</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b = 1; b &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a>; b++) { <span class="comment">//Note: b=0 yields nan</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordtype">int</span> sb = s * <a class="code" href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">m_n_basins</a> + b;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        Toc_box0(i, j) += basin_temperature[b] * n_shelf_cells_per_basin[sb] / N;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        Soc_box0(i, j) += basin_salinity[b] * n_shelf_cells_per_basin[sb] / N;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordtype">double</span> theta_pm = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0.html#a98d996a8f2960ab03232f342875c09c0">theta_pm</a>(Soc_box0(i, j), physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa.html#a0fab19a2c030fc9132e351b807dd78aa">pressure</a>(ice_thickness(i, j)));</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="comment">// temperature input for grounding line box should not be below pressure melting point</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="keywordflow">if</span> (Toc_box0(i, j) &lt; theta_pm) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> eps = 0.001;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <span class="comment">// Setting Toc_box0 a little higher than theta_pm ensures that later equations are</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <span class="comment">// well solvable.</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        Toc_box0(i, j) = theta_pm + eps;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        low_temperature_counter += 1;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  low_temperature_counter = <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, low_temperature_counter);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">if</span> (low_temperature_counter &gt; 0) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;PICO ocean warning: temperature has been below pressure melting temperature in %d cases,\n&quot;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                      <span class="stringliteral">&quot;setting it to pressure melting temperature\n&quot;</span>,</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                   low_temperature_counter);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> * Use the simpler parameterization due to [@ref BeckmannGoosse2003] to set default</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"> * sub-shelf temperature and melt rate values.</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"> * At grid points containing floating ice not connected to the ocean, set the basal melt</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"> * rate to zero and set basal temperature to the pressure melting point.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a787feae4282bd62ce60902c605c1b510.html#a787feae4282bd62ce60902c605c1b510">  579</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a787feae4282bd62ce60902c605c1b510.html#a787feae4282bd62ce60902c605c1b510">Pico::beckmann_goosse</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> &amp;physics,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness,</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;cell_type,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc_box0,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc_box0,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                           <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                           <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_temperature,</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                           <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                           <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> T0          = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.fresh_water.melting_point_temperature&quot;</span>),</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;               <a class="code" href="exactTestO_8c_a852651988df354c0e9f4d1db835a5c45.html#a852651988df354c0e9f4d1db835a5c45">beta_CC</a>     = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.ice.beta_Clausius_Clapeyron&quot;</span>),</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;               <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>           = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.standard_gravity&quot;</span>),</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;               ice_density = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.ice.density&quot;</span>);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;ice_thickness, &amp;cell_type, &amp;shelf_mask,      &amp;Toc_box0,          &amp;Soc_box0,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                &amp;Toc,           &amp;Soc,       &amp;basal_melt_rate, &amp;basal_temperature };</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (cell_type.<a class="code" href="classpism_1_1IceModelVec2CellType_aa12e8ff430a67373fa483e1c1538d154.html#aa12e8ff430a67373fa483e1c1538d154">floating_ice</a>(i, j)) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">if</span> (shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) &gt; 0) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordtype">double</span> pressure = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa.html#a0fab19a2c030fc9132e351b807dd78aa">pressure</a>(ice_thickness(i, j));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        basal_melt_rate(i, j) =</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_aaf8668386641c3989e558e00867d2280.html#aaf8668386641c3989e558e00867d2280">melt_rate_beckmann_goosse</a>(physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0.html#a98d996a8f2960ab03232f342875c09c0">theta_pm</a>(Soc_box0(i, j), pressure), Toc_box0(i, j));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        basal_temperature(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_aa89c9fd2375df7d727bfd29a9362a904.html#aa89c9fd2375df7d727bfd29a9362a904">T_pm</a>(Soc_box0(i, j), pressure);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// diagnostic outputs</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        Toc(i, j) = Toc_box0(i, j); <span class="comment">// in Kelvin</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        Soc(i, j) = Soc_box0(i, j); <span class="comment">// in psu</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="comment">// Floating ice cells not connected to the ocean.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> pressure = ice_density * <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a> * ice_thickness(i, j); <span class="comment">// FIXME issue #15</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        basal_temperature(i, j) = T0 - <a class="code" href="exactTestO_8c_a852651988df354c0e9f4d1db835a5c45.html#a852651988df354c0e9f4d1db835a5c45">beta_CC</a> * pressure;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        basal_melt_rate(i, j)   = 0.0;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;}</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a0a5db8c24da1e538420d8107c3d5b3a3.html#a0a5db8c24da1e538420d8107c3d5b3a3">  624</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a0a5db8c24da1e538420d8107c3d5b3a3.html#a0a5db8c24da1e538420d8107c3d5b3a3">Pico::process_box1</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> &amp;physics,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;box_mask,</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc_box0,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc_box0,</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_temperature,</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;T_star,</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                        <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;overturning) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  std::vector&lt;double&gt; box1_area(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170.html#a206668d50c0c650ff4ca9d5fa3001170">compute_box_area</a>(1, shelf_mask, box_mask, box1_area);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;ice_thickness, &amp;shelf_mask, &amp;box_mask,    &amp;T_star,          &amp;Toc_box0,          &amp;Toc,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                &amp;Soc_box0,      &amp;Soc,        &amp;overturning, &amp;basal_melt_rate, &amp;basal_temperature };</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordtype">int</span> n_Toc_failures = 0;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// basal melt rate, ambient temperature and salinity and overturning calculation</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// for each box1 grid cell.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">int</span> shelf_id = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (box_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == 1 and shelf_id &gt; 0) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> pressure = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa.html#a0fab19a2c030fc9132e351b807dd78aa">pressure</a>(ice_thickness(i, j));</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      T_star(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_ab052ea1cf9785562ff798247f4016417.html#ab052ea1cf9785562ff798247f4016417">T_star</a>(Soc_box0(i, j), Toc_box0(i, j), pressure);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="keyword">auto</span> Toc_box1 = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a2c860c4d55702326f0bc687a292c7a3c.html#a2c860c4d55702326f0bc687a292c7a3c">Toc_box1</a>(box1_area[shelf_id], T_star(i, j), Soc_box0(i, j), Toc_box0(i, j));</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="comment">// This can only happen if T_star &gt; 0.25*p_coeff, in particular T_star &gt; 0</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="comment">// which can only happen for values of Toc_box0 close to the local pressure melting point</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      <span class="keywordflow">if</span> (Toc_box1.failed) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(5, <span class="stringliteral">&quot;PICO ocean WARNING: negative square root argument at %d, %d\n&quot;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                          <span class="stringliteral">&quot;probably because of positive T_star=%f \n&quot;</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                          <span class="stringliteral">&quot;Not aborting, but setting square root to 0... \n&quot;</span>,</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                       i, j, T_star(i, j));</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        n_Toc_failures += 1;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      Toc(i, j) = Toc_box1.value;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      Soc(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a9edaeb7fc627389b6798aaa18de930f7.html#a9edaeb7fc627389b6798aaa18de930f7">Soc_box1</a>(Toc_box0(i, j), Soc_box0(i, j), Toc(i, j)); <span class="comment">// in psu</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      overturning(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a78309d820f3c0f6f942af229d2890b42.html#a78309d820f3c0f6f942af229d2890b42">overturning</a>(Soc_box0(i, j), Soc(i, j), Toc_box0(i, j), Toc(i, j));</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="comment">// main outputs</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      basal_melt_rate(i, j)    = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a75a91eaa2242f80e2b03300d215cbc88.html#a75a91eaa2242f80e2b03300d215cbc88">melt_rate</a>(physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0.html#a98d996a8f2960ab03232f342875c09c0">theta_pm</a>(Soc(i, j), pressure), Toc(i, j));</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      basal_temperature(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_aa89c9fd2375df7d727bfd29a9362a904.html#aa89c9fd2375df7d727bfd29a9362a904">T_pm</a>(Soc(i, j), pressure);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  n_Toc_failures = <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, n_Toc_failures);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="keywordflow">if</span> (n_Toc_failures &gt; 0) {</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;PICO ocean warning: square-root argument for temperature calculation &quot;</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                      <span class="stringliteral">&quot;has been negative in %d cases!\n&quot;</span>,</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                   n_Toc_failures);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_af9b4ef432b4f97387a92ffc5c7cf5e23.html#af9b4ef432b4f97387a92ffc5c7cf5e23">  691</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_af9b4ef432b4f97387a92ffc5c7cf5e23.html#af9b4ef432b4f97387a92ffc5c7cf5e23">Pico::process_other_boxes</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1ocean_1_1PicoPhysics.html">PicoPhysics</a> &amp;physics,</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness,</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;box_mask,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                               <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                               <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_temperature,</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                               <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;T_star,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                               <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Toc,</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                               <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Soc)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  std::vector&lt;double&gt; overturning(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0.0);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  std::vector&lt;double&gt; salinity(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0.0);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  std::vector&lt;double&gt; temperature(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0.0);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">// get average overturning from box 1 that is used as input later</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  <a class="code" href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">compute_box_average</a>(1, <a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>, shelf_mask, box_mask, overturning);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  std::vector&lt;bool&gt; use_beckmann_goosse(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;ice_thickness, &amp;shelf_mask,      &amp;box_mask,           &amp;T_star,   &amp;Toc,</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                &amp;Soc,           &amp;basal_melt_rate, &amp;basal_temperature };</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// Iterate over all boxes i for i &gt; 1</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> box = 2; box &lt;= <a class="code" href="classpism_1_1ocean_1_1Pico_ac66ebac084be47bbc824c91ccfac5f22.html#ac66ebac084be47bbc824c91ccfac5f22">m_n_boxes</a>; ++box) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">compute_box_average</a>(box - 1, Toc, shelf_mask, box_mask, temperature);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">compute_box_average</a>(box - 1, Soc, shelf_mask, box_mask, salinity);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">// find all the shelves where we should fall back to the Beckmann-Goosse</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// parameterization</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 1; s &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>; ++s) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      use_beckmann_goosse[s] = (salinity[s] == 0.0 or</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                temperature[s] == 0.0 or</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                overturning[s] == 0.0);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    std::vector&lt;double&gt; box_area;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    <a class="code" href="classpism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170.html#a206668d50c0c650ff4ca9d5fa3001170">compute_box_area</a>(box, shelf_mask, box_mask, box_area);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordtype">int</span> n_beckmann_goosse_cells = 0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordtype">int</span> shelf_id = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span> (box_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == box and shelf_id &gt; 0) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">if</span> (use_beckmann_goosse[shelf_id]) {</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          n_beckmann_goosse_cells += 1;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="comment">// Get the input from previous box</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          S_previous       = salinity[shelf_id],</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          T_previous       = temperature[shelf_id],</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;          overturning_box1 = overturning[shelf_id];</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160; </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="keywordtype">double</span> pressure = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa.html#a0fab19a2c030fc9132e351b807dd78aa">pressure</a>(ice_thickness(i, j));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          <span class="comment">// diagnostic outputs</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          T_star(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_ab052ea1cf9785562ff798247f4016417.html#ab052ea1cf9785562ff798247f4016417">T_star</a>(S_previous, T_previous, pressure);</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;          Toc(i, j)    = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a2ca85473ae5a3d6915d59a888718478c.html#a2ca85473ae5a3d6915d59a888718478c">Toc</a>(box_area[shelf_id], T_previous, T_star(i, j), overturning_box1, S_previous);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          Soc(i, j)    = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_aff68f7553431f6db238f828de9172b0d.html#aff68f7553431f6db238f828de9172b0d">Soc</a>(S_previous, T_previous, Toc(i, j));</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;          <span class="comment">// main outputs: basal melt rate and temperature</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;          basal_melt_rate(i, j)   = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a75a91eaa2242f80e2b03300d215cbc88.html#a75a91eaa2242f80e2b03300d215cbc88">melt_rate</a>(physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0.html#a98d996a8f2960ab03232f342875c09c0">theta_pm</a>(Soc(i, j), pressure), Toc(i, j));</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          basal_temperature(i, j) = physics.<a class="code" href="classpism_1_1ocean_1_1PicoPhysics_aa89c9fd2375df7d727bfd29a9362a904.html#aa89c9fd2375df7d727bfd29a9362a904">T_pm</a>(Soc(i, j), pressure);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    } <span class="comment">// loop over grid points</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    n_beckmann_goosse_cells = <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, n_beckmann_goosse_cells);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (n_beckmann_goosse_cells &gt; 0) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;      <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;PICO ocean WARNING: box %d, no boundary data from previous box in %d case(s)!\n&quot;</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                        <span class="stringliteral">&quot;switching to Beckmann Goosse (2003) meltrate calculation\n&quot;</span>,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                     box, n_beckmann_goosse_cells);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  } <span class="comment">// loop over boxes</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">// Write diagnostic variables to extra files if requested</span></div>
<div class="line"><a name="l00777"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_af73c02919ca442c3a0002dc0ad42f8b0.html#af73c02919ca442c3a0002dc0ad42f8b0">  777</a></span>&#160;<a class="code" href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">DiagnosticList</a> <a class="code" href="classpism_1_1ocean_1_1Pico_af73c02919ca442c3a0002dc0ad42f8b0.html#af73c02919ca442c3a0002dc0ad42f8b0">Pico::diagnostics_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">DiagnosticList</a> result = {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    { <span class="stringliteral">&quot;basins&quot;</span>,                 <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">basin_mask</a>()) },</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    { <span class="stringliteral">&quot;pico_overturning&quot;</span>,       <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">m_overturning</a>) },</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    { <span class="stringliteral">&quot;pico_salinity_box0&quot;</span>,     <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">m_Soc_box0</a>) },</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    { <span class="stringliteral">&quot;pico_temperature_box0&quot;</span>,  <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">m_Toc_box0</a>) },</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    { <span class="stringliteral">&quot;pico_box_mask&quot;</span>,          <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_add7578365befdd60d228e295e0c8d252.html#add7578365befdd60d228e295e0c8d252">box_mask</a>()) },</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    { <span class="stringliteral">&quot;pico_shelf_mask&quot;</span>,        <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">ice_shelf_mask</a>()) },</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    { <span class="stringliteral">&quot;pico_ice_rise_mask&quot;</span>,     <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_af74c4de9063a40f8f2db500be1108e2c.html#af74c4de9063a40f8f2db500be1108e2c">ice_rise_mask</a>()) },</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    { <span class="stringliteral">&quot;pico_basal_melt_rate&quot;</span>,   <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">m_basal_melt_rate</a>) },</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    { <span class="stringliteral">&quot;pico_contshelf_mask&quot;</span>,    <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">m_geometry</a>.<a class="code" href="classpism_1_1ocean_1_1PicoGeometry_a10151c037768ac889f7dcec96a8f1192.html#a10151c037768ac889f7dcec96a8f1192">continental_shelf_mask</a>()) },</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    { <span class="stringliteral">&quot;pico_salinity&quot;</span>,          <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">m_Soc</a>) },</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    { <span class="stringliteral">&quot;pico_temperature&quot;</span>,       <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">m_Toc</a>) },</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    { <span class="stringliteral">&quot;pico_T_star&quot;</span>,            <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">m_T_star</a>) },</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    { <span class="stringliteral">&quot;pico_basal_temperature&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(*<a class="code" href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">m_shelf_base_temperature</a>) },</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  };</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacepism_ab50523fe25aadf4a123551726b2a2967.html#ab50523fe25aadf4a123551726b2a2967">combine</a>(result, <a class="code" href="classpism_1_1ocean_1_1OceanModel_a8cb098fa696035e6142e062b9b1dc41f.html#a8cb098fa696035e6142e062b9b1dc41f">OceanModel::diagnostics_impl</a>());</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;}</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment"> * For each shelf, compute average of a given field over the box with id `box_id`.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment"> * This method is used to get inputs from a previous box for the next one.</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00803"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">  803</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">Pico::compute_box_average</a>(<span class="keywordtype">int</span> box_id,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;field,</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                               <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;box_mask,</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                               std::vector&lt;double&gt; &amp;result)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;field, &amp;shelf_mask, &amp;box_mask };</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  std::vector&lt;int&gt; n_cells_per_box(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>, 0);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  std::vector&lt;double&gt; result1(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">// fill results with zeros</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  result.resize(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>; ++s) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    result[s] = 0.0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <span class="comment">// compute the sum of field in each shelf&#39;s box box_id</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">int</span> shelf_id = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (box_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == box_id) {</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      n_cells_per_box[shelf_id] += 1;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      result[shelf_id] += field(i, j);</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  }</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">// compute the global sum and average</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  std::vector&lt;int&gt; n_cells(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, n_cells_per_box.data(), n_cells.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, result.data(), result1.data(), <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">// copy data</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  result = result1;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>; ++s) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span> (n_cells[s] &gt; 0) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      result[s] /= <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(n_cells[s]);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;}</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="comment"> * For all shelves compute areas of boxes with id `box_id`.</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment"> * @param[in] box_mask box index mask</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="comment"> * @param[out] result resulting box areas.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment"> * Note: shelf and box indexes start from 1.</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno"><a class="line" href="classpism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170.html#a206668d50c0c650ff4ca9d5fa3001170">  853</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170.html#a206668d50c0c650ff4ca9d5fa3001170">Pico::compute_box_area</a>(<span class="keywordtype">int</span> box_id,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;shelf_mask,</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                            <span class="keyword">const</span> <a class="code" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> &amp;box_mask,</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                            std::vector&lt;double&gt; &amp;result)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  result.resize(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <a class="code" href="classpism_1_1AccessList.html">IceModelVec::AccessList</a> list{ &amp;shelf_mask, &amp;box_mask };</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keyword">auto</span> cell_area = <a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;cell_area();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classpism_1_1Points.html">Points</a> p(*<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>); p; p.<a class="code" href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">next</a>()) {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordtype">int</span> shelf_id = shelf_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (shelf_id &gt; 0 and box_mask.<a class="code" href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">as_int</a>(i, j) == box_id) {</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      result[shelf_id] += cell_area;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="comment">// compute GlobalSum from index 1 to index m_n_shelves-1</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  std::vector&lt;double&gt; result1(<a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">GlobalSum</a>(<a class="code" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a>-&gt;com, &amp;result[1], &amp;result1[1], <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>-1);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  <span class="comment">// copy data</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">m_n_shelves</a>; i++) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    result[i] = result1[i];</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;  }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;}</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;} <span class="comment">// end of namespace ocean</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;} <span class="comment">// end of namespace pism</span></div>
<div class="ttc" id="aPicoGeometry_8hh_html"><div class="ttname"><a href="PicoGeometry_8hh.html">PicoGeometry.hh</a></div></div>
<div class="ttc" id="aPicoPhysics_8hh_html"><div class="ttname"><a href="PicoPhysics_8hh.html">PicoPhysics.hh</a></div></div>
<div class="ttc" id="aPico_8hh_html"><div class="ttname"><a href="Pico_8hh.html">Pico.hh</a></div></div>
<div class="ttc" id="aclasspism_1_1AccessList_html"><div class="ttname"><a href="classpism_1_1AccessList.html">pism::AccessList</a></div><div class="ttdoc">Makes sure that we call begin_access() and end_access() for all accessed IceModelVecs.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00059">iceModelVec.hh:59</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84_html_a28f298fc2133baae8cebf9dedf3b4d84"><div class="ttname"><a href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">pism::Component::m_config</a></div><div class="ttdeci">const Config::ConstPtr m_config</div><div class="ttdoc">configuration database used by this component</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00138">Component.hh:138</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a29575eba605feccf4403d6b4ff0954a4_html_a29575eba605feccf4403d6b4ff0954a4"><div class="ttname"><a href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">pism::Component::m_log</a></div><div class="ttdeci">const Logger::ConstPtr m_log</div><div class="ttdoc">logger (for easy access)</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00142">Component.hh:142</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_ab55ef37caaaad9b22733942d54057141_html_ab55ef37caaaad9b22733942d54057141"><div class="ttname"><a href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">pism::Component::m_grid</a></div><div class="ttdeci">const IceGrid::ConstPtr m_grid</div><div class="ttdoc">grid used by this component</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00136">Component.hh:136</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9_html_a2648c1bc92c5e333ecad30e9a5687ea9"><div class="ttname"><a href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">pism::Diagnostic::wrap</a></div><div class="ttdeci">static Ptr wrap(const T &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00155">Diagnostic.hh:155</a></div></div>
<div class="ttc" id="aclasspism_1_1File_html"><div class="ttname"><a href="classpism_1_1File.html">pism::File</a></div><div class="ttdoc">High-level PISM I/O class.</div><div class="ttdef"><b>Definition:</b> <a href="File_8hh_source.html#l00050">File.hh:51</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_a6703744654fe7c676c448fbd2bd96372_html_a6703744654fe7c676c448fbd2bd96372"><div class="ttname"><a href="classpism_1_1Geometry_a6703744654fe7c676c448fbd2bd96372.html#a6703744654fe7c676c448fbd2bd96372">pism::Geometry::cell_type</a></div><div class="ttdeci">IceModelVec2CellType cell_type</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00057">Geometry.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_a833ba4c25c003f5b37e93692cf9a8e56_html_a833ba4c25c003f5b37e93692cf9a8e56"><div class="ttname"><a href="classpism_1_1Geometry_a833ba4c25c003f5b37e93692cf9a8e56.html#a833ba4c25c003f5b37e93692cf9a8e56">pism::Geometry::bed_elevation</a></div><div class="ttdeci">IceModelVec2S bed_elevation</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00049">Geometry.hh:49</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_aeb24ce2e2ebe25d9df3065e7f81129e2_html_aeb24ce2e2ebe25d9df3065e7f81129e2"><div class="ttname"><a href="classpism_1_1Geometry_aeb24ce2e2ebe25d9df3065e7f81129e2.html#aeb24ce2e2ebe25d9df3065e7f81129e2">pism::Geometry::ice_thickness</a></div><div class="ttdeci">IceModelVec2S ice_thickness</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00053">Geometry.hh:53</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_html"><div class="ttname"><a href="classpism_1_1Geometry.html">pism::Geometry</a></div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00029">Geometry.hh:29</a></div></div>
<div class="ttc" id="aclasspism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac_html_aa59b13ca1f14efc1555016e2b8a8b1ac"><div class="ttname"><a href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">pism::IceGrid::ConstPtr</a></div><div class="ttdeci">std::shared_ptr&lt; const IceGrid &gt; ConstPtr</div><div class="ttdef"><b>Definition:</b> <a href="IceGrid_8hh_source.html#l00233">IceGrid.hh:233</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2CellType_aa12e8ff430a67373fa483e1c1538d154_html_aa12e8ff430a67373fa483e1c1538d154"><div class="ttname"><a href="classpism_1_1IceModelVec2CellType_aa12e8ff430a67373fa483e1c1538d154.html#aa12e8ff430a67373fa483e1c1538d154">pism::IceModelVec2CellType::floating_ice</a></div><div class="ttdeci">bool floating_ice(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec2CellType_8hh_source.html#l00057">IceModelVec2CellType.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2CellType_html"><div class="ttname"><a href="classpism_1_1IceModelVec2CellType.html">pism::IceModelVec2CellType</a></div><div class="ttdoc">&quot;Cell type&quot; mask. Adds convenience methods to IceModelVec2Int.</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec2CellType_8hh_source.html#l00029">IceModelVec2CellType.hh:29</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2Int_a56178422403c26269619d01ded1716e4_html_a56178422403c26269619d01ded1716e4"><div class="ttname"><a href="classpism_1_1IceModelVec2Int_a56178422403c26269619d01ded1716e4.html#a56178422403c26269619d01ded1716e4">pism::IceModelVec2Int::box</a></div><div class="ttdeci">stencils::Box&lt; int &gt; box(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec__inline_8hh_source.html#l00101">IceModelVec_inline.hh:101</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60_html_a7c1ead1ea7b260dec7a542f369865c60"><div class="ttname"><a href="classpism_1_1IceModelVec2Int_a7c1ead1ea7b260dec7a542f369865c60.html#a7c1ead1ea7b260dec7a542f369865c60">pism::IceModelVec2Int::as_int</a></div><div class="ttdeci">int as_int(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec__inline_8hh_source.html#l00081">IceModelVec_inline.hh:81</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2Int_a9765aea19a56e73b3089131d61c1f049_html_a9765aea19a56e73b3089131d61c1f049"><div class="ttname"><a href="classpism_1_1IceModelVec2Int_a9765aea19a56e73b3089131d61c1f049.html#a9765aea19a56e73b3089131d61c1f049">pism::IceModelVec2Int::star</a></div><div class="ttdeci">stencils::Star&lt; int &gt; star(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec__inline_8hh_source.html#l00089">IceModelVec_inline.hh:89</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2Int_html"><div class="ttname"><a href="classpism_1_1IceModelVec2Int.html">pism::IceModelVec2Int</a></div><div class="ttdoc">A simple class &quot;hiding&quot; the fact that the mask is stored as floating-point scalars (instead of intege...</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00388">iceModelVec.hh:388</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2S_a6f4c01a809febc2ca71158798285ee4e_html_a6f4c01a809febc2ca71158798285ee4e"><div class="ttname"><a href="classpism_1_1IceModelVec2S_a6f4c01a809febc2ca71158798285ee4e.html#a6f4c01a809febc2ca71158798285ee4e">pism::IceModelVec2S::box</a></div><div class="ttdeci">stencils::Box&lt; double &gt; box(int i, int j) const</div><div class="ttdef"><b>Definition:</b> <a href="IceModelVec__inline_8hh_source.html#l00055">IceModelVec_inline.hh:55</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2S_html"><div class="ttname"><a href="classpism_1_1IceModelVec2S.html">pism::IceModelVec2S</a></div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00335">iceModelVec.hh:335</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec2T_a386db681cacb1d187123dae4139570bc_html_a386db681cacb1d187123dae4139570bc"><div class="ttname"><a href="classpism_1_1IceModelVec2T_a386db681cacb1d187123dae4139570bc.html#a386db681cacb1d187123dae4139570bc">pism::IceModelVec2T::ForcingField</a></div><div class="ttdeci">static std::shared_ptr&lt; IceModelVec2T &gt; ForcingField(IceGrid::ConstPtr grid, const File &amp;file, const std::string &amp;short_name, const std::string &amp;standard_name, int max_buffer_size, bool periodic, InterpolationType interpolation_type=PIECEWISE_CONSTANT)</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec2T_8cc_source.html#l00109">iceModelVec2T.cc:109</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be_html_a198b0bb7db28b03415f6e2cfa37ce7be"><div class="ttname"><a href="classpism_1_1IceModelVec_a198b0bb7db28b03415f6e2cfa37ce7be.html#a198b0bb7db28b03415f6e2cfa37ce7be">pism::IceModelVec::metadata</a></div><div class="ttdeci">SpatialVariableMetadata &amp; metadata(unsigned int N=0)</div><div class="ttdoc">Returns a reference to the SpatialVariableMetadata object containing metadata for the compoment N.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00533">iceModelVec.cc:533</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf_html_a2f473e076b0aff0783935915d53ab3cf"><div class="ttname"><a href="classpism_1_1IceModelVec_a2f473e076b0aff0783935915d53ab3cf.html#a2f473e076b0aff0783935915d53ab3cf">pism::IceModelVec::set_attrs</a></div><div class="ttdeci">void set_attrs(const std::string &amp;pism_intent, const std::string &amp;long_name, const std::string &amp;units, const std::string &amp;glaciological_units, const std::string &amp;standard_name, unsigned int component)</div><div class="ttdoc">Sets NetCDF attributes of an IceModelVec object.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00399">iceModelVec.cc:399</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e_html_a76c976ffe2a241a9157490c47658a77e"><div class="ttname"><a href="classpism_1_1IceModelVec_a76c976ffe2a241a9157490c47658a77e.html#a76c976ffe2a241a9157490c47658a77e">pism::IceModelVec::set</a></div><div class="ttdeci">void set(double c)</div><div class="ttdoc">Result: v[j] &lt;- c for all j.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00683">iceModelVec.cc:683</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_a7ec09c4ef26812d2a16d81db42f6b852_html_a7ec09c4ef26812d2a16d81db42f6b852"><div class="ttname"><a href="classpism_1_1IceModelVec_a7ec09c4ef26812d2a16d81db42f6b852.html#a7ec09c4ef26812d2a16d81db42f6b852">pism::IceModelVec::grid</a></div><div class="ttdeci">IceGrid::ConstPtr grid() const</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00128">iceModelVec.cc:128</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1_html_aa3a14430024efdba57118b95701484c1"><div class="ttname"><a href="classpism_1_1IceModelVec_aa3a14430024efdba57118b95701484c1.html#aa3a14430024efdba57118b95701484c1">pism::IceModelVec::define</a></div><div class="ttdeci">void define(const File &amp;file, IO_Type default_type=PISM_DOUBLE) const</div><div class="ttdoc">Define variables corresponding to an IceModelVec in a file opened using file.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00523">iceModelVec.cc:523</a></div></div>
<div class="ttc" id="aclasspism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574_html_aa51ad1c4387a5ea7cc4e2c0e94275574"><div class="ttname"><a href="classpism_1_1IceModelVec_aa51ad1c4387a5ea7cc4e2c0e94275574.html#aa51ad1c4387a5ea7cc4e2c0e94275574">pism::IceModelVec::write</a></div><div class="ttdeci">void write(const std::string &amp;filename) const</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8cc_source.html#l00822">iceModelVec.cc:822</a></div></div>
<div class="ttc" id="aclasspism_1_1MaxTimestep_html"><div class="ttname"><a href="classpism_1_1MaxTimestep.html">pism::MaxTimestep</a></div><div class="ttdoc">Combines the max. time step with the flag indicating if a restriction is active. Makes is possible to...</div><div class="ttdef"><b>Definition:</b> <a href="MaxTimestep_8hh_source.html#l00031">MaxTimestep.hh:31</a></div></div>
<div class="ttc" id="aclasspism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af_html_a36441e98cc5c0a8538c5358523dce6af"><div class="ttname"><a href="classpism_1_1PointsWithGhosts_a36441e98cc5c0a8538c5358523dce6af.html#a36441e98cc5c0a8538c5358523dce6af">pism::PointsWithGhosts::next</a></div><div class="ttdeci">void next()</div><div class="ttdef"><b>Definition:</b> <a href="IceGrid_8hh_source.html#l00381">IceGrid.hh:381</a></div></div>
<div class="ttc" id="aclasspism_1_1Points_html"><div class="ttname"><a href="classpism_1_1Points.html">pism::Points</a></div><div class="ttdef"><b>Definition:</b> <a href="IceGrid_8hh_source.html#l00409">IceGrid.hh:409</a></div></div>
<div class="ttc" id="aclasspism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a_html_a6c4ef010242e1a405186e8666345c17a"><div class="ttname"><a href="classpism_1_1VariableMetadata_a6c4ef010242e1a405186e8666345c17a.html#a6c4ef010242e1a405186e8666345c17a">pism::VariableMetadata::get_number</a></div><div class="ttdeci">double get_number(const std::string &amp;name) const</div><div class="ttdoc">Get a single-valued scalar attribute.</div><div class="ttdef"><b>Definition:</b> <a href="VariableMetadata_8cc_source.html#l00269">VariableMetadata.cc:269</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1CompleteOceanModel_a29087754df7e937d733813a087f94dea_html_a29087754df7e937d733813a087f94dea"><div class="ttname"><a href="classpism_1_1ocean_1_1CompleteOceanModel_a29087754df7e937d733813a087f94dea.html#a29087754df7e937d733813a087f94dea">pism::ocean::CompleteOceanModel::m_shelf_base_mass_flux</a></div><div class="ttdeci">IceModelVec2S::Ptr m_shelf_base_mass_flux</div><div class="ttdef"><b>Definition:</b> <a href="CompleteOceanModel_8hh_source.html#l00048">CompleteOceanModel.hh:48</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec_html_ac5f7fe69a64f24c3173fd80b3eac13ec"><div class="ttname"><a href="classpism_1_1ocean_1_1CompleteOceanModel_ac5f7fe69a64f24c3173fd80b3eac13ec.html#ac5f7fe69a64f24c3173fd80b3eac13ec">pism::ocean::CompleteOceanModel::m_shelf_base_temperature</a></div><div class="ttdeci">IceModelVec2S::Ptr m_shelf_base_temperature</div><div class="ttdef"><b>Definition:</b> <a href="CompleteOceanModel_8hh_source.html#l00047">CompleteOceanModel.hh:47</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1CompleteOceanModel_html"><div class="ttname"><a href="classpism_1_1ocean_1_1CompleteOceanModel.html">pism::ocean::CompleteOceanModel</a></div><div class="ttdef"><b>Definition:</b> <a href="CompleteOceanModel_8hh_source.html#l00033">CompleteOceanModel.hh:33</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_a4532704c3d2917325a12750993e91779_html_a4532704c3d2917325a12750993e91779"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel_a4532704c3d2917325a12750993e91779.html#a4532704c3d2917325a12750993e91779">pism::ocean::OceanModel::define_model_state_impl</a></div><div class="ttdeci">virtual void define_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8cc_source.html#l00128">OceanModel.cc:128</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_a45913c628d6292edfd0f6344d79a7310_html_a45913c628d6292edfd0f6344d79a7310"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel_a45913c628d6292edfd0f6344d79a7310.html#a45913c628d6292edfd0f6344d79a7310">pism::ocean::OceanModel::m_water_column_pressure</a></div><div class="ttdeci">IceModelVec2S::Ptr m_water_column_pressure</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8hh_source.html#l00070">OceanModel.hh:70</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_a8cb098fa696035e6142e062b9b1dc41f_html_a8cb098fa696035e6142e062b9b1dc41f"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel_a8cb098fa696035e6142e062b9b1dc41f.html#a8cb098fa696035e6142e062b9b1dc41f">pism::ocean::OceanModel::diagnostics_impl</a></div><div class="ttdeci">virtual DiagnosticList diagnostics_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8cc_source.html#l00224">OceanModel.cc:224</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_a984ce69fa967ab45645647ab70f5a5f9_html_a984ce69fa967ab45645647ab70f5a5f9"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel_a984ce69fa967ab45645647ab70f5a5f9.html#a984ce69fa967ab45645647ab70f5a5f9">pism::ocean::OceanModel::compute_average_water_column_pressure</a></div><div class="ttdeci">static void compute_average_water_column_pressure(const Geometry &amp;geometry, double ice_density, double water_density, double g, IceModelVec2S &amp;result)</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8cc_source.html#l00246">OceanModel.cc:246</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_ab76f93a78d9202d2ab52b28079d9d0c3_html_ab76f93a78d9202d2ab52b28079d9d0c3"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel_ab76f93a78d9202d2ab52b28079d9d0c3.html#ab76f93a78d9202d2ab52b28079d9d0c3">pism::ocean::OceanModel::write_model_state_impl</a></div><div class="ttdeci">virtual void write_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8cc_source.html#l00136">OceanModel.cc:136</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1OceanModel_html"><div class="ttname"><a href="classpism_1_1ocean_1_1OceanModel.html">pism::ocean::OceanModel</a></div><div class="ttdoc">A very rudimentary PISM ocean model.</div><div class="ttdef"><b>Definition:</b> <a href="OceanModel_8hh_source.html#l00036">OceanModel.hh:36</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_a10151c037768ac889f7dcec96a8f1192_html_a10151c037768ac889f7dcec96a8f1192"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_a10151c037768ac889f7dcec96a8f1192.html#a10151c037768ac889f7dcec96a8f1192">pism::ocean::PicoGeometry::continental_shelf_mask</a></div><div class="ttdeci">const IceModelVec2Int &amp; continental_shelf_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00058">PicoGeometry.cc:58</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da_html_a1dfc08bfb07adebbbc54e3549e59c8da"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_a1dfc08bfb07adebbbc54e3549e59c8da.html#a1dfc08bfb07adebbbc54e3549e59c8da">pism::ocean::PicoGeometry::basin_mask</a></div><div class="ttdeci">const IceModelVec2Int &amp; basin_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00074">PicoGeometry.cc:74</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_a54267be1232c83aa000a2431f63749fa_html_a54267be1232c83aa000a2431f63749fa"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_a54267be1232c83aa000a2431f63749fa.html#a54267be1232c83aa000a2431f63749fa">pism::ocean::PicoGeometry::init</a></div><div class="ttdeci">void init(const IceModelVec2CellType &amp;cell_type)</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00078">PicoGeometry.cc:78</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a_html_a92e281992f142aa689f968015310be1a"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_a92e281992f142aa689f968015310be1a.html#a92e281992f142aa689f968015310be1a">pism::ocean::PicoGeometry::ice_shelf_mask</a></div><div class="ttdeci">const IceModelVec2Int &amp; ice_shelf_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00066">PicoGeometry.cc:66</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_aa7fb8e10a6464f8a02ad1d7e92e65c5d_html_aa7fb8e10a6464f8a02ad1d7e92e65c5d"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_aa7fb8e10a6464f8a02ad1d7e92e65c5d.html#aa7fb8e10a6464f8a02ad1d7e92e65c5d">pism::ocean::PicoGeometry::update</a></div><div class="ttdeci">void update(const IceModelVec2S &amp;bed_elevation, const IceModelVec2CellType &amp;cell_type)</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00106">PicoGeometry.cc:106</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_add7578365befdd60d228e295e0c8d252_html_add7578365befdd60d228e295e0c8d252"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_add7578365befdd60d228e295e0c8d252.html#add7578365befdd60d228e295e0c8d252">pism::ocean::PicoGeometry::box_mask</a></div><div class="ttdeci">const IceModelVec2Int &amp; box_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00062">PicoGeometry.cc:62</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoGeometry_af74c4de9063a40f8f2db500be1108e2c_html_af74c4de9063a40f8f2db500be1108e2c"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoGeometry_af74c4de9063a40f8f2db500be1108e2c.html#af74c4de9063a40f8f2db500be1108e2c">pism::ocean::PicoGeometry::ice_rise_mask</a></div><div class="ttdeci">const IceModelVec2Int &amp; ice_rise_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoGeometry_8cc_source.html#l00070">PicoGeometry.cc:70</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa_html_a0fab19a2c030fc9132e351b807dd78aa"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a0fab19a2c030fc9132e351b807dd78aa.html#a0fab19a2c030fc9132e351b807dd78aa">pism::ocean::PicoPhysics::pressure</a></div><div class="ttdeci">double pressure(double ice_thickness) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00090">PicoPhysics.cc:90</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a1af5188d6a5ca7909af42435d6f9209c_html_a1af5188d6a5ca7909af42435d6f9209c"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a1af5188d6a5ca7909af42435d6f9209c.html#a1af5188d6a5ca7909af42435d6f9209c">pism::ocean::PicoPhysics::overturning_coeff</a></div><div class="ttdeci">double overturning_coeff() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00195">PicoPhysics.cc:195</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a1e61e091c19e2e416ab4b3a4f8a67b42_html_a1e61e091c19e2e416ab4b3a4f8a67b42"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a1e61e091c19e2e416ab4b3a4f8a67b42.html#a1e61e091c19e2e416ab4b3a4f8a67b42">pism::ocean::PicoPhysics::ice_density</a></div><div class="ttdeci">double ice_density() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00207">PicoPhysics.cc:207</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a26f6621612f26b2f881b2ed7be2c826b_html_a26f6621612f26b2f881b2ed7be2c826b"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a26f6621612f26b2f881b2ed7be2c826b.html#a26f6621612f26b2f881b2ed7be2c826b">pism::ocean::PicoPhysics::S_dummy</a></div><div class="ttdeci">double S_dummy() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00203">PicoPhysics.cc:203</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a2c860c4d55702326f0bc687a292c7a3c_html_a2c860c4d55702326f0bc687a292c7a3c"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a2c860c4d55702326f0bc687a292c7a3c.html#a2c860c4d55702326f0bc687a292c7a3c">pism::ocean::PicoPhysics::Toc_box1</a></div><div class="ttdeci">TocBox1 Toc_box1(double area, double T_star, double Soc_box0, double Toc_box0) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00095">PicoPhysics.cc:95</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a2ca85473ae5a3d6915d59a888718478c_html_a2ca85473ae5a3d6915d59a888718478c"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a2ca85473ae5a3d6915d59a888718478c.html#a2ca85473ae5a3d6915d59a888718478c">pism::ocean::PicoPhysics::Toc</a></div><div class="ttdeci">double Toc(double box_area, double temperature, double T_star, double overturning, double salinity) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00120">PicoPhysics.cc:120</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a2f0ed0e4bc30938815c3da9b44c98c93_html_a2f0ed0e4bc30938815c3da9b44c98c93"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a2f0ed0e4bc30938815c3da9b44c98c93.html#a2f0ed0e4bc30938815c3da9b44c98c93">pism::ocean::PicoPhysics::gamma_T</a></div><div class="ttdeci">double gamma_T() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00191">PicoPhysics.cc:191</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a5ec8e74d0bbac3a7422954b7d52ca418_html_a5ec8e74d0bbac3a7422954b7d52ca418"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a5ec8e74d0bbac3a7422954b7d52ca418.html#a5ec8e74d0bbac3a7422954b7d52ca418">pism::ocean::PicoPhysics::continental_shelf_depth</a></div><div class="ttdeci">double continental_shelf_depth() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00211">PicoPhysics.cc:211</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a75a91eaa2242f80e2b03300d215cbc88_html_a75a91eaa2242f80e2b03300d215cbc88"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a75a91eaa2242f80e2b03300d215cbc88.html#a75a91eaa2242f80e2b03300d215cbc88">pism::ocean::PicoPhysics::melt_rate</a></div><div class="ttdeci">double melt_rate(double pm_point, double Toc) const</div><div class="ttdoc">equation 8 in the PICO paper.</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00155">PicoPhysics.cc:155</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a78309d820f3c0f6f942af229d2890b42_html_a78309d820f3c0f6f942af229d2890b42"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a78309d820f3c0f6f942af229d2890b42.html#a78309d820f3c0f6f942af229d2890b42">pism::ocean::PicoPhysics::overturning</a></div><div class="ttdeci">double overturning(double Soc_box0, double Soc, double Toc_box0, double Toc) const</div><div class="ttdoc">equation 3 in the PICO paper. See also equation 4.</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00169">PicoPhysics.cc:169</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0_html_a98d996a8f2960ab03232f342875c09c0"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a98d996a8f2960ab03232f342875c09c0.html#a98d996a8f2960ab03232f342875c09c0">pism::ocean::PicoPhysics::theta_pm</a></div><div class="ttdeci">double theta_pm(double salinity, double pressure) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00142">PicoPhysics.cc:142</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_a9edaeb7fc627389b6798aaa18de930f7_html_a9edaeb7fc627389b6798aaa18de930f7"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_a9edaeb7fc627389b6798aaa18de930f7.html#a9edaeb7fc627389b6798aaa18de930f7">pism::ocean::PicoPhysics::Soc_box1</a></div><div class="ttdeci">double Soc_box1(double Toc_box0, double Soc_box0, double Toc) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00129">PicoPhysics.cc:129</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_aa89c9fd2375df7d727bfd29a9362a904_html_aa89c9fd2375df7d727bfd29a9362a904"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_aa89c9fd2375df7d727bfd29a9362a904.html#aa89c9fd2375df7d727bfd29a9362a904">pism::ocean::PicoPhysics::T_pm</a></div><div class="ttdeci">double T_pm(double salinity, double pressure) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00149">PicoPhysics.cc:149</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_aaf8668386641c3989e558e00867d2280_html_aaf8668386641c3989e558e00867d2280"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_aaf8668386641c3989e558e00867d2280.html#aaf8668386641c3989e558e00867d2280">pism::ocean::PicoPhysics::melt_rate_beckmann_goosse</a></div><div class="ttdeci">double melt_rate_beckmann_goosse(double pot_pm_point, double Toc) const</div><div class="ttdoc">Beckmann &amp; Goosse meltrate.</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00161">PicoPhysics.cc:161</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_ab052ea1cf9785562ff798247f4016417_html_ab052ea1cf9785562ff798247f4016417"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_ab052ea1cf9785562ff798247f4016417.html#ab052ea1cf9785562ff798247f4016417">pism::ocean::PicoPhysics::T_star</a></div><div class="ttdeci">double T_star(double salinity, double temperature, double pressure) const</div><div class="ttdoc">See equation A6 and lines before in PICO paper.</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00175">PicoPhysics.cc:175</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_af935f34e21724796bec07643087ec105_html_af935f34e21724796bec07643087ec105"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_af935f34e21724796bec07643087ec105.html#af935f34e21724796bec07643087ec105">pism::ocean::PicoPhysics::T_dummy</a></div><div class="ttdeci">double T_dummy() const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00199">PicoPhysics.cc:199</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_aff68f7553431f6db238f828de9172b0d_html_aff68f7553431f6db238f828de9172b0d"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics_aff68f7553431f6db238f828de9172b0d.html#aff68f7553431f6db238f828de9172b0d">pism::ocean::PicoPhysics::Soc</a></div><div class="ttdeci">double Soc(double salinity, double temperature, double Toc) const</div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8cc_source.html#l00134">PicoPhysics.cc:134</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1PicoPhysics_html"><div class="ttname"><a href="classpism_1_1ocean_1_1PicoPhysics.html">pism::ocean::PicoPhysics</a></div><div class="ttdef"><b>Definition:</b> <a href="PicoPhysics_8hh_source.html#l00031">PicoPhysics.hh:31</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99_html_a00ac5f5474e0492ce77055e1e5eadf99"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a00ac5f5474e0492ce77055e1e5eadf99.html#a00ac5f5474e0492ce77055e1e5eadf99">pism::ocean::Pico::m_n_shelves</a></div><div class="ttdeci">int m_n_shelves</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00129">Pico.hh:129</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172_html_a06f50cda306972cf3c1fcd6a83b91172"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a06f50cda306972cf3c1fcd6a83b91172.html#a06f50cda306972cf3c1fcd6a83b91172">pism::ocean::Pico::m_salinity_ocean</a></div><div class="ttdeci">std::shared_ptr&lt; IceModelVec2T &gt; m_salinity_ocean</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00064">Pico.hh:64</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a0a5db8c24da1e538420d8107c3d5b3a3_html_a0a5db8c24da1e538420d8107c3d5b3a3"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a0a5db8c24da1e538420d8107c3d5b3a3.html#a0a5db8c24da1e538420d8107c3d5b3a3">pism::ocean::Pico::process_box1</a></div><div class="ttdeci">void process_box1(const PicoPhysics &amp;physics, const IceModelVec2S &amp;ice_thickness, const IceModelVec2Int &amp;shelf_mask, const IceModelVec2Int &amp;box_mask, const IceModelVec2S &amp;Toc_box0, const IceModelVec2S &amp;Soc_box0, IceModelVec2S &amp;basal_melt_rate, IceModelVec2S &amp;basal_temperature, IceModelVec2S &amp;T_star, IceModelVec2S &amp;Toc, IceModelVec2S &amp;Soc, IceModelVec2S &amp;overturning)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00624">Pico.cc:624</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc_html_a0bf896d5437a3aa617e7bc903320dcfc"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a0bf896d5437a3aa617e7bc903320dcfc.html#a0bf896d5437a3aa617e7bc903320dcfc">pism::ocean::Pico::m_n_basins</a></div><div class="ttdeci">int m_n_basins</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00129">Pico.hh:129</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a_html_a1f10f6a5371413f613446ca754e5a27a"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a1f10f6a5371413f613446ca754e5a27a.html#a1f10f6a5371413f613446ca754e5a27a">pism::ocean::Pico::m_Toc_box0</a></div><div class="ttdeci">IceModelVec2S m_Toc_box0</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00058">Pico.hh:58</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170_html_a206668d50c0c650ff4ca9d5fa3001170"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a206668d50c0c650ff4ca9d5fa3001170.html#a206668d50c0c650ff4ca9d5fa3001170">pism::ocean::Pico::compute_box_area</a></div><div class="ttdeci">void compute_box_area(int box_id, const IceModelVec2Int &amp;shelf_mask, const IceModelVec2Int &amp;box_mask, std::vector&lt; double &gt; &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00853">Pico.cc:853</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a23dfe83390c7326c1f1ca27fd17ede43_html_a23dfe83390c7326c1f1ca27fd17ede43"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a23dfe83390c7326c1f1ca27fd17ede43.html#a23dfe83390c7326c1f1ca27fd17ede43">pism::ocean::Pico::Pico</a></div><div class="ttdeci">Pico(IceGrid::ConstPtr g)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00051">Pico.cc:51</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a5c62a82d203166de3f2ce56d70708b34_html_a5c62a82d203166de3f2ce56d70708b34"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a5c62a82d203166de3f2ce56d70708b34.html#a5c62a82d203166de3f2ce56d70708b34">pism::ocean::Pico::write_model_state_impl</a></div><div class="ttdeci">void write_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00189">Pico.cc:189</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a66785728fa968676f668b608e689dc5d_html_a66785728fa968676f668b608e689dc5d"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a66785728fa968676f668b608e689dc5d.html#a66785728fa968676f668b608e689dc5d">pism::ocean::Pico::max_timestep_impl</a></div><div class="ttdeci">MaxTimestep max_timestep_impl(double t) const</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00362">Pico.cc:362</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a6b110bbe1316b217ceb3e2a819f13bab_html_a6b110bbe1316b217ceb3e2a819f13bab"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a6b110bbe1316b217ceb3e2a819f13bab.html#a6b110bbe1316b217ceb3e2a819f13bab">pism::ocean::Pico::set_ocean_input_fields</a></div><div class="ttdeci">void set_ocean_input_fields(const PicoPhysics &amp;physics, const IceModelVec2S &amp;ice_thickness, const IceModelVec2CellType &amp;mask, const IceModelVec2Int &amp;basin_mask, const IceModelVec2Int &amp;shelf_mask, const std::vector&lt; double &gt; &amp;basin_temperature, const std::vector&lt; double &gt; &amp;basin_salinity, IceModelVec2S &amp;Toc_box0, IceModelVec2S &amp;Soc_box0) const</div><div class="ttdoc">Set ocean ocean input from box 0 as boundary condition for box 1.</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00459">Pico.cc:459</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a787feae4282bd62ce60902c605c1b510_html_a787feae4282bd62ce60902c605c1b510"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a787feae4282bd62ce60902c605c1b510.html#a787feae4282bd62ce60902c605c1b510">pism::ocean::Pico::beckmann_goosse</a></div><div class="ttdeci">void beckmann_goosse(const PicoPhysics &amp;physics, const IceModelVec2S &amp;ice_thickness, const IceModelVec2Int &amp;shelf_mask, const IceModelVec2CellType &amp;cell_type, const IceModelVec2S &amp;Toc_box0, const IceModelVec2S &amp;Soc_box0, IceModelVec2S &amp;basal_melt_rate, IceModelVec2S &amp;basal_temperature, IceModelVec2S &amp;Toc, IceModelVec2S &amp;Soc)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00579">Pico.cc:579</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf_html_a7cbdc7b2cda2853432cc0219c447cfbf"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a7cbdc7b2cda2853432cc0219c447cfbf.html#a7cbdc7b2cda2853432cc0219c447cfbf">pism::ocean::Pico::m_overturning</a></div><div class="ttdeci">IceModelVec2S m_overturning</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00059">Pico.hh:59</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a7e51acb0ca855bd39cef93e5e9187554_html_a7e51acb0ca855bd39cef93e5e9187554"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a7e51acb0ca855bd39cef93e5e9187554.html#a7e51acb0ca855bd39cef93e5e9187554">pism::ocean::Pico::define_model_state_impl</a></div><div class="ttdeci">void define_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00179">Pico.cc:179</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7_html_a80fc9459cb1117878798e6acfebc9ff7"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a80fc9459cb1117878798e6acfebc9ff7.html#a80fc9459cb1117878798e6acfebc9ff7">pism::ocean::Pico::compute_box_average</a></div><div class="ttdeci">void compute_box_average(int box_id, const IceModelVec2S &amp;field, const IceModelVec2Int &amp;shelf_mask, const IceModelVec2Int &amp;box_mask, std::vector&lt; double &gt; &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00803">Pico.cc:803</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a8b33ff5b2b9cef7abdf4ff49c53970c7_html_a8b33ff5b2b9cef7abdf4ff49c53970c7"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a8b33ff5b2b9cef7abdf4ff49c53970c7.html#a8b33ff5b2b9cef7abdf4ff49c53970c7">pism::ocean::Pico::update_impl</a></div><div class="ttdeci">void update_impl(const Geometry &amp;geometry, double t, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00246">Pico.cc:246</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c_html_a8f3770f2d6cf3e7d2f62ff3b2a94b62c"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_a8f3770f2d6cf3e7d2f62ff3b2a94b62c.html#a8f3770f2d6cf3e7d2f62ff3b2a94b62c">pism::ocean::Pico::m_theta_ocean</a></div><div class="ttdeci">std::shared_ptr&lt; IceModelVec2T &gt; m_theta_ocean</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00064">Pico.hh:64</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544_html_ab731263c01e5e052bc7a150a109de544"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_ab731263c01e5e052bc7a150a109de544.html#ab731263c01e5e052bc7a150a109de544">pism::ocean::Pico::m_basal_melt_rate</a></div><div class="ttdeci">IceModelVec2S m_basal_melt_rate</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00060">Pico.hh:60</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493_html_ab7f9628fdfc7543adb0169cdd6fb4493"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_ab7f9628fdfc7543adb0169cdd6fb4493.html#ab7f9628fdfc7543adb0169cdd6fb4493">pism::ocean::Pico::m_geometry</a></div><div class="ttdeci">PicoGeometry m_geometry</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00062">Pico.hh:62</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_ac66ebac084be47bbc824c91ccfac5f22_html_ac66ebac084be47bbc824c91ccfac5f22"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_ac66ebac084be47bbc824c91ccfac5f22.html#ac66ebac084be47bbc824c91ccfac5f22">pism::ocean::Pico::m_n_boxes</a></div><div class="ttdeci">int m_n_boxes</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00129">Pico.hh:129</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_ada110aa8fbb292682dc1a3571b9b0a32_html_ada110aa8fbb292682dc1a3571b9b0a32"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_ada110aa8fbb292682dc1a3571b9b0a32.html#ada110aa8fbb292682dc1a3571b9b0a32">pism::ocean::Pico::init_impl</a></div><div class="ttdeci">void init_impl(const Geometry &amp;geometry)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00134">Pico.cc:134</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd_html_ae0b7f2d2db208d42977ad9f02574ffcd"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_ae0b7f2d2db208d42977ad9f02574ffcd.html#ae0b7f2d2db208d42977ad9f02574ffcd">pism::ocean::Pico::m_Toc</a></div><div class="ttdeci">IceModelVec2S m_Toc</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00058">Pico.hh:58</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_af73c02919ca442c3a0002dc0ad42f8b0_html_af73c02919ca442c3a0002dc0ad42f8b0"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_af73c02919ca442c3a0002dc0ad42f8b0.html#af73c02919ca442c3a0002dc0ad42f8b0">pism::ocean::Pico::diagnostics_impl</a></div><div class="ttdeci">std::map&lt; std::string, Diagnostic::Ptr &gt; diagnostics_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00777">Pico.cc:777</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a_html_af86a64e1a3d1301abf186c10fba6f71a"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_af86a64e1a3d1301abf186c10fba6f71a.html#af86a64e1a3d1301abf186c10fba6f71a">pism::ocean::Pico::m_Soc_box0</a></div><div class="ttdeci">IceModelVec2S m_Soc_box0</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00057">Pico.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3_html_af86c20358fcb1fb8c089c5f9c52a58b3"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_af86c20358fcb1fb8c089c5f9c52a58b3.html#af86c20358fcb1fb8c089c5f9c52a58b3">pism::ocean::Pico::m_T_star</a></div><div class="ttdeci">IceModelVec2S m_T_star</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00058">Pico.hh:58</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_af9b4ef432b4f97387a92ffc5c7cf5e23_html_af9b4ef432b4f97387a92ffc5c7cf5e23"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_af9b4ef432b4f97387a92ffc5c7cf5e23.html#af9b4ef432b4f97387a92ffc5c7cf5e23">pism::ocean::Pico::process_other_boxes</a></div><div class="ttdeci">void process_other_boxes(const PicoPhysics &amp;physics, const IceModelVec2S &amp;ice_thickness, const IceModelVec2Int &amp;shelf_mask, const IceModelVec2Int &amp;box_mask, IceModelVec2S &amp;basal_melt_rate, IceModelVec2S &amp;basal_temperature, IceModelVec2S &amp;T_star, IceModelVec2S &amp;Toc, IceModelVec2S &amp;Soc) const</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00691">Pico.cc:691</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0_html_afc4f14264406f53cd42c1fd70ee4e0a0"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_afc4f14264406f53cd42c1fd70ee4e0a0.html#afc4f14264406f53cd42c1fd70ee4e0a0">pism::ocean::Pico::m_Soc</a></div><div class="ttdeci">IceModelVec2S m_Soc</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8hh_source.html#l00057">Pico.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1ocean_1_1Pico_afd7f982d264e27182f0542d24e77c2a5_html_afd7f982d264e27182f0542d24e77c2a5"><div class="ttname"><a href="classpism_1_1ocean_1_1Pico_afd7f982d264e27182f0542d24e77c2a5.html#afd7f982d264e27182f0542d24e77c2a5">pism::ocean::Pico::compute_ocean_input_per_basin</a></div><div class="ttdeci">void compute_ocean_input_per_basin(const PicoPhysics &amp;physics, const IceModelVec2Int &amp;basin_mask, const IceModelVec2Int &amp;continental_shelf_mask, const IceModelVec2S &amp;salinity_ocean, const IceModelVec2S &amp;theta_ocean, std::vector&lt; double &gt; &amp;temperature, std::vector&lt; double &gt; &amp;salinity) const</div><div class="ttdoc">Compute temperature and salinity input from ocean data by averaging.</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00375">Pico.cc:375</a></div></div>
<div class="ttc" id="aexactTestO_8c_a852651988df354c0e9f4d1db835a5c45_html_a852651988df354c0e9f4d1db835a5c45"><div class="ttname"><a href="exactTestO_8c_a852651988df354c0e9f4d1db835a5c45.html#a852651988df354c0e9f4d1db835a5c45">beta_CC</a></div><div class="ttdeci">static const double beta_CC</div><div class="ttdef"><b>Definition:</b> <a href="exactTestO_8c_source.html#l00023">exactTestO.c:23</a></div></div>
<div class="ttc" id="anamespacepism_1_1mask_af201676abc8faf30d74dd8fc50b60942_html_af201676abc8faf30d74dd8fc50b60942"><div class="ttname"><a href="namespacepism_1_1mask_af201676abc8faf30d74dd8fc50b60942.html#af201676abc8faf30d74dd8fc50b60942">pism::mask::ocean</a></div><div class="ttdeci">bool ocean(int M)</div><div class="ttdoc">An ocean cell (floating ice or ice-free).</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00039">Mask.hh:39</a></div></div>
<div class="ttc" id="anamespacepism_1_1ocean_ae05300cafae71ac5e2fbf4ce81ee763d_html_ae05300cafae71ac5e2fbf4ce81ee763d"><div class="ttname"><a href="namespacepism_1_1ocean_ae05300cafae71ac5e2fbf4ce81ee763d.html#ae05300cafae71ac5e2fbf4ce81ee763d">pism::ocean::extend_basal_melt_rates</a></div><div class="ttdeci">static void extend_basal_melt_rates(const IceModelVec2CellType &amp;cell_type, IceModelVec2S &amp;basal_melt_rate)</div><div class="ttdef"><b>Definition:</b> <a href="Pico_8cc_source.html#l00204">Pico.cc:204</a></div></div>
<div class="ttc" id="anamespacepism_a1c38bf61f42eeb099d3356ab93fefb5b_html_a1c38bf61f42eeb099d3356ab93fefb5b"><div class="ttname"><a href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">pism::max</a></div><div class="ttdeci">double max(const IceModelVec2S &amp;input)</div><div class="ttdoc">Finds maximum over all the values in an IceModelVec2S object. Ignores ghosts.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec2_8cc_source.html#l00191">iceModelVec2.cc:191</a></div></div>
<div class="ttc" id="anamespacepism_a47d754ed3e959d5866b02a1b78b6a5b5_html_a47d754ed3e959d5866b02a1b78b6a5b5"><div class="ttname"><a href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">pism::g</a></div><div class="ttdeci">static const double g</div><div class="ttdef"><b>Definition:</b> <a href="exactTestP_8cc_source.html#l00039">exactTestP.cc:39</a></div></div>
<div class="ttc" id="anamespacepism_a6154a990ba873c6ca606d8a320c441ac_html_a6154a990ba873c6ca606d8a320c441ac"><div class="ttname"><a href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">pism::DiagnosticList</a></div><div class="ttdeci">std::map&lt; std::string, Diagnostic::Ptr &gt; DiagnosticList</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00117">Diagnostic.hh:117</a></div></div>
<div class="ttc" id="anamespacepism_a782c0f064d473f15c29df4f1ac7bbed9_html_a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e"><div class="ttname"><a href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a18c773ab42ce063a989d4e8cab83476e">pism::MASK_FLOATING</a></div><div class="ttdeci">@ MASK_FLOATING</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00033">Mask.hh:33</a></div></div>
<div class="ttc" id="anamespacepism_a782c0f064d473f15c29df4f1ac7bbed9_html_a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7"><div class="ttname"><a href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9a326b5714dc6fc42c36cd024a72712da7">pism::MASK_ICE_FREE_OCEAN</a></div><div class="ttdeci">@ MASK_ICE_FREE_OCEAN</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00035">Mask.hh:34</a></div></div>
<div class="ttc" id="anamespacepism_a782c0f064d473f15c29df4f1ac7bbed9_html_a782c0f064d473f15c29df4f1ac7bbed9aeed831165149ebb8bf3426f0ace4a6c2"><div class="ttname"><a href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9aeed831165149ebb8bf3426f0ace4a6c2">pism::MASK_GROUNDED</a></div><div class="ttdeci">@ MASK_GROUNDED</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00032">Mask.hh:32</a></div></div>
<div class="ttc" id="anamespacepism_a976f562815a4de361bb1474e03db50d7_html_a976f562815a4de361bb1474e03db50d7a9a7c1c8a7a0101aa5968351fe1f6481a"><div class="ttname"><a href="namespacepism_a976f562815a4de361bb1474e03db50d7.html#a976f562815a4de361bb1474e03db50d7a9a7c1c8a7a0101aa5968351fe1f6481a">pism::PISM_NETCDF3</a></div><div class="ttdeci">@ PISM_NETCDF3</div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00041">IO_Flags.hh:41</a></div></div>
<div class="ttc" id="anamespacepism_a9f181807bb07f129ee1ed1bc0508b7ee_html_a9f181807bb07f129ee1ed1bc0508b7ee"><div class="ttname"><a href="namespacepism_a9f181807bb07f129ee1ed1bc0508b7ee.html#a9f181807bb07f129ee1ed1bc0508b7ee">pism::min</a></div><div class="ttdeci">double min(const IceModelVec2S &amp;input)</div><div class="ttdoc">Finds minimum over all the values in an IceModelVec2S object. Ignores ghosts.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec2_8cc_source.html#l00219">iceModelVec2.cc:219</a></div></div>
<div class="ttc" id="anamespacepism_aa10f25436946de00942fa3e84be9daf5_html_aa10f25436946de00942fa3e84be9daf5ac6201c2d87c567fd609d24016ecf2d49"><div class="ttname"><a href="namespacepism_aa10f25436946de00942fa3e84be9daf5.html#aa10f25436946de00942fa3e84be9daf5ac6201c2d87c567fd609d24016ecf2d49">pism::PISM_READONLY</a></div><div class="ttdeci">@ PISM_READONLY</div><div class="ttdoc">open an existing file for reading only</div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00049">IO_Flags.hh:49</a></div></div>
<div class="ttc" id="anamespacepism_ab50523fe25aadf4a123551726b2a2967_html_ab50523fe25aadf4a123551726b2a2967"><div class="ttname"><a href="namespacepism_ab50523fe25aadf4a123551726b2a2967.html#ab50523fe25aadf4a123551726b2a2967">pism::combine</a></div><div class="ttdeci">T combine(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="pism__utilities_8hh_source.html#l00093">pism_utilities.hh:93</a></div></div>
<div class="ttc" id="anamespacepism_ac3e0190c23e7e63d2755343a89b3b239_html_ac3e0190c23e7e63d2755343a89b3b239"><div class="ttname"><a href="namespacepism_ac3e0190c23e7e63d2755343a89b3b239.html#ac3e0190c23e7e63d2755343a89b3b239">pism::GlobalSum</a></div><div class="ttdeci">void GlobalSum(MPI_Comm comm, double *local, double *result, int count)</div><div class="ttdef"><b>Definition:</b> <a href="pism__utilities_8cc_source.html#l00164">pism_utilities.cc:164</a></div></div>
<div class="ttc" id="anamespacepism_ae50e2208404456d7dcfdca1da2484d23_html_ae50e2208404456d7dcfdca1da2484d23aa03926dd636ce1d977b1a8a9ed608c85"><div class="ttname"><a href="namespacepism_ae50e2208404456d7dcfdca1da2484d23.html#ae50e2208404456d7dcfdca1da2484d23aa03926dd636ce1d977b1a8a9ed608c85">pism::LINEAR</a></div><div class="ttdeci">@ LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="interpolation_8hh_source.html#l00028">interpolation.hh:28</a></div></div>
<div class="ttc" id="anamespacepism_af0700c6771420c20ac873c2779475d57_html_af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9"><div class="ttname"><a href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">pism::WITHOUT_GHOSTS</a></div><div class="ttdeci">@ WITHOUT_GHOSTS</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00049">iceModelVec.hh:49</a></div></div>
<div class="ttc" id="anamespacepism_af0700c6771420c20ac873c2779475d57_html_af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3"><div class="ttname"><a href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">pism::WITH_GHOSTS</a></div><div class="ttdeci">@ WITH_GHOSTS</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00049">iceModelVec.hh:49</a></div></div>
<div class="ttc" id="anamespacepism_html"><div class="ttname"><a href="namespacepism.html">pism</a></div><div class="ttdef"><b>Definition:</b> <a href="AgeColumnSystem_8cc_source.html#l00024">AgeColumnSystem.cc:24</a></div></div>
<div class="ttc" id="astructpism_1_1ForcingOptions_a5a9f2c92cf9f433d66e67ea0bd9fa810_html_a5a9f2c92cf9f433d66e67ea0bd9fa810"><div class="ttname"><a href="structpism_1_1ForcingOptions_a5a9f2c92cf9f433d66e67ea0bd9fa810.html#a5a9f2c92cf9f433d66e67ea0bd9fa810">pism::ForcingOptions::filename</a></div><div class="ttdeci">std::string filename</div><div class="ttdef"><b>Definition:</b> <a href="coupler_2util_2options_8hh_source.html#l00033">options.hh:33</a></div></div>
<div class="ttc" id="astructpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717_html_a8950d4d2c7f8e49adff11b121573b717"><div class="ttname"><a href="structpism_1_1ForcingOptions_a8950d4d2c7f8e49adff11b121573b717.html#a8950d4d2c7f8e49adff11b121573b717">pism::ForcingOptions::periodic</a></div><div class="ttdeci">bool periodic</div><div class="ttdef"><b>Definition:</b> <a href="coupler_2util_2options_8hh_source.html#l00034">options.hh:34</a></div></div>
<div class="ttc" id="astructpism_1_1ForcingOptions_html"><div class="ttname"><a href="structpism_1_1ForcingOptions.html">pism::ForcingOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="coupler_2util_2options_8hh_source.html#l00031">options.hh:31</a></div></div>
<div class="ttc" id="atest__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="test__cube_8c_ad43c3812e6d13e0518d9f8b8f463ffcf.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> <a href="test__cube_8c_source.html#l00016">test_cube.c:16</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
