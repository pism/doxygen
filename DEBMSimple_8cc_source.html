<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: src/coupler/surface/DEBMSimple.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.1-1-g6902d5502 committed by Ed Bueler on 2023-12-20 08:38:27 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0171d4959defe1f65341fde2c6309901.html">coupler</a></li><li class="navelem"><a class="el" href="dir_21634f6868024c5438a18f69ca9f47a1.html">surface</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">DEBMSimple.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="DEBMSimple_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (C) 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2022, 2023 PISM Authors</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// This file is part of PISM.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// PISM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// terms of the GNU General Public License as published by the Free Software</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Foundation; either version 3 of the License, or (at your option) any later</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// PISM is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// along with PISM; if not, write to the Free Software</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span> <span class="comment">// std::min</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;pism/coupler/surface/DEBMSimple.hh&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;pism/coupler/AtmosphereModel.hh&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;pism/util/Grid.hh&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;pism/util/Mask.hh&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;pism/util/Time.hh&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;pism/util/io/File.hh&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;pism/coupler/util/options.hh&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;pism/geometry/Geometry.hh&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;pism/util/array/CellType.hh&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;pism/util/error_handling.hh&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;pism/util/pism_utilities.hh&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;pism/util/Vars.hh&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;pism/util/array/Forcing.hh&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepism.html">pism</a> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">namespace </span>surface {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">///// PISM surface model implementing a dEBM-Simple scheme.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_adef67f630736eafba0a6c55f2c089c67.html#adef67f630736eafba0a6c55f2c089c67">   42</a></span>&#160;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_adef67f630736eafba0a6c55f2c089c67.html#adef67f630736eafba0a6c55f2c089c67">DEBMSimple::DEBMSimple</a>(std::shared_ptr&lt;const Grid&gt; <a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>, std::shared_ptr&lt;atmosphere::AtmosphereModel&gt; input)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  : <a class="code" href="classpism_1_1surface_1_1SurfaceModel.html">SurfaceModel</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>, std::move(input)),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      m_model(*<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>-&gt;ctx()),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      m_mass_flux(m_grid, <span class="stringliteral">&quot;climatic_mass_balance&quot;</span>),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      m_snow_depth(m_grid, <span class="stringliteral">&quot;snow_depth&quot;</span>),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      m_temperature_driven_melt(m_grid, <span class="stringliteral">&quot;debm_temperature_driven_melt_flux&quot;</span>),</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      m_insolation_driven_melt(m_grid, <span class="stringliteral">&quot;debm_insolation_driven_melt_flux&quot;</span>),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      m_offset_melt(m_grid, <span class="stringliteral">&quot;debm_offset_melt_flux&quot;</span>),</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      m_surface_albedo(m_grid, <span class="stringliteral">&quot;surface_albedo&quot;</span>),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      m_transmissivity(m_grid, <span class="stringliteral">&quot;atmosphere_transmissivity&quot;</span>) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9832b447bf3dfb1c68ab42680ab68f2e.html#a9832b447bf3dfb1c68ab42680ab68f2e">m_sd_use_param</a> = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_flag(<span class="stringliteral">&quot;surface.debm_simple.std_dev.param.enabled&quot;</span>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a81972ae984bf43b49c3a5ca3eeea9d8e.html#a81972ae984bf43b49c3a5ca3eeea9d8e">m_sd_param_a</a>   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.std_dev.param.a&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac01ecc6fa10e070f3dfb3100ecf1e5c1.html#ac01ecc6fa10e070f3dfb3100ecf1e5c1">m_sd_param_b</a>   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.std_dev.param.b&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_afd9a45145bf2a2fbd54fb2c33adf058e.html#afd9a45145bf2a2fbd54fb2c33adf058e">m_precip_as_snow</a> = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_flag(<span class="stringliteral">&quot;surface.debm_simple.interpret_precip_as_snow&quot;</span>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">m_Tmax</a>           = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.air_temp_all_precip_as_rain&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d.html#ae597f0f591d17204029dd4fccc2f7f5d">m_Tmin</a>           = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.air_temp_all_precip_as_snow&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">m_Tmax</a> &lt;= <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d.html#ae597f0f591d17204029dd4fccc2f7f5d">m_Tmin</a>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">throw</span> <a class="code" href="classpism_1_1RuntimeError_ad0ed5f05a9a4e3e403a1d62f8d1e4e7d.html#ad0ed5f05a9a4e3e403a1d62f8d1e4e7d">RuntimeError::formatted</a>(<a class="code" href="error__handling_8hh_aa0c260bffe8a4dbd77d48e8feee7c526.html#aa0c260bffe8a4dbd77d48e8feee7c526">PISM_ERROR_LOCATION</a>,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                  <span class="stringliteral">&quot;surface.debm_simple.air_temp_all_precip_as_rain has to exceed &quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                  <span class="stringliteral">&quot;surface.debm_simple.air_temp_all_precip_as_snow&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">// note: does not need to be calendar-aware</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_abccbac7f63843606ae008292e590c36e.html#abccbac7f63843606ae008292e590c36e">m_year_length</a> = <a class="code" href="namespacepism_1_1units_aae3f4db8a6a2365e607a699bc61a5077.html#aae3f4db8a6a2365e607a699bc61a5077">units::convert</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>-&gt;ctx()-&gt;unit_system(), 1.0, <span class="stringliteral">&quot;years&quot;</span>, <span class="stringliteral">&quot;seconds&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a97b5ec0fd1fa2ff74fa3728775b13e13.html#a97b5ec0fd1fa2ff74fa3728775b13e13">m_n_per_year</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.max_evals_per_year&quot;</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">auto</span> albedo_input = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_string(<span class="stringliteral">&quot;surface.debm_simple.albedo_input.file&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (not albedo_input.empty()) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot; Surface albedo is read in from %s...&quot;</span>, albedo_input.c_str());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="classpism_1_1File.html">File</a> file(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>-&gt;com, albedo_input, <a class="code" href="namespacepism_1_1io_a0caba8881b0d36c8cc1eccfa13c0e81f.html#a0caba8881b0d36c8cc1eccfa13c0e81fa308d77197e903bf4f5505b8cb5e377a2">io::PISM_GUESS</a>, <a class="code" href="namespacepism_1_1io_a12c1fd23e92335e2396baab0354b262f.html#a12c1fd23e92335e2396baab0354b262fabb5d91fa1da1214c24d193a75f11f0a2">io::PISM_READONLY</a>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordtype">int</span> buffer_size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;input.forcing.buffer_size&quot;</span>));</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">bool</span> periodic = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_flag(<span class="stringliteral">&quot;surface.debm_simple.albedo_input.periodic&quot;</span>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>  = std::make_shared&lt;array::Forcing&gt;(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                                                       file,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                                       <span class="stringliteral">&quot;surface_albedo&quot;</span>,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                                       <span class="stringliteral">&quot;surface_albedo&quot;</span>,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                                       buffer_size,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                                                       periodic,</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                                       <a class="code" href="namespacepism_a3415cf6a7a4530c4e489feebe6365e03.html#a3415cf6a7a4530c4e489feebe6365e03aa03926dd636ce1d977b1a8a9ed608c85">LINEAR</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>  = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// initialize the spatially-variable air temperature standard deviation</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keyword">auto</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">air_temp_sd</a> = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_string(<span class="stringliteral">&quot;surface.debm_simple.std_dev.file&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (not <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">air_temp_sd</a>.empty()) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;  Reading standard deviation of near-surface air temperature from &#39;%s&#39;...\n&quot;</span>,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                   <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">air_temp_sd</a>.c_str());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">int</span> buffer_size = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;input.forcing.buffer_size&quot;</span>));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="classpism_1_1File.html">File</a> file(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>-&gt;com, <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">air_temp_sd</a>, <a class="code" href="namespacepism_1_1io_a0caba8881b0d36c8cc1eccfa13c0e81f.html#a0caba8881b0d36c8cc1eccfa13c0e81fa308d77197e903bf4f5505b8cb5e377a2">io::PISM_GUESS</a>, <a class="code" href="namespacepism_1_1io_a12c1fd23e92335e2396baab0354b262f.html#a12c1fd23e92335e2396baab0354b262fabb5d91fa1da1214c24d193a75f11f0a2">io::PISM_READONLY</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">bool</span> periodic = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_flag(<span class="stringliteral">&quot;surface.debm_simple.std_dev.periodic&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a> = std::make_shared&lt;array::Forcing&gt;(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>, file, <span class="stringliteral">&quot;air_temp_sd&quot;</span>,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                                                     <span class="stringliteral">&quot;&quot;</span>, <span class="comment">// no standard name</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                     buffer_size, periodic, <a class="code" href="namespacepism_a3415cf6a7a4530c4e489feebe6365e03.html#a3415cf6a7a4530c4e489feebe6365e03aa03926dd636ce1d977b1a8a9ed608c85">LINEAR</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">double</span> temp_std_dev = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.std_dev&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a> = <a class="code" href="classpism_1_1array_1_1Forcing_a8569ad95d618a3b1b4c8b2b19c0c78f5.html#a8569ad95d618a3b1b4c8b2b19c0c78f5">array::Forcing::Constant</a>(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>, <span class="stringliteral">&quot;air_temp_sd&quot;</span>, temp_std_dev);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2, <span class="stringliteral">&quot;  Using constant standard deviation of near-surface air temperature.\n&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>-&gt;metadata(0)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      .long_name(<span class="stringliteral">&quot;standard deviation of near-surface air temperature&quot;</span>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      .units(<span class="stringliteral">&quot;Kelvin&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">m_mass_flux</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;instantaneous surface mass balance (accumulation/ablation) rate&quot;</span>)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;kg m-2 s-1&quot;</span>)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a2b7791d4794fd3deb3838e75b495ce33.html#a2b7791d4794fd3deb3838e75b495ce33">standard_name</a>(<span class="stringliteral">&quot;land_ice_surface_specific_mass_balance_flux&quot;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">m_mass_flux</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_aeaac3d7581fd57bca5088f50c4c462dc.html#aeaac3d7581fd57bca5088f50c4c462dc">set_string</a>(<span class="stringliteral">&quot;comment&quot;</span>, <span class="stringliteral">&quot;positive values correspond to ice gain&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">// diagnostic fields:</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94.html#ab47b1e4dde2bd7d425d249099c7e1e94">m_accumulation</a> = <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a459787d4d0c29c321bf56698190f2f12.html#a459787d4d0c29c321bf56698190f2f12">allocate_accumulation</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372.html#a124282cae2fa7860ff30dd3d9961b372">m_melt</a>         = <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a4b35686cb1a1884ddbe2d21689a46df7.html#a4b35686cb1a1884ddbe2d21689a46df7">allocate_melt</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d.html#a3db3545b6f624c292380c015e3553e1d">m_runoff</a>       = <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a0bc45dacd90ee84e94695505d3123ec6.html#a0bc45dacd90ee84e94695505d3123ec6">allocate_runoff</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aea3264416ee858399c04e9dd4856c4a7.html#aea3264416ee858399c04e9dd4856c4a7">m_temperature</a>  = <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a32219dd14a6a9d77222fb9c600e91f4e.html#a32219dd14a6a9d77222fb9c600e91f4e">allocate_temperature</a>(<a class="code" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">m_temperature_driven_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;temperature-driven melt in dEBM-simple&quot;</span>)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;kg m-2&quot;</span>);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">m_temperature_driven_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">m_insolation_driven_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;insolation-driven melt in dEBM-simple&quot;</span>)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;kg m-2&quot;</span>);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">m_insolation_driven_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">m_offset_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;offset melt in dEBM-simple&quot;</span>)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;kg m-2&quot;</span>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">m_offset_melt</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;snow cover depth (set to zero once a year)&quot;</span>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;m&quot;</span>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;surface_albedo&quot;</span>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;1&quot;</span>)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a2b7791d4794fd3deb3838e75b495ce33.html#a2b7791d4794fd3deb3838e75b495ce33">standard_name</a>(<span class="stringliteral">&quot;surface_albedo&quot;</span>);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>(0)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">long_name</a>(<span class="stringliteral">&quot;atmosphere_transmissivity&quot;</span>)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      .<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(<span class="stringliteral">&quot;1&quot;</span>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ae2d3e9e9b50dfb6cea3080b1f7fdf0ef.html#ae2d3e9e9b50dfb6cea3080b1f7fdf0ef">  166</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ae2d3e9e9b50dfb6cea3080b1f7fdf0ef.html#ae2d3e9e9b50dfb6cea3080b1f7fdf0ef">DEBMSimple::init_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1Geometry.html">Geometry</a> &amp;geometry) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// call the default implementation (not the interface method init())</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_ad96db6e402a90adb744b7e7ad9322cb3.html#ad96db6e402a90adb744b7e7ad9322cb3">SurfaceModel::init_impl</a>(geometry);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a>-&gt;message(2,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                   <span class="stringliteral">&quot;* Initializing dEBM-simple, the diurnal Energy Balance Model (simple version).\n&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                   <span class="stringliteral">&quot;  Inputs:  precipitation and 2m air temperature from an atmosphere model.\n&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                   <span class="stringliteral">&quot;  Outputs: SMB and ice upper surface temperature.\n&quot;</span>);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// initializing the model state</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="structpism_1_1InputOptions.html">InputOptions</a> input = <a class="code" href="namespacepism_a44fca05de5c3d0cb82c4a2910666b6e2.html#a44fca05de5c3d0cb82c4a2910666b6e2">process_input_options</a>(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>-&gt;com, <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keyword">auto</span> default_albedo =  <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.debm_simple.albedo_max&quot;</span>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (input.<a class="code" href="structpism_1_1InputOptions_a0fe5db51286e55c31b1575dc9ecc5d70.html#a0fe5db51286e55c31b1575dc9ecc5d70">type</a> == <a class="code" href="namespacepism_a56e80801555b7f36f4dd28941739654a.html#a56e80801555b7f36f4dd28941739654aa6aff4b43552f00d5cc331453ff4029bc">INIT_RESTART</a>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_a0326efd779d857755513901da9a54992.html#a0326efd779d857755513901da9a54992">read</a>(input.<a class="code" href="structpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5.html#a2dc298f0e83b951fa1df5eab910639e5">filename</a>, input.<a class="code" href="structpism_1_1InputOptions_ae33c7fb4ca1317444d959bc3e1514ba4.html#ae33c7fb4ca1317444d959bc3e1514ba4">record</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_a0326efd779d857755513901da9a54992.html#a0326efd779d857755513901da9a54992">read</a>(input.<a class="code" href="structpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5.html#a2dc298f0e83b951fa1df5eab910639e5">filename</a>, input.<a class="code" href="structpism_1_1InputOptions_ae33c7fb4ca1317444d959bc3e1514ba4.html#ae33c7fb4ca1317444d959bc3e1514ba4">record</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (input.<a class="code" href="structpism_1_1InputOptions_a0fe5db51286e55c31b1575dc9ecc5d70.html#a0fe5db51286e55c31b1575dc9ecc5d70">type</a> == <a class="code" href="namespacepism_a56e80801555b7f36f4dd28941739654a.html#a56e80801555b7f36f4dd28941739654aa260aa6280296d9fffc338c9ecdaba861">INIT_BOOTSTRAP</a>) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_aa7de6be7e8f785321df81d9fd6518a16.html#aa7de6be7e8f785321df81d9fd6518a16">regrid</a>(input.<a class="code" href="structpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5.html#a2dc298f0e83b951fa1df5eab910639e5">filename</a>, <a class="code" href="classpism_1_1io_1_1Default.html">io::Default</a>(0.0));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_aa7de6be7e8f785321df81d9fd6518a16.html#aa7de6be7e8f785321df81d9fd6518a16">regrid</a>(input.<a class="code" href="structpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5.html#a2dc298f0e83b951fa1df5eab910639e5">filename</a>, <a class="code" href="classpism_1_1io_1_1Default.html">io::Default</a>(default_albedo));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(0.0);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">set</a>(default_albedo);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classpism_1_1Component_a7737874c03a58a03498a33dc464d2ee9.html#a7737874c03a58a03498a33dc464d2ee9">regrid</a>(<span class="stringliteral">&quot;dEBM-simple surface model&quot;</span>, <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classpism_1_1Component_a7737874c03a58a03498a33dc464d2ee9.html#a7737874c03a58a03498a33dc464d2ee9">regrid</a>(<span class="stringliteral">&quot;dEBM-simple surface model&quot;</span>, <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">auto</span> filename = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_string(<span class="stringliteral">&quot;surface.debm_simple.albedo_input.file&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">bool</span> periodic = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_flag(<span class="stringliteral">&quot;surface.debm_simple.albedo_input.periodic&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>-&gt;init(filename, periodic);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// finish up</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a87037317421e95ed9ce28e8306f86765.html#a87037317421e95ed9ce28e8306f86765">m_next_balance_year_start</a> = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15.html#aa90c317d376b9956055251d59be97a15">compute_next_balance_year_start</a>(<a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>().current());</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94.html#ab47b1e4dde2bd7d425d249099c7e1e94">m_accumulation</a>-&gt;set(0.0);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372.html#a124282cae2fa7860ff30dd3d9961b372">m_melt</a>-&gt;set(0.0);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d.html#a3db3545b6f624c292380c015e3553e1d">m_runoff</a>-&gt;set(0.0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ad2b014031c4810a4f0afdf93be199099.html#ad2b014031c4810a4f0afdf93be199099">  214</a></span>&#160;<a class="code" href="classpism_1_1MaxTimestep.html">MaxTimestep</a> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad2b014031c4810a4f0afdf93be199099.html#ad2b014031c4810a4f0afdf93be199099">DEBMSimple::max_timestep_impl</a>(<span class="keywordtype">double</span> my_t)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;max_timestep(my_t);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15.html#aa90c317d376b9956055251d59be97a15">  218</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15.html#aa90c317d376b9956055251d59be97a15">DEBMSimple::compute_next_balance_year_start</a>(<span class="keywordtype">double</span> time) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// compute the time corresponding to the beginning of the next balance year</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">double</span> balance_year_start_day = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.mass_balance_year_start_day&quot;</span>),</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         one_day                = <a class="code" href="namespacepism_1_1units_aae3f4db8a6a2365e607a699bc61a5077.html#aae3f4db8a6a2365e607a699bc61a5077">units::convert</a>(<a class="code" href="classpism_1_1Component_a08f6b5a8e759c471d1a003804a8160ad.html#a08f6b5a8e759c471d1a003804a8160ad">m_sys</a>, 1.0, <span class="stringliteral">&quot;days&quot;</span>, <span class="stringliteral">&quot;seconds&quot;</span>),</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         year_start             = this-&gt;<a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>().<a class="code" href="classpism_1_1Time_a54e8efeb9a3cd257cc956f21f9838b71.html#a54e8efeb9a3cd257cc956f21f9838b71">calendar_year_start</a>(time),</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;         balance_year_start     = year_start + (balance_year_start_day - 1.0) * one_day;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span> (balance_year_start &gt; <a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> balance_year_start;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">return</span> this-&gt;<a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>().<a class="code" href="classpism_1_1Time_a007c6d7280a8a4f1b25e6a2b3f4a4779.html#a007c6d7280a8a4f1b25e6a2b3f4a4779">increment_date</a>(balance_year_start, 1);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">/** @brief Extracts snow accumulation from mixed (snow and rain) precipitation using a</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">  *  temperature threshold with a linear transition.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">  *</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">  * Rain is removed entirely from the surface mass balance, and will not be included in</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">  * the computed runoff, which is meltwater runoff.</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">  *</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">  * There is an linear transition for Tmin below which all precipitation is interpreted as</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">  * snow, and Tmax above which all precipitation is rain (see, e.g. [\ref Hock2005b]).</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">  *</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">  * Returns the *solid* (snow) accumulation *rate*.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  *</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">  * @param[in] T air temperature</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">  * @param[in] P precipitation rate</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a14e08e478b7186530b58a59cadb6538b.html#a14e08e478b7186530b58a59cadb6538b">  245</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a14e08e478b7186530b58a59cadb6538b.html#a14e08e478b7186530b58a59cadb6538b">DEBMSimple::snow_accumulation</a>(<span class="keywordtype">double</span> T, <span class="keywordtype">double</span> P)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <span class="comment">// do not allow negative precipitation</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">if</span> (P &lt; 0.0) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1DEBMSimple_afd9a45145bf2a2fbd54fb2c33adf058e.html#afd9a45145bf2a2fbd54fb2c33adf058e">m_precip_as_snow</a> or T &lt;= <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d.html#ae597f0f591d17204029dd4fccc2f7f5d">m_Tmin</a>) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// T &lt;= Tmin, all precip is snow</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">return</span> P;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <span class="keywordflow">if</span> (T &lt; <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">m_Tmax</a>) { <span class="comment">// linear transition from Tmin to Tmax</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">return</span> P * (<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">m_Tmax</a> - T) / (<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">m_Tmax</a> - <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d.html#ae597f0f591d17204029dd4fccc2f7f5d">m_Tmin</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="comment">// T &gt;= Tmax, all precip is rain -- ignore it</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a1419addaa79ec947e4308523d8b4ab96.html#a1419addaa79ec947e4308523d8b4ab96">  266</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a1419addaa79ec947e4308523d8b4ab96.html#a1419addaa79ec947e4308523d8b4ab96">DEBMSimple::update_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1Geometry.html">Geometry</a> &amp;geometry, <span class="keywordtype">double</span> t, <span class="keywordtype">double</span> dt) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> melting_point = 273.15;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="comment">// update to ensure that temperature and precipitation time series are correct:</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;update(geometry, t, dt);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// Use near-surface air temperature as the top-of-the-ice temperature:</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aea3264416ee858399c04e9dd4856c4a7.html#aea3264416ee858399c04e9dd4856c4a7">m_temperature</a>-&gt;copy_from(<a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;air_temperature());</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// Set up air temperature and precipitation time series</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordtype">int</span> N = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_abaac6021d4d9cc470b2d919420ce2555.html#abaac6021d4d9cc470b2d919420ce2555">timeseries_length</a>(dt));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> dtseries = dt / N;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  std::vector&lt;double&gt; ts(N), T(N), <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>(N), P(N), Alb(N);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  std::vector&lt;DEBMSimplePointwise::OrbitalParameters&gt; orbital(N);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    ts[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = t + <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> * dtseries;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// pre-compute orbital parameters which depend on time and *not* on the map-plane</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// location</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    orbital[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>.<a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise_ae8f5994419e9be643da013816c95b031.html#ae8f5994419e9be643da013816c95b031">orbital_parameters</a>(ts[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>]);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// update standard deviation time series</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>-&gt;update(t, dt);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>-&gt;init_interpolation(ts);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;mask             = geometry.<a class="code" href="classpism_1_1Geometry_a91ce5150ea7a1abe306fb59a63658217.html#a91ce5150ea7a1abe306fb59a63658217">cell_type</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;H                = geometry.<a class="code" href="classpism_1_1Geometry_a9f744ea4843a08036f6132922dc4dc2c.html#a9f744ea4843a08036f6132922dc4dc2c">ice_thickness</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp;surface_altitude = geometry.<a class="code" href="classpism_1_1Geometry_a44a91d340da6ec7376c89e4eeca876a1.html#a44a91d340da6ec7376c89e4eeca876a1">ice_surface_elevation</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="classpism_1_1array_1_1AccessScope.html">array::AccessScope</a> list</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    { &amp;mask,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      &amp;H,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>.get(),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">m_mass_flux</a>,</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>,</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94.html#ab47b1e4dde2bd7d425d249099c7e1e94">m_accumulation</a>.get(),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372.html#a124282cae2fa7860ff30dd3d9961b372">m_melt</a>.get(),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d.html#a3db3545b6f624c292380c015e3553e1d">m_runoff</a>.get(),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">m_temperature_driven_melt</a>,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">m_insolation_driven_melt</a>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">m_offset_melt</a>,</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      &amp;geometry.<a class="code" href="classpism_1_1Geometry_af342fcf68ac37ec2744e97dfce20dfd4.html#af342fcf68ac37ec2744e97dfce20dfd4">latitude</a>,</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      &amp;surface_altitude</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    };</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>-&gt;update(t, dt);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>-&gt;init_interpolation(ts);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    list.add(*<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordtype">double</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    ice_density    = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;constants.ice.density&quot;</span>),</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    sigmalapserate = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.pdd.std_dev.lapse_lat_rate&quot;</span>),</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    sigmabaselat   = <a class="code" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a>-&gt;get_number(<span class="stringliteral">&quot;surface.pdd.std_dev.lapse_lat_base&quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;init_timeseries(ts);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;begin_pointwise_access();</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="classpism_1_1ParallelSection.html">ParallelSection</a> loop(<a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>-&gt;com);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = <a class="code" href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">m_grid</a>-&gt;points(); p; p.next()) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordtype">double</span> latitude = geometry.<a class="code" href="classpism_1_1Geometry_af342fcf68ac37ec2744e97dfce20dfd4.html#af342fcf68ac37ec2744e97dfce20dfd4">latitude</a>(i, j);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">// Get the temperature time series from an atmosphere model and its modifiers</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;temp_time_series(i, j, T);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">if</span> (mask.ice_free_ocean(i, j)) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="comment">// ignore precipitation over ice-free ocean</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;          P[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = 0.0;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">// elsewhere, get precipitation from the atmosphere model</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;precip_time_series(i, j, P);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// Use temperature time series to remove rainfall from precipitation and convert to</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">// m/s ice equivalent.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          P[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a14e08e478b7186530b58a59cadb6538b.html#a14e08e478b7186530b58a59cadb6538b">snow_accumulation</a>(T[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>],  <span class="comment">// air temperature (input)</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                   P[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] / ice_density); <span class="comment">// precipitation rate (input, gets overwritten)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>)<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>-&gt;interp(i, j, Alb);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">// standard deviation of daily variability of air temperature</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// interpolate temperature standard deviation time series</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">// Note: this works when m_air_temp_sd is constant in time.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>-&gt;interp(i, j, <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> (sigmalapserate != 0.0) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <span class="comment">// apply standard deviation lapse rate on top of prescribed values</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] += sigmalapserate * (latitude - sigmabaselat);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          (*m_air_temp_sd)(i, j) = <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>[0]; <span class="comment">// ensure correct SD reporting</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9832b447bf3dfb1c68ab42680ab68f2e.html#a9832b447bf3dfb1c68ab42680ab68f2e">m_sd_use_param</a> and mask.icy(i, j)) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <span class="comment">// apply standard deviation parameterization over ice if in use</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = <a class="code" href="namespacepism_1_1array_a8957d08741c6f48d1e554ac7ea98530a.html#a8957d08741c6f48d1e554ac7ea98530a">std::max</a>(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a81972ae984bf43b49c3a5ca3eeea9d8e.html#a81972ae984bf43b49c3a5ca3eeea9d8e">m_sd_param_a</a> * (T[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] - melting_point) + <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac01ecc6fa10e070f3dfb3100ecf1e5c1.html#ac01ecc6fa10e070f3dfb3100ecf1e5c1">m_sd_param_b</a>, 0.0);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          (*m_air_temp_sd)(i, j) = <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>[0]; <span class="comment">// ensure correct SD reporting</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordtype">double</span> next_snow_depth_reset = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a87037317421e95ed9ce28e8306f86765.html#a87037317421e95ed9ce28e8306f86765">m_next_balance_year_start</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="comment">// make copies of firn and snow depth values at this point to avoid accessing 2D</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="comment">// fields in the inner loop</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordtype">double</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          ice_thickness = H(i, j),</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          snow          = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>(i, j),</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          surfelev      = surface_altitude(i, j),</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          albedo        = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>(i, j);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keyword">auto</span> cell_type = <span class="keyword">static_cast&lt;</span><a class="code" href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9">MaskValue</a><span class="keyword">&gt;</span>(mask.as_int(i, j));</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordtype">double</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          A   = 0.0,            <span class="comment">// accumulation</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;          M   = 0.0,            <span class="comment">// melt</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;          R   = 0.0,            <span class="comment">// runoff</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          <a class="code" href="namespacepism_1_1diagnostics_a9be104df35f48c5782d93a48a0890024.html#a9be104df35f48c5782d93a48a0890024af801d3552a0696abd73d75b3270885aa">SMB</a> = 0.0,            <span class="comment">// resulting mass balance</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          Mi  = 0.0,            <span class="comment">// insolation melt contribution</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          Mt  = 0.0,            <span class="comment">// temperature melt contribution</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;          Mc  = 0.0,            <span class="comment">// offset melt contribution</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          Al  = 0.0;            <span class="comment">// albedo</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="comment">// beginning of the loop over small time steps:</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; ++<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="keywordflow">if</span> (ts[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] &gt;= next_snow_depth_reset) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            snow = 0.0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">while</span> (next_snow_depth_reset &lt;= ts[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>]) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;              next_snow_depth_reset = <a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>().<a class="code" href="classpism_1_1Time_a007c6d7280a8a4f1b25e6a2b3f4a4779.html#a007c6d7280a8a4f1b25e6a2b3f4a4779">increment_date</a>(next_snow_depth_reset, 1);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <span class="keyword">auto</span> <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a356651c8125dcb5552ea01d27b29ce1d.html#a356651c8125dcb5552ea01d27b29ce1d">accumulation</a> = P[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] * dtseries;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          <a class="code" href="classpism_1_1surface_1_1DEBMSimpleMelt.html">DEBMSimpleMelt</a> melt_info{};</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          <span class="keywordflow">if</span> (not <a class="code" href="namespacepism_1_1mask_aa0f191a232701f97c950f59485b8e429.html#aa0f191a232701f97c950f59485b8e429">mask::ice_free_ocean</a>(cell_type)) {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;            melt_info = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>.<a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise_a41be9bb9f422a0a79f9840ccb50776b5.html#a41be9bb9f422a0a79f9840ccb50776b5">melt</a>(orbital[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>].declination,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                     orbital[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>].distance_factor,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                     dtseries,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                     <a class="code" href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a>[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>],</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                     T[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>],</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                                     surfelev,</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                     latitude,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                     (<span class="keywordtype">bool</span>)<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a> ? Alb[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] : albedo);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="keyword">auto</span> changes = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>.<a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise_a70f44bd227dc10918271229783f25cf8.html#a70f44bd227dc10918271229783f25cf8">step</a>(ice_thickness,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                      melt_info.total_melt,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                      snow,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                      <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a356651c8125dcb5552ea01d27b29ce1d.html#a356651c8125dcb5552ea01d27b29ce1d">accumulation</a>);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;          <span class="keywordflow">if</span> ((<span class="keywordtype">bool</span>) <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">m_input_albedo</a>) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            albedo = Alb[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            albedo = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>.<a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise_a04383e7f9545a4ca9cc3381e6853894e.html#a04383e7f9545a4ca9cc3381e6853894e">albedo</a>(changes.melt / dtseries, cell_type);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;          }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;          <span class="comment">// update ice thickness</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;          ice_thickness += changes.smb;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;          assert(ice_thickness &gt;= 0);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;          <span class="comment">// update snow depth</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;          snow += changes.snow_depth;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          assert(snow &gt;= 0);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="comment">// update total accumulation, melt, and runoff</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;          {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            A   += <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a356651c8125dcb5552ea01d27b29ce1d.html#a356651c8125dcb5552ea01d27b29ce1d">accumulation</a>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            M   += changes.melt;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            Mt  += melt_info.temperature_melt;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            Mi  += melt_info.insolation_melt;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            Mc  += melt_info.offset_melt;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            R   += changes.runoff;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <a class="code" href="namespacepism_1_1diagnostics_a9be104df35f48c5782d93a48a0890024.html#a9be104df35f48c5782d93a48a0890024af801d3552a0696abd73d75b3270885aa">SMB</a> += changes.smb;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            Al  += albedo;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        } <span class="comment">// end of the time-stepping loop</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">// set firn and snow depths</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>(i, j)     = snow;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>(i, j) = Al / N;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>(i, j) = <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>.<a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise_aa0e393841035837406a6c4d502019911.html#aa0e393841035837406a6c4d502019911">atmosphere_transmissivity</a>(surfelev);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="comment">// set melt terms at this point, converting</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">// from &quot;meters, ice equivalent&quot; to &quot;kg / m^2&quot;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">m_temperature_driven_melt</a>(i, j) = Mt * ice_density;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">m_insolation_driven_melt</a>(i, j)  = Mi * ice_density;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">m_offset_melt</a>(i, j)         = Mc * ice_density;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="comment">// set total accumulation, melt, and runoff, and SMB at this point, converting</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">// from &quot;meters, ice equivalent&quot; to &quot;kg / m^2&quot;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;          (*m_accumulation)(i, j) = A * ice_density;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;          (*m_melt)(i, j)         = M * ice_density;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;          (*m_runoff)(i, j)       = R * ice_density;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;          <span class="comment">// m_mass_flux (unlike m_accumulation, m_melt, and m_runoff), is a</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;          <span class="comment">// rate. m * (kg / m^3) / second = kg / m^2 / second</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">m_mass_flux</a>(i, j) = <a class="code" href="namespacepism_1_1diagnostics_a9be104df35f48c5782d93a48a0890024.html#a9be104df35f48c5782d93a48a0890024af801d3552a0696abd73d75b3270885aa">SMB</a> * ice_density / dt;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="keywordflow">if</span> (mask.ice_free_ocean(i, j)) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>(i, j) = 0.0; <span class="comment">// snow over the ocean does not stick</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    loop.<a class="code" href="classpism_1_1ParallelSection_a6b0a6e5e64970af7eadabfebe2b20bd2.html#a6b0a6e5e64970af7eadabfebe2b20bd2">failed</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  loop.<a class="code" href="classpism_1_1ParallelSection_ac23296abee1cbcb3c3fd68c7f5ce0835.html#ac23296abee1cbcb3c3fd68c7f5ce0835">check</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">m_atmosphere</a>-&gt;end_pointwise_access();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a87037317421e95ed9ce28e8306f86765.html#a87037317421e95ed9ce28e8306f86765">m_next_balance_year_start</a> =</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15.html#aa90c317d376b9956055251d59be97a15">compute_next_balance_year_start</a>(<a class="code" href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">time</a>().current());</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a11ec32364216b41edb286ced399fec8c.html#a11ec32364216b41edb286ced399fec8c">  501</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a11ec32364216b41edb286ced399fec8c.html#a11ec32364216b41edb286ced399fec8c">DEBMSimple::mass_flux_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">m_mass_flux</a>;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_afa2a9ecb5a2157d5e959d14bfd0d82a3.html#afa2a9ecb5a2157d5e959d14bfd0d82a3">  505</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_afa2a9ecb5a2157d5e959d14bfd0d82a3.html#afa2a9ecb5a2157d5e959d14bfd0d82a3">DEBMSimple::temperature_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classpism_1_1surface_1_1DEBMSimple_aea3264416ee858399c04e9dd4856c4a7.html#aea3264416ee858399c04e9dd4856c4a7">m_temperature</a>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ac977d7bd508cb2a5c056af23afa1dd30.html#ac977d7bd508cb2a5c056af23afa1dd30">  509</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac977d7bd508cb2a5c056af23afa1dd30.html#ac977d7bd508cb2a5c056af23afa1dd30">DEBMSimple::accumulation_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classpism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94.html#ab47b1e4dde2bd7d425d249099c7e1e94">m_accumulation</a>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ad2b4a43ccffe7c006884656be6fb2c00.html#ad2b4a43ccffe7c006884656be6fb2c00">  513</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad2b4a43ccffe7c006884656be6fb2c00.html#ad2b4a43ccffe7c006884656be6fb2c00">DEBMSimple::melt_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372.html#a124282cae2fa7860ff30dd3d9961b372">m_melt</a>;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a969fb707aa3eb99c3efe8b3c4cab6f4d.html#a969fb707aa3eb99c3efe8b3c4cab6f4d">  517</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a969fb707aa3eb99c3efe8b3c4cab6f4d.html#a969fb707aa3eb99c3efe8b3c4cab6f4d">DEBMSimple::runoff_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d.html#a3db3545b6f624c292380c015e3553e1d">m_runoff</a>;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_acdc5c6d688c46fb51a7a6cf760de7555.html#acdc5c6d688c46fb51a7a6cf760de7555">  521</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_acdc5c6d688c46fb51a7a6cf760de7555.html#acdc5c6d688c46fb51a7a6cf760de7555">DEBMSimple::snow_depth</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">  525</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">DEBMSimple::air_temp_sd</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">return</span> *<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;}</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a1711a0a3d0f16820080d4e3120cdc039.html#a1711a0a3d0f16820080d4e3120cdc039">  529</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a1711a0a3d0f16820080d4e3120cdc039.html#a1711a0a3d0f16820080d4e3120cdc039">DEBMSimple::insolation_driven_melt</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">m_insolation_driven_melt</a>;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_acf76a79e5e1d12d97d201d369f38ccfe.html#acf76a79e5e1d12d97d201d369f38ccfe">  533</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_acf76a79e5e1d12d97d201d369f38ccfe.html#acf76a79e5e1d12d97d201d369f38ccfe">DEBMSimple::temperature_driven_melt</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">m_temperature_driven_melt</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;}</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ac463f359e1babf5931fc58744efa64fc.html#ac463f359e1babf5931fc58744efa64fc">  537</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac463f359e1babf5931fc58744efa64fc.html#ac463f359e1babf5931fc58744efa64fc">DEBMSimple::offset_melt</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">m_offset_melt</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;}</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a1e02dff535c529c04bb793ac46f4b9df.html#a1e02dff535c529c04bb793ac46f4b9df">  541</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a1e02dff535c529c04bb793ac46f4b9df.html#a1e02dff535c529c04bb793ac46f4b9df">DEBMSimple::surface_albedo</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a09bd225d72497d0095f4b247a7f3aacd.html#a09bd225d72497d0095f4b247a7f3aacd">  545</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a09bd225d72497d0095f4b247a7f3aacd.html#a09bd225d72497d0095f4b247a7f3aacd">DEBMSimple::atmosphere_transmissivity</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a6d8329beb1d21ba11d0cc91c09ed214a.html#a6d8329beb1d21ba11d0cc91c09ed214a">  549</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a6d8329beb1d21ba11d0cc91c09ed214a.html#a6d8329beb1d21ba11d0cc91c09ed214a">DEBMSimple::define_model_state_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1File.html">File</a> &amp;output)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a2e6c1ed05226d150c8240ad865946999.html#a2e6c1ed05226d150c8240ad865946999">SurfaceModel::define_model_state_impl</a>(output);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_a3e1a5859cef073a95e5e0cc5f1cc0fdb.html#a3e1a5859cef073a95e5e0cc5f1cc0fdb">define</a>(output, <a class="code" href="namespacepism_1_1io_a53ffb40793c398e10644fbd2ecda3e77.html#a53ffb40793c398e10644fbd2ecda3e77a6a72c64f82168bec6bf8b648a86648de">io::PISM_DOUBLE</a>);</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_a3e1a5859cef073a95e5e0cc5f1cc0fdb.html#a3e1a5859cef073a95e5e0cc5f1cc0fdb">define</a>(output, <a class="code" href="namespacepism_1_1io_a53ffb40793c398e10644fbd2ecda3e77.html#a53ffb40793c398e10644fbd2ecda3e77a6a72c64f82168bec6bf8b648a86648de">io::PISM_DOUBLE</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_a7d5b2bdfe9f126176f04adc64b5ad775.html#a7d5b2bdfe9f126176f04adc64b5ad775">  555</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a7d5b2bdfe9f126176f04adc64b5ad775.html#a7d5b2bdfe9f126176f04adc64b5ad775">DEBMSimple::write_model_state_impl</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1File.html">File</a> &amp;output)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a2d7e7c56b9feab53f1b9058ed738ff24.html#a2d7e7c56b9feab53f1b9058ed738ff24">SurfaceModel::write_model_state_impl</a>(output);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>.<a class="code" href="classpism_1_1array_1_1Array_a4cdaeb827d166a076668d2ab86416793.html#a4cdaeb827d166a076668d2ab86416793">write</a>(output);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>.<a class="code" href="classpism_1_1array_1_1Array_a4cdaeb827d166a076668d2ab86416793.html#a4cdaeb827d166a076668d2ab86416793">write</a>(output);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;}</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_aecf74df33a09286608cbcc9c79eded9a.html#aecf74df33a09286608cbcc9c79eded9a">  561</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimplePointwise.html">DEBMSimplePointwise</a>&amp; <a class="code" href="classpism_1_1surface_1_1DEBMSimple_aecf74df33a09286608cbcc9c79eded9a.html#aecf74df33a09286608cbcc9c79eded9a">DEBMSimple::pointwise_model</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">m_model</a>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="namespacepism_1_1surface_1_1diagnostics.html">  565</a></span>&#160;<span class="keyword">namespace </span>diagnostics {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">/*! @brief Report mean top of atmosphere insolation */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation.html">  568</a></span>&#160;<span class="keyword">class </span><a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation.html">DEBMSInsolation</a> : <span class="keyword">public</span> <a class="code" href="classpism_1_1Diag.html">Diag</a>&lt;DEBMSimple&gt;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00571"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_ac629e1ea8546500a4fa976b8a5d7d50d.html#ac629e1ea8546500a4fa976b8a5d7d50d">  571</a></span>&#160;  <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_ac629e1ea8546500a4fa976b8a5d7d50d.html#ac629e1ea8546500a4fa976b8a5d7d50d">DEBMSInsolation</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a> *m) : <a class="code" href="classpism_1_1Diag.html">Diag</a>&lt;<a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a>&gt;(m) {</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a> = { { <a class="code" href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">m_sys</a>, <span class="stringliteral">&quot;insolation&quot;</span> } };</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0]</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        .long_name(</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            <span class="stringliteral">&quot;mean top of atmosphere insolation during the period when the sun is above the critical angle Phi&quot;</span>)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        .units(<span class="stringliteral">&quot;W m-2&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00580"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_af8029b6cfe4959a9006c95396bf2146a.html#af8029b6cfe4959a9006c95396bf2146a">  580</a></span>&#160;  std::shared_ptr&lt;array::Array&gt; <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_af8029b6cfe4959a9006c95396bf2146a.html#af8029b6cfe4959a9006c95396bf2146a">compute_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="keyword">auto</span> result = allocate&lt;array::Scalar&gt;(<span class="stringliteral">&quot;insolation&quot;</span>);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> *latitude = <a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;variables().get_2d_scalar(<span class="stringliteral">&quot;latitude&quot;</span>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keyword">auto</span> ctx = <a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;ctx();</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; M = <a class="code" href="classpism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711.html#aa3e0516ca815c840bfa479256aa1f711">model</a>-&gt;pointwise_model();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keyword">auto</span> orbital = M.orbital_parameters(ctx-&gt;time()-&gt;current());</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <a class="code" href="classpism_1_1array_1_1AccessScope.html">array::AccessScope</a> list{latitude, result.get()};</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = <a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;points(); p; p.next()) {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> i = p.i(), j = p.j();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        (*result)(i, j) = M.insolation(orbital.declination,</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                       orbital.distance_factor,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                       (*latitude)(i, j));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;};</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">  607</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> { <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a> };</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">/*! @brief Report surface insolation melt, averaged over the reporting interval */</span></div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt.html">  610</a></span>&#160;<span class="keyword">class </span><a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt.html">DEBMSInsolationMelt</a> : <span class="keyword">public</span> <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;DEBMSimple&gt; {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00612"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a107a07dce9b156533bd0c0dbec798a54.html#a107a07dce9b156533bd0c0dbec798a54">  612</a></span>&#160;  <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a107a07dce9b156533bd0c0dbec798a54.html#a107a07dce9b156533bd0c0dbec798a54">DEBMSInsolationMelt</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a> *m, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> kind)</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    : <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;<a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a>&gt;(m,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                  kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                  ? <span class="stringliteral">&quot;debm_insolation_driven_melt_flux&quot;</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                  : <span class="stringliteral">&quot;debm_insolation_driven_melt_rate&quot;</span>,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                  <a class="code" href="classpism_1_1DiagAverageRate_a44a50685701b5dcd19e71e4f2cc1e46f.html#a44a50685701b5dcd19e71e4f2cc1e46fa5ff14e4c51b9dfcb0540c0ce28d67cdd">TOTAL_CHANGE</a>),</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47.html#aee35e2a7dec65c0b459854b06d1b8b47">m_kind</a>(kind),</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">m_melt_mass</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>, <span class="stringliteral">&quot;debm_insolation_driven_melt_mass&quot;</span>) {</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    std::string</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      name          = <span class="stringliteral">&quot;debm_insolation_driven_melt_flux&quot;</span>,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      long_name     = <span class="stringliteral">&quot;surface insolation melt, averaged over the reporting interval&quot;</span>,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      accumulator_units = <span class="stringliteral">&quot;kg m-2&quot;</span>,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      internal_units = <span class="stringliteral">&quot;kg m-2 second-1&quot;</span>,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      external_units = <span class="stringliteral">&quot;kg m-2 year-1&quot;</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">if</span> (kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      name          = <span class="stringliteral">&quot;debm_insolation_driven_melt_rate&quot;</span>;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      accumulator_units = <span class="stringliteral">&quot;kg&quot;</span>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      internal_units = <span class="stringliteral">&quot;kg second-1&quot;</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      external_units = <span class="stringliteral">&quot;Gt year-1&quot;</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="classpism_1_1DiagAverageRate_a252d2c1d0942cf6f75fd5c85255aae93.html#a252d2c1d0942cf6f75fd5c85255aae93">m_accumulator</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(accumulator_units);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a> = { { <a class="code" href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">m_sys</a>, name } };</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0]</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        .long_name(long_name)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        .units(internal_units)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        .output_units(external_units);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_string(<span class="stringliteral">&quot;cell_methods&quot;</span>, <span class="stringliteral">&quot;time: mean&quot;</span>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">double</span> fill_value = <a class="code" href="namespacepism_1_1units_aae3f4db8a6a2365e607a699bc61a5077.html#aae3f4db8a6a2365e607a699bc61a5077">units::convert</a>(<a class="code" href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">m_sys</a>, <a class="code" href="classpism_1_1Diagnostic_a4d9fd84fa2feaaf986df8ecbe6832506.html#a4d9fd84fa2feaaf986df8ecbe6832506">m_fill_value</a>, external_units, internal_units);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_number(<span class="stringliteral">&quot;_FillValue&quot;</span>, fill_value);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  }</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a5e52dc3020159ca26ee188f2a78f60b8.html#a5e52dc3020159ca26ee188f2a78f60b8">  648</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a5e52dc3020159ca26ee188f2a78f60b8.html#a5e52dc3020159ca26ee188f2a78f60b8">model_input</a>() {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;melt_amount = <a class="code" href="classpism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711.html#aa3e0516ca815c840bfa479256aa1f711">model</a>-&gt;insolation_driven_melt();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47.html#aee35e2a7dec65c0b459854b06d1b8b47">m_kind</a> == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array2D_a7b9a0d8a83d5379f1debdcefce0fffae.html#a7b9a0d8a83d5379f1debdcefce0fffae">copy_from</a>(melt_amount);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array_a7b700739a7f5845c95fa33375a497901.html#a7b700739a7f5845c95fa33375a497901">scale</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;cell_area());</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">m_melt_mass</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">return</span> melt_amount;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00661"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47.html#aee35e2a7dec65c0b459854b06d1b8b47">  661</a></span>&#160;  <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47.html#aee35e2a7dec65c0b459854b06d1b8b47">m_kind</a>;</div>
<div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">  662</a></span>&#160;  <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">m_melt_mass</a>;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;};</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">/*! @brief Report surface temperature melt, averaged over the reporting interval */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt.html">  666</a></span>&#160;<span class="keyword">class </span><a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt.html">DEBMSTemperatureMelt</a> : <span class="keyword">public</span> <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;DEBMSimple&gt; {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00668"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_ab50516a2af5aafcd1a867d26420197d5.html#ab50516a2af5aafcd1a867d26420197d5">  668</a></span>&#160;  <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_ab50516a2af5aafcd1a867d26420197d5.html#ab50516a2af5aafcd1a867d26420197d5">DEBMSTemperatureMelt</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a> *m, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> kind)</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      : <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;<a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a>&gt;(m,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                                    kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                    ? <span class="stringliteral">&quot;debm_temperature_driven_melt_flux&quot;</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                    : <span class="stringliteral">&quot;debm_temperature_driven_melt_rate&quot;</span>,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                    <a class="code" href="classpism_1_1DiagAverageRate_a44a50685701b5dcd19e71e4f2cc1e46f.html#a44a50685701b5dcd19e71e4f2cc1e46fa5ff14e4c51b9dfcb0540c0ce28d67cdd">TOTAL_CHANGE</a>),</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122.html#a5a9890f3ca16b52b8e031f9e9f1a0122">m_kind</a>(kind),</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">m_melt_mass</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>, <span class="stringliteral">&quot;temperature_melt_mass&quot;</span>) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    std::string</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      name          = <span class="stringliteral">&quot;debm_temperature_driven_melt_flux&quot;</span>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      long_name     = <span class="stringliteral">&quot;temperature-driven melt, averaged over the reporting interval&quot;</span>,</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      accumulator_units = <span class="stringliteral">&quot;kg m-2&quot;</span>,</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      internal_units = <span class="stringliteral">&quot;kg m-2 second-1&quot;</span>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      external_units = <span class="stringliteral">&quot;kg m-2 year-1&quot;</span>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <span class="keywordflow">if</span> (kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      name          = <span class="stringliteral">&quot;debm_temperature_driven_melt_rate&quot;</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      accumulator_units = <span class="stringliteral">&quot;kg&quot;</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      internal_units = <span class="stringliteral">&quot;kg second-1&quot;</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      external_units = <span class="stringliteral">&quot;Gt year-1&quot;</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <a class="code" href="classpism_1_1DiagAverageRate_a252d2c1d0942cf6f75fd5c85255aae93.html#a252d2c1d0942cf6f75fd5c85255aae93">m_accumulator</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(accumulator_units);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a> = { { <a class="code" href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">m_sys</a>, name } };</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0]</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        .long_name(long_name)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        .units(internal_units)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        .output_units(external_units);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_string(<span class="stringliteral">&quot;cell_methods&quot;</span>, <span class="stringliteral">&quot;time: mean&quot;</span>);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_number(<span class="stringliteral">&quot;_FillValue&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a71431ab62fe704b0a9317140f3ab3bd3.html#a71431ab62fe704b0a9317140f3ab3bd3">to_internal</a>(<a class="code" href="classpism_1_1Diagnostic_a4d9fd84fa2feaaf986df8ecbe6832506.html#a4d9fd84fa2feaaf986df8ecbe6832506">m_fill_value</a>));</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a7079beda7c7d3fa84151977f9c1fb2f0.html#a7079beda7c7d3fa84151977f9c1fb2f0">  702</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a7079beda7c7d3fa84151977f9c1fb2f0.html#a7079beda7c7d3fa84151977f9c1fb2f0">model_input</a>() {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;melt_amount = <a class="code" href="classpism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711.html#aa3e0516ca815c840bfa479256aa1f711">model</a>-&gt;temperature_driven_melt();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122.html#a5a9890f3ca16b52b8e031f9e9f1a0122">m_kind</a> == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array2D_a7b9a0d8a83d5379f1debdcefce0fffae.html#a7b9a0d8a83d5379f1debdcefce0fffae">copy_from</a>(melt_amount);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array_a7b700739a7f5845c95fa33375a497901.html#a7b700739a7f5845c95fa33375a497901">scale</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;cell_area());</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">m_melt_mass</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">return</span> melt_amount;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122.html#a5a9890f3ca16b52b8e031f9e9f1a0122">  715</a></span>&#160;  <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122.html#a5a9890f3ca16b52b8e031f9e9f1a0122">m_kind</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">  716</a></span>&#160;  <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">m_melt_mass</a>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;};</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">/*! @brief Report surface backround melt, averaged over the reporting interval */</span></div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt.html">  720</a></span>&#160;<span class="keyword">class </span><a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt.html">DEBMSBackroundMelt</a> : <span class="keyword">public</span> <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;DEBMSimple&gt; {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ae13b366b9cb46e69862bdf267f0a078f.html#ae13b366b9cb46e69862bdf267f0a078f">  722</a></span>&#160;  <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ae13b366b9cb46e69862bdf267f0a078f.html#ae13b366b9cb46e69862bdf267f0a078f">DEBMSBackroundMelt</a>(<span class="keyword">const</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a> *m, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> kind)</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      : <a class="code" href="classpism_1_1DiagAverageRate.html">DiagAverageRate</a>&lt;<a class="code" href="classpism_1_1surface_1_1DEBMSimple.html">DEBMSimple</a>&gt;(m,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                                    kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                                    ? <span class="stringliteral">&quot;debm_offset_melt_flux&quot;</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                    : <span class="stringliteral">&quot;debm_offset_melt_rate&quot;</span>,</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                    <a class="code" href="classpism_1_1DiagAverageRate_a44a50685701b5dcd19e71e4f2cc1e46f.html#a44a50685701b5dcd19e71e4f2cc1e46fa5ff14e4c51b9dfcb0540c0ce28d67cdd">TOTAL_CHANGE</a>),</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8.html#ad9859be62d624ecd9ee8c80704d282c8">m_kind</a>(kind),</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">m_melt_mass</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>, <span class="stringliteral">&quot;backround_melt_mass&quot;</span>) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    std::string name              = <span class="stringliteral">&quot;debm_offset_melt_flux&quot;</span>,</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                long_name         = <span class="stringliteral">&quot;offset melt, averaged over the reporting interval&quot;</span>,</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                accumulator_units = <span class="stringliteral">&quot;kg m-2&quot;</span>,</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                internal_units    = <span class="stringliteral">&quot;kg m-2 second-1&quot;</span>,</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                external_units    = <span class="stringliteral">&quot;kg m-2 year-1&quot;</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span> (kind == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      name              = <span class="stringliteral">&quot;debm_offset_melt_rate&quot;</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      accumulator_units = <span class="stringliteral">&quot;kg&quot;</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      internal_units    = <span class="stringliteral">&quot;kg second-1&quot;</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      external_units    = <span class="stringliteral">&quot;Gt year-1&quot;</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <a class="code" href="classpism_1_1DiagAverageRate_a252d2c1d0942cf6f75fd5c85255aae93.html#a252d2c1d0942cf6f75fd5c85255aae93">m_accumulator</a>.<a class="code" href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">metadata</a>().<a class="code" href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">units</a>(accumulator_units);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a> = { { <a class="code" href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">m_sys</a>, name } };</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0]</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        .long_name(long_name)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        .units(internal_units)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        .output_units(external_units);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_string(<span class="stringliteral">&quot;cell_methods&quot;</span>, <span class="stringliteral">&quot;time: mean&quot;</span>);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">m_vars</a>[0].set_number(<span class="stringliteral">&quot;_FillValue&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a71431ab62fe704b0a9317140f3ab3bd3.html#a71431ab62fe704b0a9317140f3ab3bd3">to_internal</a>(<a class="code" href="classpism_1_1Diagnostic_a4d9fd84fa2feaaf986df8ecbe6832506.html#a4d9fd84fa2feaaf986df8ecbe6832506">m_fill_value</a>));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  }</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad250dead7b27b5a28ebc4f090666671a.html#ad250dead7b27b5a28ebc4f090666671a">  755</a></span>&#160;  <span class="keyword">const</span> <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad250dead7b27b5a28ebc4f090666671a.html#ad250dead7b27b5a28ebc4f090666671a">model_input</a>() {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;melt_amount = <a class="code" href="classpism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711.html#aa3e0516ca815c840bfa479256aa1f711">model</a>-&gt;offset_melt();</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8.html#ad9859be62d624ecd9ee8c80704d282c8">m_kind</a> == <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array2D_a7b9a0d8a83d5379f1debdcefce0fffae.html#a7b9a0d8a83d5379f1debdcefce0fffae">copy_from</a>(melt_amount);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">m_melt_mass</a>.<a class="code" href="classpism_1_1array_1_1Array_a7b700739a7f5845c95fa33375a497901.html#a7b700739a7f5845c95fa33375a497901">scale</a>(<a class="code" href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">m_grid</a>-&gt;cell_area());</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">m_melt_mass</a>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span> melt_amount;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8.html#ad9859be62d624ecd9ee8c80704d282c8">  768</a></span>&#160;  <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">AmountKind</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8.html#ad9859be62d624ecd9ee8c80704d282c8">m_kind</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">  769</a></span>&#160;  <a class="code" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> <a class="code" href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">m_melt_mass</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;};</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;} <span class="comment">// end of namespace diagnostics</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment">/*! @brief The number of points for temperature and precipitation time-series.</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00776"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_abaac6021d4d9cc470b2d919420ce2555.html#abaac6021d4d9cc470b2d919420ce2555">  776</a></span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_abaac6021d4d9cc470b2d919420ce2555.html#abaac6021d4d9cc470b2d919420ce2555">DEBMSimple::timeseries_length</a>(<span class="keywordtype">double</span> dt)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">double</span> dt_years = dt / <a class="code" href="classpism_1_1surface_1_1DEBMSimple_abccbac7f63843606ae008292e590c36e.html#abccbac7f63843606ae008292e590c36e">m_year_length</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacepism_1_1array_a8957d08741c6f48d1e554ac7ea98530a.html#a8957d08741c6f48d1e554ac7ea98530a">std::max</a>(1U, <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(ceil(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a97b5ec0fd1fa2ff74fa3728775b13e13.html#a97b5ec0fd1fa2ff74fa3728775b13e13">m_n_per_year</a> * dt_years)));</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;}</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno"><a class="line" href="classpism_1_1surface_1_1DEBMSimple_ac44b2794fcbba34adc3c75b1983f9456.html#ac44b2794fcbba34adc3c75b1983f9456">  782</a></span>&#160;<a class="code" href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">DiagnosticList</a> <a class="code" href="classpism_1_1surface_1_1DEBMSimple_ac44b2794fcbba34adc3c75b1983f9456.html#ac44b2794fcbba34adc3c75b1983f9456">DEBMSimple::diagnostics_impl</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="classpism_1_1Component_ac0ff4daf2dc8b23ea64b1d635666bdf0.html#ac0ff4daf2dc8b23ea64b1d635666bdf0">diagnostics</a>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">DiagnosticList</a> result = {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    { <span class="stringliteral">&quot;debm_insolation_driven_melt_flux&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSInsolationMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a>)) },</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    { <span class="stringliteral">&quot;debm_insolation_driven_melt_rate&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSInsolationMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>)) },</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    { <span class="stringliteral">&quot;debm_temperature_driven_melt_flux&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSTemperatureMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a>)) },</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    { <span class="stringliteral">&quot;debm_temperature_driven_melt_rate&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSTemperatureMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>)) },</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    { <span class="stringliteral">&quot;debm_offset_melt_flux&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSBackroundMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">AMOUNT</a>)) },</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    { <span class="stringliteral">&quot;debm_offset_melt_rate&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSBackroundMelt(<span class="keyword">this</span>, <a class="code" href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">MASS</a>)) },</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    { <span class="stringliteral">&quot;air_temp_sd&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(*<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">m_air_temp_sd</a>) },</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    { <span class="stringliteral">&quot;snow_depth&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">m_snow_depth</a>) },</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    { <span class="stringliteral">&quot;surface_albedo&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">m_surface_albedo</a>) },</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    { <span class="stringliteral">&quot;atmosphere_transmissivity&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">Diagnostic::wrap</a>(<a class="code" href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">m_transmissivity</a>) },</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    { <span class="stringliteral">&quot;insolation&quot;</span>, <a class="code" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a>(<span class="keyword">new</span> DEBMSInsolation(<span class="keyword">this</span>)) }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  };</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  result = <a class="code" href="namespacepism_ab50523fe25aadf4a123551726b2a2967.html#ab50523fe25aadf4a123551726b2a2967">pism::combine</a>(result, <a class="code" href="classpism_1_1surface_1_1SurfaceModel_a24c2488f992cf6f937cd08b87c5c89c8.html#a24c2488f992cf6f937cd08b87c5c89c8">SurfaceModel::diagnostics_impl</a>());</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;} <span class="comment">// end of namespace surface</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;} <span class="comment">// end of namespace pism</span></div>
<div class="ttc" id="aclasspism_1_1Component_a08f6b5a8e759c471d1a003804a8160ad_html_a08f6b5a8e759c471d1a003804a8160ad"><div class="ttname"><a href="classpism_1_1Component_a08f6b5a8e759c471d1a003804a8160ad.html#a08f6b5a8e759c471d1a003804a8160ad">pism::Component::m_sys</a></div><div class="ttdeci">const units::System::Ptr m_sys</div><div class="ttdoc">unit system used by this component</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00160">Component.hh:160</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2_html_a0c8b6cce615bda88f2b24171230af6a2"><div class="ttname"><a href="classpism_1_1Component_a0c8b6cce615bda88f2b24171230af6a2.html#a0c8b6cce615bda88f2b24171230af6a2">pism::Component::time</a></div><div class="ttdeci">const Time &amp; time() const</div><div class="ttdef"><b>Definition:</b> <a href="Component_8cc_source.html#l00109">Component.cc:109</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84_html_a28f298fc2133baae8cebf9dedf3b4d84"><div class="ttname"><a href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">pism::Component::m_config</a></div><div class="ttdeci">const Config::ConstPtr m_config</div><div class="ttdoc">configuration database used by this component</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00158">Component.hh:158</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a29575eba605feccf4403d6b4ff0954a4_html_a29575eba605feccf4403d6b4ff0954a4"><div class="ttname"><a href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">pism::Component::m_log</a></div><div class="ttdeci">const Logger::ConstPtr m_log</div><div class="ttdoc">logger (for easy access)</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00162">Component.hh:162</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811_html_a745aa37bc1b5da6db5bfc280ecb3c811"><div class="ttname"><a href="classpism_1_1Component_a745aa37bc1b5da6db5bfc280ecb3c811.html#a745aa37bc1b5da6db5bfc280ecb3c811">pism::Component::m_grid</a></div><div class="ttdeci">const std::shared_ptr&lt; const Grid &gt; m_grid</div><div class="ttdoc">grid used by this component</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00156">Component.hh:156</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_a7737874c03a58a03498a33dc464d2ee9_html_a7737874c03a58a03498a33dc464d2ee9"><div class="ttname"><a href="classpism_1_1Component_a7737874c03a58a03498a33dc464d2ee9.html#a7737874c03a58a03498a33dc464d2ee9">pism::Component::regrid</a></div><div class="ttdeci">void regrid(const std::string &amp;module_name, array::Array &amp;variable, RegriddingFlag flag=NO_REGRID_WITHOUT_REGRID_VARS)</div><div class="ttdef"><b>Definition:</b> <a href="Component_8cc_source.html#l00159">Component.cc:159</a></div></div>
<div class="ttc" id="aclasspism_1_1Component_ac0ff4daf2dc8b23ea64b1d635666bdf0_html_ac0ff4daf2dc8b23ea64b1d635666bdf0"><div class="ttname"><a href="classpism_1_1Component_ac0ff4daf2dc8b23ea64b1d635666bdf0.html#ac0ff4daf2dc8b23ea64b1d635666bdf0">pism::Component::diagnostics</a></div><div class="ttdeci">DiagnosticList diagnostics() const</div><div class="ttdef"><b>Definition:</b> <a href="Component_8cc_source.html#l00089">Component.cc:89</a></div></div>
<div class="ttc" id="aclasspism_1_1DiagAverageRate_a252d2c1d0942cf6f75fd5c85255aae93_html_a252d2c1d0942cf6f75fd5c85255aae93"><div class="ttname"><a href="classpism_1_1DiagAverageRate_a252d2c1d0942cf6f75fd5c85255aae93.html#a252d2c1d0942cf6f75fd5c85255aae93">pism::DiagAverageRate&lt; DEBMSimple &gt;::m_accumulator</a></div><div class="ttdeci">array::Scalar m_accumulator</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00266">Diagnostic.hh:266</a></div></div>
<div class="ttc" id="aclasspism_1_1DiagAverageRate_a44a50685701b5dcd19e71e4f2cc1e46f_html_a44a50685701b5dcd19e71e4f2cc1e46fa5ff14e4c51b9dfcb0540c0ce28d67cdd"><div class="ttname"><a href="classpism_1_1DiagAverageRate_a44a50685701b5dcd19e71e4f2cc1e46f.html#a44a50685701b5dcd19e71e4f2cc1e46fa5ff14e4c51b9dfcb0540c0ce28d67cdd">pism::DiagAverageRate&lt; DEBMSimple &gt;::TOTAL_CHANGE</a></div><div class="ttdeci">@ TOTAL_CHANGE</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00182">Diagnostic.hh:182</a></div></div>
<div class="ttc" id="aclasspism_1_1DiagAverageRate_html"><div class="ttname"><a href="classpism_1_1DiagAverageRate.html">pism::DiagAverageRate</a></div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00180">Diagnostic.hh:180</a></div></div>
<div class="ttc" id="aclasspism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711_html_aa3e0516ca815c840bfa479256aa1f711"><div class="ttname"><a href="classpism_1_1Diag_aa3e0516ca815c840bfa479256aa1f711.html#aa3e0516ca815c840bfa479256aa1f711">pism::Diag&lt; DEBMSimple &gt;::model</a></div><div class="ttdeci">const DEBMSimple * model</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00172">Diagnostic.hh:172</a></div></div>
<div class="ttc" id="aclasspism_1_1Diag_html"><div class="ttname"><a href="classpism_1_1Diag.html">pism::Diag</a></div><div class="ttdoc">A template derived from Diagnostic, adding a &quot;Model&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00166">Diagnostic.hh:166</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9_html_a2648c1bc92c5e333ecad30e9a5687ea9"><div class="ttname"><a href="classpism_1_1Diagnostic_a2648c1bc92c5e333ecad30e9a5687ea9.html#a2648c1bc92c5e333ecad30e9a5687ea9">pism::Diagnostic::wrap</a></div><div class="ttdeci">static Ptr wrap(const T &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00160">Diagnostic.hh:160</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a4d9fd84fa2feaaf986df8ecbe6832506_html_a4d9fd84fa2feaaf986df8ecbe6832506"><div class="ttname"><a href="classpism_1_1Diagnostic_a4d9fd84fa2feaaf986df8ecbe6832506.html#a4d9fd84fa2feaaf986df8ecbe6832506">pism::Diagnostic::m_fill_value</a></div><div class="ttdeci">double m_fill_value</div><div class="ttdoc">fill value (used often enough to justify storing it)</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00122">Diagnostic.hh:122</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d_html_a66c35ec2a3236c20757ba9ce5880eb6d"><div class="ttname"><a href="classpism_1_1Diagnostic_a66c35ec2a3236c20757ba9ce5880eb6d.html#a66c35ec2a3236c20757ba9ce5880eb6d">pism::Diagnostic::m_sys</a></div><div class="ttdeci">const units::System::Ptr m_sys</div><div class="ttdoc">the unit system</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00116">Diagnostic.hh:116</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a71431ab62fe704b0a9317140f3ab3bd3_html_a71431ab62fe704b0a9317140f3ab3bd3"><div class="ttname"><a href="classpism_1_1Diagnostic_a71431ab62fe704b0a9317140f3ab3bd3.html#a71431ab62fe704b0a9317140f3ab3bd3">pism::Diagnostic::to_internal</a></div><div class="ttdeci">double to_internal(double x) const</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8cc_source.html#l00059">Diagnostic.cc:59</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0_html_a7590d3d6d714ca1bbc99787baea537e0"><div class="ttname"><a href="classpism_1_1Diagnostic_a7590d3d6d714ca1bbc99787baea537e0.html#a7590d3d6d714ca1bbc99787baea537e0">pism::Diagnostic::m_vars</a></div><div class="ttdeci">std::vector&lt; SpatialVariableMetadata &gt; m_vars</div><div class="ttdoc">metadata corresponding to NetCDF variables</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00120">Diagnostic.hh:120</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455_html_a94d5717226f2c89299c0c08168f01455"><div class="ttname"><a href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">pism::Diagnostic::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; Diagnostic &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00065">Diagnostic.hh:65</a></div></div>
<div class="ttc" id="aclasspism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca_html_af0eaf7c1c949d96b5c5ac945c7b744ca"><div class="ttname"><a href="classpism_1_1Diagnostic_af0eaf7c1c949d96b5c5ac945c7b744ca.html#af0eaf7c1c949d96b5c5ac945c7b744ca">pism::Diagnostic::m_grid</a></div><div class="ttdeci">std::shared_ptr&lt; const Grid &gt; m_grid</div><div class="ttdoc">the grid</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00114">Diagnostic.hh:114</a></div></div>
<div class="ttc" id="aclasspism_1_1File_html"><div class="ttname"><a href="classpism_1_1File.html">pism::File</a></div><div class="ttdoc">High-level PISM I/O class.</div><div class="ttdef"><b>Definition:</b> <a href="File_8hh_source.html#l00055">File.hh:56</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_a44a91d340da6ec7376c89e4eeca876a1_html_a44a91d340da6ec7376c89e4eeca876a1"><div class="ttname"><a href="classpism_1_1Geometry_a44a91d340da6ec7376c89e4eeca876a1.html#a44a91d340da6ec7376c89e4eeca876a1">pism::Geometry::ice_surface_elevation</a></div><div class="ttdeci">array::Scalar2 ice_surface_elevation</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00057">Geometry.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_a91ce5150ea7a1abe306fb59a63658217_html_a91ce5150ea7a1abe306fb59a63658217"><div class="ttname"><a href="classpism_1_1Geometry_a91ce5150ea7a1abe306fb59a63658217.html#a91ce5150ea7a1abe306fb59a63658217">pism::Geometry::cell_type</a></div><div class="ttdeci">array::CellType2 cell_type</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00055">Geometry.hh:55</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_a9f744ea4843a08036f6132922dc4dc2c_html_a9f744ea4843a08036f6132922dc4dc2c"><div class="ttname"><a href="classpism_1_1Geometry_a9f744ea4843a08036f6132922dc4dc2c.html#a9f744ea4843a08036f6132922dc4dc2c">pism::Geometry::ice_thickness</a></div><div class="ttdeci">array::Scalar2 ice_thickness</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00051">Geometry.hh:51</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_af342fcf68ac37ec2744e97dfce20dfd4_html_af342fcf68ac37ec2744e97dfce20dfd4"><div class="ttname"><a href="classpism_1_1Geometry_af342fcf68ac37ec2744e97dfce20dfd4.html#af342fcf68ac37ec2744e97dfce20dfd4">pism::Geometry::latitude</a></div><div class="ttdeci">array::Scalar latitude</div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00041">Geometry.hh:41</a></div></div>
<div class="ttc" id="aclasspism_1_1Geometry_html"><div class="ttname"><a href="classpism_1_1Geometry.html">pism::Geometry</a></div><div class="ttdef"><b>Definition:</b> <a href="Geometry_8hh_source.html#l00029">Geometry.hh:29</a></div></div>
<div class="ttc" id="aclasspism_1_1MaxTimestep_html"><div class="ttname"><a href="classpism_1_1MaxTimestep.html">pism::MaxTimestep</a></div><div class="ttdoc">Combines the max. time step with the flag indicating if a restriction is active. Makes is possible to...</div><div class="ttdef"><b>Definition:</b> <a href="MaxTimestep_8hh_source.html#l00031">MaxTimestep.hh:31</a></div></div>
<div class="ttc" id="aclasspism_1_1ParallelSection_a6b0a6e5e64970af7eadabfebe2b20bd2_html_a6b0a6e5e64970af7eadabfebe2b20bd2"><div class="ttname"><a href="classpism_1_1ParallelSection_a6b0a6e5e64970af7eadabfebe2b20bd2.html#a6b0a6e5e64970af7eadabfebe2b20bd2">pism::ParallelSection::failed</a></div><div class="ttdeci">void failed()</div><div class="ttdoc">Indicates a failure of a parallel section.</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8cc_source.html#l00185">error_handling.cc:185</a></div></div>
<div class="ttc" id="aclasspism_1_1ParallelSection_ac23296abee1cbcb3c3fd68c7f5ce0835_html_ac23296abee1cbcb3c3fd68c7f5ce0835"><div class="ttname"><a href="classpism_1_1ParallelSection_ac23296abee1cbcb3c3fd68c7f5ce0835.html#ac23296abee1cbcb3c3fd68c7f5ce0835">pism::ParallelSection::check</a></div><div class="ttdeci">void check()</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8cc_source.html#l00201">error_handling.cc:201</a></div></div>
<div class="ttc" id="aclasspism_1_1ParallelSection_html"><div class="ttname"><a href="classpism_1_1ParallelSection.html">pism::ParallelSection</a></div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8hh_source.html#l00069">error_handling.hh:69</a></div></div>
<div class="ttc" id="aclasspism_1_1RuntimeError_ad0ed5f05a9a4e3e403a1d62f8d1e4e7d_html_ad0ed5f05a9a4e3e403a1d62f8d1e4e7d"><div class="ttname"><a href="classpism_1_1RuntimeError_ad0ed5f05a9a4e3e403a1d62f8d1e4e7d.html#ad0ed5f05a9a4e3e403a1d62f8d1e4e7d">pism::RuntimeError::formatted</a></div><div class="ttdeci">static RuntimeError formatted(const ErrorLocation &amp;location, const char format[],...) __attribute__((format(printf</div><div class="ttdoc">build a RuntimeError with a formatted message</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8cc_source.html#l00047">error_handling.cc:47</a></div></div>
<div class="ttc" id="aclasspism_1_1Time_a007c6d7280a8a4f1b25e6a2b3f4a4779_html_a007c6d7280a8a4f1b25e6a2b3f4a4779"><div class="ttname"><a href="classpism_1_1Time_a007c6d7280a8a4f1b25e6a2b3f4a4779.html#a007c6d7280a8a4f1b25e6a2b3f4a4779">pism::Time::increment_date</a></div><div class="ttdeci">double increment_date(double T, double years) const</div><div class="ttdef"><b>Definition:</b> <a href="Time_8cc_source.html#l00852">Time.cc:852</a></div></div>
<div class="ttc" id="aclasspism_1_1Time_a54e8efeb9a3cd257cc956f21f9838b71_html_a54e8efeb9a3cd257cc956f21f9838b71"><div class="ttname"><a href="classpism_1_1Time_a54e8efeb9a3cd257cc956f21f9838b71.html#a54e8efeb9a3cd257cc956f21f9838b71">pism::Time::calendar_year_start</a></div><div class="ttdeci">double calendar_year_start(double T) const</div><div class="ttdoc">Returns the model time in seconds corresponding to the beginning of the year T falls into.</div><div class="ttdef"><b>Definition:</b> <a href="Time_8cc_source.html#l00843">Time.cc:843</a></div></div>
<div class="ttc" id="aclasspism_1_1VariableMetadata_a2b7791d4794fd3deb3838e75b495ce33_html_a2b7791d4794fd3deb3838e75b495ce33"><div class="ttname"><a href="classpism_1_1VariableMetadata_a2b7791d4794fd3deb3838e75b495ce33.html#a2b7791d4794fd3deb3838e75b495ce33">pism::VariableMetadata::standard_name</a></div><div class="ttdeci">VariableMetadata &amp; standard_name(const std::string &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="VariableMetadata_8hh_source.html#l00119">VariableMetadata.hh:119</a></div></div>
<div class="ttc" id="aclasspism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d_html_a5e378cf7077ab00a808ef446a79dc34d"><div class="ttname"><a href="classpism_1_1VariableMetadata_a5e378cf7077ab00a808ef446a79dc34d.html#a5e378cf7077ab00a808ef446a79dc34d">pism::VariableMetadata::long_name</a></div><div class="ttdeci">VariableMetadata &amp; long_name(const std::string &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="VariableMetadata_8hh_source.html#l00115">VariableMetadata.hh:115</a></div></div>
<div class="ttc" id="aclasspism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4_html_ae73185be0693a8607b8e0f74558e11e4"><div class="ttname"><a href="classpism_1_1VariableMetadata_ae73185be0693a8607b8e0f74558e11e4.html#ae73185be0693a8607b8e0f74558e11e4">pism::VariableMetadata::units</a></div><div class="ttdeci">VariableMetadata &amp; units(const std::string &amp;input)</div><div class="ttdef"><b>Definition:</b> <a href="VariableMetadata_8hh_source.html#l00123">VariableMetadata.hh:123</a></div></div>
<div class="ttc" id="aclasspism_1_1VariableMetadata_aeaac3d7581fd57bca5088f50c4c462dc_html_aeaac3d7581fd57bca5088f50c4c462dc"><div class="ttname"><a href="classpism_1_1VariableMetadata_aeaac3d7581fd57bca5088f50c4c462dc.html#aeaac3d7581fd57bca5088f50c4c462dc">pism::VariableMetadata::set_string</a></div><div class="ttdeci">VariableMetadata &amp; set_string(const std::string &amp;name, const std::string &amp;value)</div><div class="ttdoc">Set a string attribute.</div><div class="ttdef"><b>Definition:</b> <a href="VariableMetadata_8cc_source.html#l00314">VariableMetadata.cc:314</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1AccessScope_html"><div class="ttname"><a href="classpism_1_1array_1_1AccessScope.html">pism::array::AccessScope</a></div><div class="ttdoc">Makes sure that we call begin_access() and end_access() for all accessed array::Arrays.</div><div class="ttdef"><b>Definition:</b> <a href="Array_8hh_source.html#l00065">Array.hh:65</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array2D_a7b9a0d8a83d5379f1debdcefce0fffae_html_a7b9a0d8a83d5379f1debdcefce0fffae"><div class="ttname"><a href="classpism_1_1array_1_1Array2D_a7b9a0d8a83d5379f1debdcefce0fffae.html#a7b9a0d8a83d5379f1debdcefce0fffae">pism::array::Array2D::copy_from</a></div><div class="ttdeci">void copy_from(const Array2D&lt; T &gt; &amp;source)</div><div class="ttdef"><b>Definition:</b> <a href="Array2D_8hh_source.html#l00073">Array2D.hh:73</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_a0326efd779d857755513901da9a54992_html_a0326efd779d857755513901da9a54992"><div class="ttname"><a href="classpism_1_1array_1_1Array_a0326efd779d857755513901da9a54992.html#a0326efd779d857755513901da9a54992">pism::array::Array::read</a></div><div class="ttdeci">void read(const std::string &amp;filename, unsigned int time)</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00809">Array.cc:809</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_a3e1a5859cef073a95e5e0cc5f1cc0fdb_html_a3e1a5859cef073a95e5e0cc5f1cc0fdb"><div class="ttname"><a href="classpism_1_1array_1_1Array_a3e1a5859cef073a95e5e0cc5f1cc0fdb.html#a3e1a5859cef073a95e5e0cc5f1cc0fdb">pism::array::Array::define</a></div><div class="ttdeci">void define(const File &amp;file, io::Type default_type) const</div><div class="ttdoc">Define variables corresponding to an Array in a file opened using file.</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00540">Array.cc:540</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_a4cdaeb827d166a076668d2ab86416793_html_a4cdaeb827d166a076668d2ab86416793"><div class="ttname"><a href="classpism_1_1array_1_1Array_a4cdaeb827d166a076668d2ab86416793.html#a4cdaeb827d166a076668d2ab86416793">pism::array::Array::write</a></div><div class="ttdeci">void write(const std::string &amp;filename) const</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00800">Array.cc:800</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_a7b700739a7f5845c95fa33375a497901_html_a7b700739a7f5845c95fa33375a497901"><div class="ttname"><a href="classpism_1_1array_1_1Array_a7b700739a7f5845c95fa33375a497901.html#a7b700739a7f5845c95fa33375a497901">pism::array::Array::scale</a></div><div class="ttdeci">void scale(double alpha)</div><div class="ttdoc">Result: v &lt;- v * alpha. Calls VecScale.</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00253">Array.cc:253</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1_html_a9959fcf0124f084e6a2835ed745ce0d1"><div class="ttname"><a href="classpism_1_1array_1_1Array_a9959fcf0124f084e6a2835ed745ce0d1.html#a9959fcf0124f084e6a2835ed745ce0d1">pism::array::Array::set</a></div><div class="ttdeci">void set(double c)</div><div class="ttdoc">Result: v[j] &lt;- c for all j.</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00707">Array.cc:707</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_aa7de6be7e8f785321df81d9fd6518a16_html_aa7de6be7e8f785321df81d9fd6518a16"><div class="ttname"><a href="classpism_1_1array_1_1Array_aa7de6be7e8f785321df81d9fd6518a16.html#aa7de6be7e8f785321df81d9fd6518a16">pism::array::Array::regrid</a></div><div class="ttdeci">void regrid(const std::string &amp;filename, io::Default default_value)</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00814">Array.cc:814</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4_html_af9eece42153cd03bfc8ba237ae5310c4"><div class="ttname"><a href="classpism_1_1array_1_1Array_af9eece42153cd03bfc8ba237ae5310c4.html#af9eece42153cd03bfc8ba237ae5310c4">pism::array::Array::metadata</a></div><div class="ttdeci">SpatialVariableMetadata &amp; metadata(unsigned int N=0)</div><div class="ttdoc">Returns a reference to the SpatialVariableMetadata object containing metadata for the compoment N.</div><div class="ttdef"><b>Definition:</b> <a href="Array_8cc_source.html#l00553">Array.cc:553</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Forcing_a8569ad95d618a3b1b4c8b2b19c0c78f5_html_a8569ad95d618a3b1b4c8b2b19c0c78f5"><div class="ttname"><a href="classpism_1_1array_1_1Forcing_a8569ad95d618a3b1b4c8b2b19c0c78f5.html#a8569ad95d618a3b1b4c8b2b19c0c78f5">pism::array::Forcing::Constant</a></div><div class="ttdeci">static std::shared_ptr&lt; Forcing &gt; Constant(std::shared_ptr&lt; const Grid &gt; grid, const std::string &amp;short_name, double value)</div><div class="ttdef"><b>Definition:</b> <a href="Forcing_8cc_source.html#l00147">Forcing.cc:147</a></div></div>
<div class="ttc" id="aclasspism_1_1array_1_1Scalar_html"><div class="ttname"><a href="classpism_1_1array_1_1Scalar.html">pism::array::Scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="Scalar_8hh_source.html#l00031">Scalar.hh:31</a></div></div>
<div class="ttc" id="aclasspism_1_1io_1_1Default_html"><div class="ttname"><a href="classpism_1_1io_1_1Default.html">pism::io::Default</a></div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00091">IO_Flags.hh:91</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimpleMelt_html"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimpleMelt.html">pism::surface::DEBMSimpleMelt</a></div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8hh_source.html#l00035">DEBMSimplePointwise.hh:35</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_a04383e7f9545a4ca9cc3381e6853894e_html_a04383e7f9545a4ca9cc3381e6853894e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise_a04383e7f9545a4ca9cc3381e6853894e.html#a04383e7f9545a4ca9cc3381e6853894e">pism::surface::DEBMSimplePointwise::albedo</a></div><div class="ttdeci">double albedo(double melt_rate, MaskValue cell_type) const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8cc_source.html#l00355">DEBMSimplePointwise.cc:355</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_a41be9bb9f422a0a79f9840ccb50776b5_html_a41be9bb9f422a0a79f9840ccb50776b5"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise_a41be9bb9f422a0a79f9840ccb50776b5.html#a41be9bb9f422a0a79f9840ccb50776b5">pism::surface::DEBMSimplePointwise::melt</a></div><div class="ttdeci">DEBMSimpleMelt melt(double declination, double distance_factor, double dt, double T_std_deviation, double T, double surface_elevation, double lat, double albedo) const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8cc_source.html#l00439">DEBMSimplePointwise.cc:439</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_a70f44bd227dc10918271229783f25cf8_html_a70f44bd227dc10918271229783f25cf8"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise_a70f44bd227dc10918271229783f25cf8.html#a70f44bd227dc10918271229783f25cf8">pism::surface::DEBMSimplePointwise::step</a></div><div class="ttdeci">Changes step(double ice_thickness, double max_melt, double snow_depth, double accumulation) const</div><div class="ttdoc">Compute the surface mass balance at a location from the amount of melted snow and the solid accumulat...</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8cc_source.html#l00495">DEBMSimplePointwise.cc:495</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_aa0e393841035837406a6c4d502019911_html_aa0e393841035837406a6c4d502019911"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise_aa0e393841035837406a6c4d502019911.html#aa0e393841035837406a6c4d502019911">pism::surface::DEBMSimplePointwise::atmosphere_transmissivity</a></div><div class="ttdeci">double atmosphere_transmissivity(double elevation) const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8cc_source.html#l00372">DEBMSimplePointwise.cc:372</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_ae8f5994419e9be643da013816c95b031_html_ae8f5994419e9be643da013816c95b031"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise_ae8f5994419e9be643da013816c95b031.html#ae8f5994419e9be643da013816c95b031">pism::surface::DEBMSimplePointwise::orbital_parameters</a></div><div class="ttdeci">OrbitalParameters orbital_parameters(double time) const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8cc_source.html#l00376">DEBMSimplePointwise.cc:376</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimplePointwise_html"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimplePointwise.html">pism::surface::DEBMSimplePointwise</a></div><div class="ttdoc">A dEBM-simple implementation.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimplePointwise_8hh_source.html#l00053">DEBMSimplePointwise.hh:53</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e_html_a058145a7ca42d55cd0203912561bc22e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a058145a7ca42d55cd0203912561bc22e.html#a058145a7ca42d55cd0203912561bc22e">pism::surface::DEBMSimple::m_insolation_driven_melt</a></div><div class="ttdeci">array::Scalar m_insolation_driven_melt</div><div class="ttdoc">total insolation melt during the last time step</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00110">DEBMSimple.hh:110</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a09bd225d72497d0095f4b247a7f3aacd_html_a09bd225d72497d0095f4b247a7f3aacd"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a09bd225d72497d0095f4b247a7f3aacd.html#a09bd225d72497d0095f4b247a7f3aacd">pism::surface::DEBMSimple::atmosphere_transmissivity</a></div><div class="ttdeci">const array::Scalar &amp; atmosphere_transmissivity() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00545">DEBMSimple.cc:545</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a11ec32364216b41edb286ced399fec8c_html_a11ec32364216b41edb286ced399fec8c"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a11ec32364216b41edb286ced399fec8c.html#a11ec32364216b41edb286ced399fec8c">pism::surface::DEBMSimple::mass_flux_impl</a></div><div class="ttdeci">virtual const array::Scalar &amp; mass_flux_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00501">DEBMSimple.cc:501</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372_html_a124282cae2fa7860ff30dd3d9961b372"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a124282cae2fa7860ff30dd3d9961b372.html#a124282cae2fa7860ff30dd3d9961b372">pism::surface::DEBMSimple::m_melt</a></div><div class="ttdeci">std::shared_ptr&lt; array::Scalar &gt; m_melt</div><div class="ttdoc">total melt during the last time step</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00101">DEBMSimple.hh:101</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a1419addaa79ec947e4308523d8b4ab96_html_a1419addaa79ec947e4308523d8b4ab96"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a1419addaa79ec947e4308523d8b4ab96.html#a1419addaa79ec947e4308523d8b4ab96">pism::surface::DEBMSimple::update_impl</a></div><div class="ttdeci">virtual void update_impl(const Geometry &amp;geometry, double t, double dt)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00266">DEBMSimple.cc:266</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a14e08e478b7186530b58a59cadb6538b_html_a14e08e478b7186530b58a59cadb6538b"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a14e08e478b7186530b58a59cadb6538b.html#a14e08e478b7186530b58a59cadb6538b">pism::surface::DEBMSimple::snow_accumulation</a></div><div class="ttdeci">double snow_accumulation(double T, double P) const</div><div class="ttdoc">Extracts snow accumulation from mixed (snow and rain) precipitation using a temperature threshold wit...</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00245">DEBMSimple.cc:245</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a1711a0a3d0f16820080d4e3120cdc039_html_a1711a0a3d0f16820080d4e3120cdc039"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a1711a0a3d0f16820080d4e3120cdc039.html#a1711a0a3d0f16820080d4e3120cdc039">pism::surface::DEBMSimple::insolation_driven_melt</a></div><div class="ttdeci">const array::Scalar &amp; insolation_driven_melt() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00529">DEBMSimple.cc:529</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a1e02dff535c529c04bb793ac46f4b9df_html_a1e02dff535c529c04bb793ac46f4b9df"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a1e02dff535c529c04bb793ac46f4b9df.html#a1e02dff535c529c04bb793ac46f4b9df">pism::surface::DEBMSimple::surface_albedo</a></div><div class="ttdeci">const array::Scalar &amp; surface_albedo() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00541">DEBMSimple.cc:541</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a_html_a2544a89db71cd3e83d39f71bbc88198a"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a2544a89db71cd3e83d39f71bbc88198a.html#a2544a89db71cd3e83d39f71bbc88198a">pism::surface::DEBMSimple::m_surface_albedo</a></div><div class="ttdeci">array::Scalar m_surface_albedo</div><div class="ttdoc">albedo field</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00116">DEBMSimple.hh:116</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125_html_a31c13bc2bade6633ac26077492a91125"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a31c13bc2bade6633ac26077492a91125.html#a31c13bc2bade6633ac26077492a91125">pism::surface::DEBMSimple::m_mass_flux</a></div><div class="ttdeci">array::Scalar m_mass_flux</div><div class="ttdoc">cached surface mass balance rate</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00087">DEBMSimple.hh:87</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d_html_a3db3545b6f624c292380c015e3553e1d"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a3db3545b6f624c292380c015e3553e1d.html#a3db3545b6f624c292380c015e3553e1d">pism::surface::DEBMSimple::m_runoff</a></div><div class="ttdeci">std::shared_ptr&lt; array::Scalar &gt; m_runoff</div><div class="ttdoc">total runoff during the last time step</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00104">DEBMSimple.hh:104</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c_html_a4e0d4618d3fdaf9421e1425ca9116e1c"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a4e0d4618d3fdaf9421e1425ca9116e1c.html#a4e0d4618d3fdaf9421e1425ca9116e1c">pism::surface::DEBMSimple::m_temperature_driven_melt</a></div><div class="ttdeci">array::Scalar m_temperature_driven_melt</div><div class="ttdoc">total temperature melt during the last time step</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00107">DEBMSimple.hh:107</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c_html_a50f0a7f60e6314f23a1d03839a46181c"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a50f0a7f60e6314f23a1d03839a46181c.html#a50f0a7f60e6314f23a1d03839a46181c">pism::surface::DEBMSimple::air_temp_sd</a></div><div class="ttdeci">const array::Scalar &amp; air_temp_sd() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00525">DEBMSimple.cc:525</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8_html_a5f9f9e8fc1228abbfb6cf6b7667e9ac8"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a5f9f9e8fc1228abbfb6cf6b7667e9ac8.html#a5f9f9e8fc1228abbfb6cf6b7667e9ac8">pism::surface::DEBMSimple::m_snow_depth</a></div><div class="ttdeci">array::Scalar m_snow_depth</div><div class="ttdoc">snow depth (reset once a year)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00092">DEBMSimple.hh:92</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a6d8329beb1d21ba11d0cc91c09ed214a_html_a6d8329beb1d21ba11d0cc91c09ed214a"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a6d8329beb1d21ba11d0cc91c09ed214a.html#a6d8329beb1d21ba11d0cc91c09ed214a">pism::surface::DEBMSimple::define_model_state_impl</a></div><div class="ttdeci">virtual void define_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00549">DEBMSimple.cc:549</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110_html_a77f9d071c92784482a96f4a88e27e110"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a77f9d071c92784482a96f4a88e27e110.html#a77f9d071c92784482a96f4a88e27e110">pism::surface::DEBMSimple::m_air_temp_sd</a></div><div class="ttdeci">std::shared_ptr&lt; array::Forcing &gt; m_air_temp_sd</div><div class="ttdoc">standard deviation of the daily variability of the air temperature</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00095">DEBMSimple.hh:95</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a7d5b2bdfe9f126176f04adc64b5ad775_html_a7d5b2bdfe9f126176f04adc64b5ad775"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a7d5b2bdfe9f126176f04adc64b5ad775.html#a7d5b2bdfe9f126176f04adc64b5ad775">pism::surface::DEBMSimple::write_model_state_impl</a></div><div class="ttdeci">virtual void write_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00555">DEBMSimple.cc:555</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a81972ae984bf43b49c3a5ca3eeea9d8e_html_a81972ae984bf43b49c3a5ca3eeea9d8e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a81972ae984bf43b49c3a5ca3eeea9d8e.html#a81972ae984bf43b49c3a5ca3eeea9d8e">pism::surface::DEBMSimple::m_sd_param_a</a></div><div class="ttdeci">double m_sd_param_a</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00132">DEBMSimple.hh:132</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e_html_a83d6c633a17051a887fc73d9368f839e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a83d6c633a17051a887fc73d9368f839e.html#a83d6c633a17051a887fc73d9368f839e">pism::surface::DEBMSimple::m_Tmax</a></div><div class="ttdeci">double m_Tmax</div><div class="ttdoc">the temperature above which all precipitation is rain</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00140">DEBMSimple.hh:140</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a87037317421e95ed9ce28e8306f86765_html_a87037317421e95ed9ce28e8306f86765"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a87037317421e95ed9ce28e8306f86765.html#a87037317421e95ed9ce28e8306f86765">pism::surface::DEBMSimple::m_next_balance_year_start</a></div><div class="ttdeci">double m_next_balance_year_start</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00084">DEBMSimple.hh:84</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a969fb707aa3eb99c3efe8b3c4cab6f4d_html_a969fb707aa3eb99c3efe8b3c4cab6f4d"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a969fb707aa3eb99c3efe8b3c4cab6f4d.html#a969fb707aa3eb99c3efe8b3c4cab6f4d">pism::surface::DEBMSimple::runoff_impl</a></div><div class="ttdeci">const array::Scalar &amp; runoff_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00517">DEBMSimple.cc:517</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a97b5ec0fd1fa2ff74fa3728775b13e13_html_a97b5ec0fd1fa2ff74fa3728775b13e13"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a97b5ec0fd1fa2ff74fa3728775b13e13.html#a97b5ec0fd1fa2ff74fa3728775b13e13">pism::surface::DEBMSimple::m_n_per_year</a></div><div class="ttdeci">unsigned int m_n_per_year</div><div class="ttdoc">number of small time steps per year</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00129">DEBMSimple.hh:129</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a9832b447bf3dfb1c68ab42680ab68f2e_html_a9832b447bf3dfb1c68ab42680ab68f2e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a9832b447bf3dfb1c68ab42680ab68f2e.html#a9832b447bf3dfb1c68ab42680ab68f2e">pism::surface::DEBMSimple::m_sd_use_param</a></div><div class="ttdeci">bool m_sd_use_param</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00131">DEBMSimple.hh:131</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836_html_a9ad5af18f1ee71033aab0f58bb642836"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_a9ad5af18f1ee71033aab0f58bb642836.html#a9ad5af18f1ee71033aab0f58bb642836">pism::surface::DEBMSimple::m_transmissivity</a></div><div class="ttdeci">array::Scalar m_transmissivity</div><div class="ttdoc">transmissivity field</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00122">DEBMSimple.hh:122</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15_html_aa90c317d376b9956055251d59be97a15"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_aa90c317d376b9956055251d59be97a15.html#aa90c317d376b9956055251d59be97a15">pism::surface::DEBMSimple::compute_next_balance_year_start</a></div><div class="ttdeci">double compute_next_balance_year_start(double time)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00218">DEBMSimple.cc:218</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94_html_ab47b1e4dde2bd7d425d249099c7e1e94"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ab47b1e4dde2bd7d425d249099c7e1e94.html#ab47b1e4dde2bd7d425d249099c7e1e94">pism::surface::DEBMSimple::m_accumulation</a></div><div class="ttdeci">std::shared_ptr&lt; array::Scalar &gt; m_accumulation</div><div class="ttdoc">total accumulation during the last time step</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00098">DEBMSimple.hh:98</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_abaac6021d4d9cc470b2d919420ce2555_html_abaac6021d4d9cc470b2d919420ce2555"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_abaac6021d4d9cc470b2d919420ce2555.html#abaac6021d4d9cc470b2d919420ce2555">pism::surface::DEBMSimple::timeseries_length</a></div><div class="ttdeci">unsigned int timeseries_length(double dt) const</div><div class="ttdoc">The number of points for temperature and precipitation time-series.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00776">DEBMSimple.cc:776</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_abccbac7f63843606ae008292e590c36e_html_abccbac7f63843606ae008292e590c36e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_abccbac7f63843606ae008292e590c36e.html#abccbac7f63843606ae008292e590c36e">pism::surface::DEBMSimple::m_year_length</a></div><div class="ttdeci">double m_year_length</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00126">DEBMSimple.hh:126</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ac01ecc6fa10e070f3dfb3100ecf1e5c1_html_ac01ecc6fa10e070f3dfb3100ecf1e5c1"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ac01ecc6fa10e070f3dfb3100ecf1e5c1.html#ac01ecc6fa10e070f3dfb3100ecf1e5c1">pism::surface::DEBMSimple::m_sd_param_b</a></div><div class="ttdeci">double m_sd_param_b</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00133">DEBMSimple.hh:133</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de_html_ac043bac21e54fee65aa013d1de2014de"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ac043bac21e54fee65aa013d1de2014de.html#ac043bac21e54fee65aa013d1de2014de">pism::surface::DEBMSimple::m_model</a></div><div class="ttdeci">DEBMSimplePointwise m_model</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00082">DEBMSimple.hh:82</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ac44b2794fcbba34adc3c75b1983f9456_html_ac44b2794fcbba34adc3c75b1983f9456"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ac44b2794fcbba34adc3c75b1983f9456.html#ac44b2794fcbba34adc3c75b1983f9456">pism::surface::DEBMSimple::diagnostics_impl</a></div><div class="ttdeci">virtual DiagnosticList diagnostics_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00782">DEBMSimple.cc:782</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ac463f359e1babf5931fc58744efa64fc_html_ac463f359e1babf5931fc58744efa64fc"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ac463f359e1babf5931fc58744efa64fc.html#ac463f359e1babf5931fc58744efa64fc">pism::surface::DEBMSimple::offset_melt</a></div><div class="ttdeci">const array::Scalar &amp; offset_melt() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00537">DEBMSimple.cc:537</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ac977d7bd508cb2a5c056af23afa1dd30_html_ac977d7bd508cb2a5c056af23afa1dd30"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ac977d7bd508cb2a5c056af23afa1dd30.html#ac977d7bd508cb2a5c056af23afa1dd30">pism::surface::DEBMSimple::accumulation_impl</a></div><div class="ttdeci">const array::Scalar &amp; accumulation_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00509">DEBMSimple.cc:509</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_acdc5c6d688c46fb51a7a6cf760de7555_html_acdc5c6d688c46fb51a7a6cf760de7555"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_acdc5c6d688c46fb51a7a6cf760de7555.html#acdc5c6d688c46fb51a7a6cf760de7555">pism::surface::DEBMSimple::snow_depth</a></div><div class="ttdeci">const array::Scalar &amp; snow_depth() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00521">DEBMSimple.cc:521</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_acf76a79e5e1d12d97d201d369f38ccfe_html_acf76a79e5e1d12d97d201d369f38ccfe"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_acf76a79e5e1d12d97d201d369f38ccfe.html#acf76a79e5e1d12d97d201d369f38ccfe">pism::surface::DEBMSimple::temperature_driven_melt</a></div><div class="ttdeci">const array::Scalar &amp; temperature_driven_melt() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00533">DEBMSimple.cc:533</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ad2b014031c4810a4f0afdf93be199099_html_ad2b014031c4810a4f0afdf93be199099"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ad2b014031c4810a4f0afdf93be199099.html#ad2b014031c4810a4f0afdf93be199099">pism::surface::DEBMSimple::max_timestep_impl</a></div><div class="ttdeci">virtual MaxTimestep max_timestep_impl(double t) const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00214">DEBMSimple.cc:214</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ad2b4a43ccffe7c006884656be6fb2c00_html_ad2b4a43ccffe7c006884656be6fb2c00"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ad2b4a43ccffe7c006884656be6fb2c00.html#ad2b4a43ccffe7c006884656be6fb2c00">pism::surface::DEBMSimple::melt_impl</a></div><div class="ttdeci">const array::Scalar &amp; melt_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00513">DEBMSimple.cc:513</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4_html_ad3528699fc5e770e11161478c254b0e4"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ad3528699fc5e770e11161478c254b0e4.html#ad3528699fc5e770e11161478c254b0e4">pism::surface::DEBMSimple::m_offset_melt</a></div><div class="ttdeci">array::Scalar m_offset_melt</div><div class="ttdoc">total offset_melt during the last timestep</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00113">DEBMSimple.hh:113</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_adef67f630736eafba0a6c55f2c089c67_html_adef67f630736eafba0a6c55f2c089c67"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_adef67f630736eafba0a6c55f2c089c67.html#adef67f630736eafba0a6c55f2c089c67">pism::surface::DEBMSimple::DEBMSimple</a></div><div class="ttdeci">DEBMSimple(std::shared_ptr&lt; const Grid &gt; g, std::shared_ptr&lt; atmosphere::AtmosphereModel &gt; input)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00042">DEBMSimple.cc:42</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ae2d3e9e9b50dfb6cea3080b1f7fdf0ef_html_ae2d3e9e9b50dfb6cea3080b1f7fdf0ef"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ae2d3e9e9b50dfb6cea3080b1f7fdf0ef.html#ae2d3e9e9b50dfb6cea3080b1f7fdf0ef">pism::surface::DEBMSimple::init_impl</a></div><div class="ttdeci">virtual void init_impl(const Geometry &amp;geometry)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00166">DEBMSimple.cc:166</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d_html_ae597f0f591d17204029dd4fccc2f7f5d"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_ae597f0f591d17204029dd4fccc2f7f5d.html#ae597f0f591d17204029dd4fccc2f7f5d">pism::surface::DEBMSimple::m_Tmin</a></div><div class="ttdeci">double m_Tmin</div><div class="ttdoc">the temperature below which all precipitation is snow</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00138">DEBMSimple.hh:138</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_aea3264416ee858399c04e9dd4856c4a7_html_aea3264416ee858399c04e9dd4856c4a7"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_aea3264416ee858399c04e9dd4856c4a7.html#aea3264416ee858399c04e9dd4856c4a7">pism::surface::DEBMSimple::m_temperature</a></div><div class="ttdeci">std::shared_ptr&lt; array::Scalar &gt; m_temperature</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00089">DEBMSimple.hh:89</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_aecf74df33a09286608cbcc9c79eded9a_html_aecf74df33a09286608cbcc9c79eded9a"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_aecf74df33a09286608cbcc9c79eded9a.html#aecf74df33a09286608cbcc9c79eded9a">pism::surface::DEBMSimple::pointwise_model</a></div><div class="ttdeci">const DEBMSimplePointwise &amp; pointwise_model() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00561">DEBMSimple.cc:561</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0_html_aefe8e4a11292fa2faab544a48d5913b0"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_aefe8e4a11292fa2faab544a48d5913b0.html#aefe8e4a11292fa2faab544a48d5913b0">pism::surface::DEBMSimple::m_input_albedo</a></div><div class="ttdeci">std::shared_ptr&lt; array::Forcing &gt; m_input_albedo</div><div class="ttdoc">if albedo is given as input field</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00119">DEBMSimple.hh:119</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_afa2a9ecb5a2157d5e959d14bfd0d82a3_html_afa2a9ecb5a2157d5e959d14bfd0d82a3"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_afa2a9ecb5a2157d5e959d14bfd0d82a3.html#afa2a9ecb5a2157d5e959d14bfd0d82a3">pism::surface::DEBMSimple::temperature_impl</a></div><div class="ttdeci">virtual const array::Scalar &amp; temperature_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00505">DEBMSimple.cc:505</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_afd9a45145bf2a2fbd54fb2c33adf058e_html_afd9a45145bf2a2fbd54fb2c33adf058e"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple_afd9a45145bf2a2fbd54fb2c33adf058e.html#afd9a45145bf2a2fbd54fb2c33adf058e">pism::surface::DEBMSimple::m_precip_as_snow</a></div><div class="ttdeci">bool m_precip_as_snow</div><div class="ttdoc">interpret all the precipitation as snow (no rain)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00136">DEBMSimple.hh:136</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1DEBMSimple_html"><div class="ttname"><a href="classpism_1_1surface_1_1DEBMSimple.html">pism::surface::DEBMSimple</a></div><div class="ttdoc">A class implementing a temperature-index (positive degree-day) scheme to compute melt and runoff,...</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8hh_source.html#l00039">DEBMSimple.hh:39</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a0bc45dacd90ee84e94695505d3123ec6_html_a0bc45dacd90ee84e94695505d3123ec6"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a0bc45dacd90ee84e94695505d3123ec6.html#a0bc45dacd90ee84e94695505d3123ec6">pism::surface::SurfaceModel::allocate_runoff</a></div><div class="ttdeci">static std::shared_ptr&lt; array::Scalar &gt; allocate_runoff(std::shared_ptr&lt; const Grid &gt; grid)</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00124">SurfaceModel.cc:124</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc_html_a22e31b57b550f96a22d16be8103d2bcc"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a22e31b57b550f96a22d16be8103d2bcc.html#a22e31b57b550f96a22d16be8103d2bcc">pism::surface::SurfaceModel::m_atmosphere</a></div><div class="ttdeci">std::shared_ptr&lt; atmosphere::AtmosphereModel &gt; m_atmosphere</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8hh_source.html#l00108">SurfaceModel.hh:108</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a24c2488f992cf6f937cd08b87c5c89c8_html_a24c2488f992cf6f937cd08b87c5c89c8"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a24c2488f992cf6f937cd08b87c5c89c8.html#a24c2488f992cf6f937cd08b87c5c89c8">pism::surface::SurfaceModel::diagnostics_impl</a></div><div class="ttdeci">virtual DiagnosticList diagnostics_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00799">SurfaceModel.cc:799</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a2d7e7c56b9feab53f1b9058ed738ff24_html_a2d7e7c56b9feab53f1b9058ed738ff24"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a2d7e7c56b9feab53f1b9058ed738ff24.html#a2d7e7c56b9feab53f1b9058ed738ff24">pism::surface::SurfaceModel::write_model_state_impl</a></div><div class="ttdeci">virtual void write_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00328">SurfaceModel.cc:328</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a2e6c1ed05226d150c8240ad865946999_html_a2e6c1ed05226d150c8240ad865946999"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a2e6c1ed05226d150c8240ad865946999.html#a2e6c1ed05226d150c8240ad865946999">pism::surface::SurfaceModel::define_model_state_impl</a></div><div class="ttdeci">virtual void define_model_state_impl(const File &amp;output) const</div><div class="ttdoc">The default (empty implementation).</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00318">SurfaceModel.cc:318</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a32219dd14a6a9d77222fb9c600e91f4e_html_a32219dd14a6a9d77222fb9c600e91f4e"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a32219dd14a6a9d77222fb9c600e91f4e.html#a32219dd14a6a9d77222fb9c600e91f4e">pism::surface::SurfaceModel::allocate_temperature</a></div><div class="ttdeci">static std::shared_ptr&lt; array::Scalar &gt; allocate_temperature(std::shared_ptr&lt; const Grid &gt; grid)</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00092">SurfaceModel.cc:92</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a356651c8125dcb5552ea01d27b29ce1d_html_a356651c8125dcb5552ea01d27b29ce1d"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a356651c8125dcb5552ea01d27b29ce1d.html#a356651c8125dcb5552ea01d27b29ce1d">pism::surface::SurfaceModel::accumulation</a></div><div class="ttdeci">const array::Scalar &amp; accumulation() const</div><div class="ttdoc">Returns accumulation.</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00170">SurfaceModel.cc:170</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a459787d4d0c29c321bf56698190f2f12_html_a459787d4d0c29c321bf56698190f2f12"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a459787d4d0c29c321bf56698190f2f12.html#a459787d4d0c29c321bf56698190f2f12">pism::surface::SurfaceModel::allocate_accumulation</a></div><div class="ttdeci">static std::shared_ptr&lt; array::Scalar &gt; allocate_accumulation(std::shared_ptr&lt; const Grid &gt; grid)</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00106">SurfaceModel.cc:106</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_a4b35686cb1a1884ddbe2d21689a46df7_html_a4b35686cb1a1884ddbe2d21689a46df7"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_a4b35686cb1a1884ddbe2d21689a46df7.html#a4b35686cb1a1884ddbe2d21689a46df7">pism::surface::SurfaceModel::allocate_melt</a></div><div class="ttdeci">static std::shared_ptr&lt; array::Scalar &gt; allocate_melt(std::shared_ptr&lt; const Grid &gt; grid)</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00115">SurfaceModel.cc:115</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_ad96db6e402a90adb744b7e7ad9322cb3_html_ad96db6e402a90adb744b7e7ad9322cb3"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel_ad96db6e402a90adb744b7e7ad9322cb3.html#ad96db6e402a90adb744b7e7ad9322cb3">pism::surface::SurfaceModel::init_impl</a></div><div class="ttdeci">virtual void init_impl(const Geometry &amp;geometry)</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8cc_source.html#l00294">SurfaceModel.cc:294</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1SurfaceModel_html"><div class="ttname"><a href="classpism_1_1surface_1_1SurfaceModel.html">pism::surface::SurfaceModel</a></div><div class="ttdoc">The interface of PISM's surface models.</div><div class="ttdef"><b>Definition:</b> <a href="SurfaceModel_8hh_source.html#l00042">SurfaceModel.hh:42</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d_html_a1f85f48e43155b34f64ce87af961048d"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_a1f85f48e43155b34f64ce87af961048d.html#a1f85f48e43155b34f64ce87af961048d">pism::surface::diagnostics::DEBMSBackroundMelt::m_melt_mass</a></div><div class="ttdeci">array::Scalar m_melt_mass</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00769">DEBMSimple.cc:769</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad250dead7b27b5a28ebc4f090666671a_html_ad250dead7b27b5a28ebc4f090666671a"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad250dead7b27b5a28ebc4f090666671a.html#ad250dead7b27b5a28ebc4f090666671a">pism::surface::diagnostics::DEBMSBackroundMelt::model_input</a></div><div class="ttdeci">const array::Scalar &amp; model_input()</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00755">DEBMSimple.cc:755</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8_html_ad9859be62d624ecd9ee8c80704d282c8"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ad9859be62d624ecd9ee8c80704d282c8.html#ad9859be62d624ecd9ee8c80704d282c8">pism::surface::diagnostics::DEBMSBackroundMelt::m_kind</a></div><div class="ttdeci">AmountKind m_kind</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00768">DEBMSimple.cc:768</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ae13b366b9cb46e69862bdf267f0a078f_html_ae13b366b9cb46e69862bdf267f0a078f"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_ae13b366b9cb46e69862bdf267f0a078f.html#ae13b366b9cb46e69862bdf267f0a078f">pism::surface::diagnostics::DEBMSBackroundMelt::DEBMSBackroundMelt</a></div><div class="ttdeci">DEBMSBackroundMelt(const DEBMSimple *m, AmountKind kind)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00722">DEBMSimple.cc:722</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt_html"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSBackroundMelt.html">pism::surface::diagnostics::DEBMSBackroundMelt</a></div><div class="ttdoc">Report surface backround melt, averaged over the reporting interval.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00720">DEBMSimple.cc:720</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a107a07dce9b156533bd0c0dbec798a54_html_a107a07dce9b156533bd0c0dbec798a54"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a107a07dce9b156533bd0c0dbec798a54.html#a107a07dce9b156533bd0c0dbec798a54">pism::surface::diagnostics::DEBMSInsolationMelt::DEBMSInsolationMelt</a></div><div class="ttdeci">DEBMSInsolationMelt(const DEBMSimple *m, AmountKind kind)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00612">DEBMSimple.cc:612</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a5e52dc3020159ca26ee188f2a78f60b8_html_a5e52dc3020159ca26ee188f2a78f60b8"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_a5e52dc3020159ca26ee188f2a78f60b8.html#a5e52dc3020159ca26ee188f2a78f60b8">pism::surface::diagnostics::DEBMSInsolationMelt::model_input</a></div><div class="ttdeci">const array::Scalar &amp; model_input()</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00648">DEBMSimple.cc:648</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c_html_ae481ea8d164b34dc9e51ea6c7705890c"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_ae481ea8d164b34dc9e51ea6c7705890c.html#ae481ea8d164b34dc9e51ea6c7705890c">pism::surface::diagnostics::DEBMSInsolationMelt::m_melt_mass</a></div><div class="ttdeci">array::Scalar m_melt_mass</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00662">DEBMSimple.cc:662</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47_html_aee35e2a7dec65c0b459854b06d1b8b47"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_aee35e2a7dec65c0b459854b06d1b8b47.html#aee35e2a7dec65c0b459854b06d1b8b47">pism::surface::diagnostics::DEBMSInsolationMelt::m_kind</a></div><div class="ttdeci">AmountKind m_kind</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00661">DEBMSimple.cc:661</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt_html"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolationMelt.html">pism::surface::diagnostics::DEBMSInsolationMelt</a></div><div class="ttdoc">Report surface insolation melt, averaged over the reporting interval.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00610">DEBMSimple.cc:610</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_ac629e1ea8546500a4fa976b8a5d7d50d_html_ac629e1ea8546500a4fa976b8a5d7d50d"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_ac629e1ea8546500a4fa976b8a5d7d50d.html#ac629e1ea8546500a4fa976b8a5d7d50d">pism::surface::diagnostics::DEBMSInsolation::DEBMSInsolation</a></div><div class="ttdeci">DEBMSInsolation(const DEBMSimple *m)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00571">DEBMSimple.cc:571</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_af8029b6cfe4959a9006c95396bf2146a_html_af8029b6cfe4959a9006c95396bf2146a"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_af8029b6cfe4959a9006c95396bf2146a.html#af8029b6cfe4959a9006c95396bf2146a">pism::surface::diagnostics::DEBMSInsolation::compute_impl</a></div><div class="ttdeci">std::shared_ptr&lt; array::Array &gt; compute_impl() const</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00580">DEBMSimple.cc:580</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSInsolation_html"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSInsolation.html">pism::surface::diagnostics::DEBMSInsolation</a></div><div class="ttdoc">Report mean top of atmosphere insolation.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00568">DEBMSimple.cc:569</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e_html_a4b1f70b6487f4ec61e7bc3a830ad949e"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a4b1f70b6487f4ec61e7bc3a830ad949e.html#a4b1f70b6487f4ec61e7bc3a830ad949e">pism::surface::diagnostics::DEBMSTemperatureMelt::m_melt_mass</a></div><div class="ttdeci">array::Scalar m_melt_mass</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00716">DEBMSimple.cc:716</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122_html_a5a9890f3ca16b52b8e031f9e9f1a0122"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a5a9890f3ca16b52b8e031f9e9f1a0122.html#a5a9890f3ca16b52b8e031f9e9f1a0122">pism::surface::diagnostics::DEBMSTemperatureMelt::m_kind</a></div><div class="ttdeci">AmountKind m_kind</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00715">DEBMSimple.cc:715</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a7079beda7c7d3fa84151977f9c1fb2f0_html_a7079beda7c7d3fa84151977f9c1fb2f0"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_a7079beda7c7d3fa84151977f9c1fb2f0.html#a7079beda7c7d3fa84151977f9c1fb2f0">pism::surface::diagnostics::DEBMSTemperatureMelt::model_input</a></div><div class="ttdeci">const array::Scalar &amp; model_input()</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00702">DEBMSimple.cc:702</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_ab50516a2af5aafcd1a867d26420197d5_html_ab50516a2af5aafcd1a867d26420197d5"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_ab50516a2af5aafcd1a867d26420197d5.html#ab50516a2af5aafcd1a867d26420197d5">pism::surface::diagnostics::DEBMSTemperatureMelt::DEBMSTemperatureMelt</a></div><div class="ttdeci">DEBMSTemperatureMelt(const DEBMSimple *m, AmountKind kind)</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00668">DEBMSimple.cc:668</a></div></div>
<div class="ttc" id="aclasspism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt_html"><div class="ttname"><a href="classpism_1_1surface_1_1diagnostics_1_1DEBMSTemperatureMelt.html">pism::surface::diagnostics::DEBMSTemperatureMelt</a></div><div class="ttdoc">Report surface temperature melt, averaged over the reporting interval.</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00666">DEBMSimple.cc:666</a></div></div>
<div class="ttc" id="aerror__handling_8hh_aa0c260bffe8a4dbd77d48e8feee7c526_html_aa0c260bffe8a4dbd77d48e8feee7c526"><div class="ttname"><a href="error__handling_8hh_aa0c260bffe8a4dbd77d48e8feee7c526.html#aa0c260bffe8a4dbd77d48e8feee7c526">PISM_ERROR_LOCATION</a></div><div class="ttdeci">#define PISM_ERROR_LOCATION</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8hh_source.html#l00043">error_handling.hh:43</a></div></div>
<div class="ttc" id="anamespacepism_1_1array_a8957d08741c6f48d1e554ac7ea98530a_html_a8957d08741c6f48d1e554ac7ea98530a"><div class="ttname"><a href="namespacepism_1_1array_a8957d08741c6f48d1e554ac7ea98530a.html#a8957d08741c6f48d1e554ac7ea98530a">pism::array::max</a></div><div class="ttdeci">double max(const array::Scalar &amp;input)</div><div class="ttdoc">Finds maximum over all the values in an array::Scalar object. Ignores ghosts.</div><div class="ttdef"><b>Definition:</b> <a href="Scalar_8cc_source.html#l00165">Scalar.cc:165</a></div></div>
<div class="ttc" id="anamespacepism_1_1diagnostics_a9be104df35f48c5782d93a48a0890024_html_a9be104df35f48c5782d93a48a0890024af801d3552a0696abd73d75b3270885aa"><div class="ttname"><a href="namespacepism_1_1diagnostics_a9be104df35f48c5782d93a48a0890024.html#a9be104df35f48c5782d93a48a0890024af801d3552a0696abd73d75b3270885aa">pism::diagnostics::SMB</a></div><div class="ttdeci">@ SMB</div><div class="ttdef"><b>Definition:</b> <a href="diagnostics_8cc_source.html#l00632">diagnostics.cc:632</a></div></div>
<div class="ttc" id="anamespacepism_1_1io_a0caba8881b0d36c8cc1eccfa13c0e81f_html_a0caba8881b0d36c8cc1eccfa13c0e81fa308d77197e903bf4f5505b8cb5e377a2"><div class="ttname"><a href="namespacepism_1_1io_a0caba8881b0d36c8cc1eccfa13c0e81f.html#a0caba8881b0d36c8cc1eccfa13c0e81fa308d77197e903bf4f5505b8cb5e377a2">pism::io::PISM_GUESS</a></div><div class="ttdeci">@ PISM_GUESS</div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00056">IO_Flags.hh:56</a></div></div>
<div class="ttc" id="anamespacepism_1_1io_a12c1fd23e92335e2396baab0354b262f_html_a12c1fd23e92335e2396baab0354b262fabb5d91fa1da1214c24d193a75f11f0a2"><div class="ttname"><a href="namespacepism_1_1io_a12c1fd23e92335e2396baab0354b262f.html#a12c1fd23e92335e2396baab0354b262fabb5d91fa1da1214c24d193a75f11f0a2">pism::io::PISM_READONLY</a></div><div class="ttdeci">@ PISM_READONLY</div><div class="ttdoc">open an existing file for reading only</div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00072">IO_Flags.hh:72</a></div></div>
<div class="ttc" id="anamespacepism_1_1io_a53ffb40793c398e10644fbd2ecda3e77_html_a53ffb40793c398e10644fbd2ecda3e77a6a72c64f82168bec6bf8b648a86648de"><div class="ttname"><a href="namespacepism_1_1io_a53ffb40793c398e10644fbd2ecda3e77.html#a53ffb40793c398e10644fbd2ecda3e77a6a72c64f82168bec6bf8b648a86648de">pism::io::PISM_DOUBLE</a></div><div class="ttdeci">@ PISM_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="IO__Flags_8hh_source.html#l00053">IO_Flags.hh:52</a></div></div>
<div class="ttc" id="anamespacepism_1_1mask_aa0f191a232701f97c950f59485b8e429_html_aa0f191a232701f97c950f59485b8e429"><div class="ttname"><a href="namespacepism_1_1mask_aa0f191a232701f97c950f59485b8e429.html#aa0f191a232701f97c950f59485b8e429">pism::mask::ice_free_ocean</a></div><div class="ttdeci">bool ice_free_ocean(int M)</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00061">Mask.hh:61</a></div></div>
<div class="ttc" id="anamespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986_html_acadff920eb40e3febfa8f0cbd19b2986"><div class="ttname"><a href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986">pism::surface::diagnostics::AmountKind</a></div><div class="ttdeci">AmountKind</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00607">DEBMSimple.cc:607</a></div></div>
<div class="ttc" id="anamespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986_html_acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b"><div class="ttname"><a href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986a0a5cd199a02768d6005905118e4e8a0b">pism::surface::diagnostics::MASS</a></div><div class="ttdeci">@ MASS</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00607">DEBMSimple.cc:607</a></div></div>
<div class="ttc" id="anamespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986_html_acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f"><div class="ttname"><a href="namespacepism_1_1surface_1_1diagnostics_acadff920eb40e3febfa8f0cbd19b2986.html#acadff920eb40e3febfa8f0cbd19b2986ad6b52059629f1a3bbbbac787b803b93f">pism::surface::diagnostics::AMOUNT</a></div><div class="ttdeci">@ AMOUNT</div><div class="ttdef"><b>Definition:</b> <a href="DEBMSimple_8cc_source.html#l00607">DEBMSimple.cc:607</a></div></div>
<div class="ttc" id="anamespacepism_1_1units_aae3f4db8a6a2365e607a699bc61a5077_html_aae3f4db8a6a2365e607a699bc61a5077"><div class="ttname"><a href="namespacepism_1_1units_aae3f4db8a6a2365e607a699bc61a5077.html#aae3f4db8a6a2365e607a699bc61a5077">pism::units::convert</a></div><div class="ttdeci">double convert(System::Ptr system, double input, const std::string &amp;spec1, const std::string &amp;spec2)</div><div class="ttdoc">Convert a quantity from unit1 to unit2.</div><div class="ttdef"><b>Definition:</b> <a href="Units_8cc_source.html#l00070">Units.cc:70</a></div></div>
<div class="ttc" id="anamespacepism_a3415cf6a7a4530c4e489feebe6365e03_html_a3415cf6a7a4530c4e489feebe6365e03aa03926dd636ce1d977b1a8a9ed608c85"><div class="ttname"><a href="namespacepism_a3415cf6a7a4530c4e489feebe6365e03.html#a3415cf6a7a4530c4e489feebe6365e03aa03926dd636ce1d977b1a8a9ed608c85">pism::LINEAR</a></div><div class="ttdeci">@ LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="interpolation_8hh_source.html#l00029">interpolation.hh:29</a></div></div>
<div class="ttc" id="anamespacepism_a44fca05de5c3d0cb82c4a2910666b6e2_html_a44fca05de5c3d0cb82c4a2910666b6e2"><div class="ttname"><a href="namespacepism_a44fca05de5c3d0cb82c4a2910666b6e2.html#a44fca05de5c3d0cb82c4a2910666b6e2">pism::process_input_options</a></div><div class="ttdeci">InputOptions process_input_options(MPI_Comm com, Config::ConstPtr config)</div><div class="ttdef"><b>Definition:</b> <a href="Component_8cc_source.html#l00043">Component.cc:43</a></div></div>
<div class="ttc" id="anamespacepism_a47d754ed3e959d5866b02a1b78b6a5b5_html_a47d754ed3e959d5866b02a1b78b6a5b5"><div class="ttname"><a href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">pism::g</a></div><div class="ttdeci">static const double g</div><div class="ttdef"><b>Definition:</b> <a href="exactTestP_8cc_source.html#l00036">exactTestP.cc:36</a></div></div>
<div class="ttc" id="anamespacepism_a56e80801555b7f36f4dd28941739654a_html_a56e80801555b7f36f4dd28941739654aa260aa6280296d9fffc338c9ecdaba861"><div class="ttname"><a href="namespacepism_a56e80801555b7f36f4dd28941739654a.html#a56e80801555b7f36f4dd28941739654aa260aa6280296d9fffc338c9ecdaba861">pism::INIT_BOOTSTRAP</a></div><div class="ttdeci">@ INIT_BOOTSTRAP</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00056">Component.hh:56</a></div></div>
<div class="ttc" id="anamespacepism_a56e80801555b7f36f4dd28941739654a_html_a56e80801555b7f36f4dd28941739654aa6aff4b43552f00d5cc331453ff4029bc"><div class="ttname"><a href="namespacepism_a56e80801555b7f36f4dd28941739654a.html#a56e80801555b7f36f4dd28941739654aa6aff4b43552f00d5cc331453ff4029bc">pism::INIT_RESTART</a></div><div class="ttdeci">@ INIT_RESTART</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00056">Component.hh:56</a></div></div>
<div class="ttc" id="anamespacepism_a6154a990ba873c6ca606d8a320c441ac_html_a6154a990ba873c6ca606d8a320c441ac"><div class="ttname"><a href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">pism::DiagnosticList</a></div><div class="ttdeci">std::map&lt; std::string, Diagnostic::Ptr &gt; DiagnosticList</div><div class="ttdef"><b>Definition:</b> <a href="Diagnostic_8hh_source.html#l00125">Diagnostic.hh:125</a></div></div>
<div class="ttc" id="anamespacepism_a7343afff8d353b59dbdec563bd896812_html_a7343afff8d353b59dbdec563bd896812"><div class="ttname"><a href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">pism::k</a></div><div class="ttdeci">static const double k</div><div class="ttdef"><b>Definition:</b> <a href="exactTestP_8cc_source.html#l00042">exactTestP.cc:42</a></div></div>
<div class="ttc" id="anamespacepism_a782c0f064d473f15c29df4f1ac7bbed9_html_a782c0f064d473f15c29df4f1ac7bbed9"><div class="ttname"><a href="namespacepism_a782c0f064d473f15c29df4f1ac7bbed9.html#a782c0f064d473f15c29df4f1ac7bbed9">pism::MaskValue</a></div><div class="ttdeci">MaskValue</div><div class="ttdef"><b>Definition:</b> <a href="Mask_8hh_source.html#l00030">Mask.hh:30</a></div></div>
<div class="ttc" id="anamespacepism_ab50523fe25aadf4a123551726b2a2967_html_ab50523fe25aadf4a123551726b2a2967"><div class="ttname"><a href="namespacepism_ab50523fe25aadf4a123551726b2a2967.html#ab50523fe25aadf4a123551726b2a2967">pism::combine</a></div><div class="ttdeci">T combine(const T &amp;a, const T &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="pism__utilities_8hh_source.html#l00095">pism_utilities.hh:95</a></div></div>
<div class="ttc" id="anamespacepism_html"><div class="ttname"><a href="namespacepism.html">pism</a></div><div class="ttdef"><b>Definition:</b> <a href="AgeColumnSystem_8cc_source.html#l00023">AgeColumnSystem.cc:23</a></div></div>
<div class="ttc" id="astructpism_1_1InputOptions_a0fe5db51286e55c31b1575dc9ecc5d70_html_a0fe5db51286e55c31b1575dc9ecc5d70"><div class="ttname"><a href="structpism_1_1InputOptions_a0fe5db51286e55c31b1575dc9ecc5d70.html#a0fe5db51286e55c31b1575dc9ecc5d70">pism::InputOptions::type</a></div><div class="ttdeci">InitializationType type</div><div class="ttdoc">initialization type</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00061">Component.hh:61</a></div></div>
<div class="ttc" id="astructpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5_html_a2dc298f0e83b951fa1df5eab910639e5"><div class="ttname"><a href="structpism_1_1InputOptions_a2dc298f0e83b951fa1df5eab910639e5.html#a2dc298f0e83b951fa1df5eab910639e5">pism::InputOptions::filename</a></div><div class="ttdeci">std::string filename</div><div class="ttdoc">name of the input file (if applicable)</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00063">Component.hh:63</a></div></div>
<div class="ttc" id="astructpism_1_1InputOptions_ae33c7fb4ca1317444d959bc3e1514ba4_html_ae33c7fb4ca1317444d959bc3e1514ba4"><div class="ttname"><a href="structpism_1_1InputOptions_ae33c7fb4ca1317444d959bc3e1514ba4.html#ae33c7fb4ca1317444d959bc3e1514ba4">pism::InputOptions::record</a></div><div class="ttdeci">unsigned int record</div><div class="ttdoc">index of the record to re-start from</div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00065">Component.hh:65</a></div></div>
<div class="ttc" id="astructpism_1_1InputOptions_html"><div class="ttname"><a href="structpism_1_1InputOptions.html">pism::InputOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="Component_8hh_source.html#l00058">Component.hh:58</a></div></div>
<div class="ttc" id="atest__cube_8c_a0d20d4720401ba664775e4eccc876ed0_html_a0d20d4720401ba664775e4eccc876ed0"><div class="ttname"><a href="test__cube_8c_a0d20d4720401ba664775e4eccc876ed0.html#a0d20d4720401ba664775e4eccc876ed0">S</a></div><div class="ttdeci">static double S(unsigned n)</div><div class="ttdef"><b>Definition:</b> <a href="test__cube_8c_source.html#l00058">test_cube.c:58</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
