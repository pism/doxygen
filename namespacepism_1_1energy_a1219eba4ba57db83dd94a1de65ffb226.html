<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: pism::energy::bootstrap_ice_temperature</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.1 committed by Constantine Khrulev on 2023-11-23 11:24:22 -0900</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepism.html">pism</a></li><li class="navelem"><a class="el" href="namespacepism_1_1energy.html">energy</a></li>  </ul>
</div>
</div><!-- top -->
<div class="contents">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a069bacaf5e3b16a49c815ac676631733.html#a069bacaf5e3b16a49c815ac676631733">ApforG</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a90e99e8a1c1c6fcd1822a194ca7830c4.html#a90e99e8a1c1c6fcd1822a194ca7830c4">bootstrap_ice_enthalpy</a></td></tr>
          <tr><td class="navtabHL"><a class="navtab" href="namespacepism_1_1energy_a1219eba4ba57db83dd94a1de65ffb226.html#a1219eba4ba57db83dd94a1de65ffb226">bootstrap_ice_temperature</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a21ad4352bf0bb7cff3cf276fec6cf628.html#a21ad4352bf0bb7cff3cf276fec6cf628">check_input</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a36070f8c53795f0b98a10e460734d386.html#a36070f8c53795f0b98a10e460734d386">compute_cts</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a9f350e92314dfcf5da7ab5a0a163bb0e.html#a9f350e92314dfcf5da7ab5a0a163bb0e">compute_enthalpy</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a736dd27824d2b2ad887adba36fe1ca35.html#a736dd27824d2b2ad887adba36fe1ca35">compute_enthalpy_cold</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a02603fd924b8cd94c7bea3d38c2f2b4e.html#a02603fd924b8cd94c7bea3d38c2f2b4e">compute_liquid_water_fraction</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a891e31436c10b286a1c5e3e797da06b0.html#a891e31436c10b286a1c5e3e797da06b0">compute_temperature</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a254332ce85be26e97493d8d2814d8989.html#a254332ce85be26e97493d8d2814d8989">cryo_hydrologic_warming_flux</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a527fc9e2119cc439d579b00ef5232c7c.html#a527fc9e2119cc439d579b00ef5232c7c">ice_temperature_guess</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a5d2d5c246fd9d50efb2976185a4e4bf9.html#a5d2d5c246fd9d50efb2976185a4e4bf9">ice_temperature_guess_smb</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a5037999927a127204bbf595effdf29f2.html#a5037999927a127204bbf595effdf29f2">LforFG</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a5947863588636523462b5766409acf47.html#a5947863588636523462b5766409acf47">marginal</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a354aea9ba8777615c7728f4f99b015b9.html#a354aea9ba8777615c7728f4f99b015b9">ST</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_a8a5c2fd3547f2e867ab3b50cc485ecb1.html#a8a5c2fd3547f2e867ab3b50cc485ecb1">Tmin</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_ac62fc3a1642089610165867b7818573f.html#ac62fc3a1642089610165867b7818573f">total_ice_enthalpy</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="namespacepism_1_1energy_acfc4adc32bea99dc051c6d913f838f7b.html#acfc4adc32bea99dc051c6d913f838f7b">upwind</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top" class="mempage">
<a id="a1219eba4ba57db83dd94a1de65ffb226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1219eba4ba57db83dd94a1de65ffb226">&#9670;&nbsp;</a></span>bootstrap_ice_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pism::energy::bootstrap_ice_temperature </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;&#160;</td>
          <td class="paramname"><em>ice_thickness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;&#160;</td>
          <td class="paramname"><em>ice_surface_temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;&#160;</td>
          <td class="paramname"><em>surface_mass_balance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;&#160;</td>
          <td class="paramname"><em>basal_heat_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpism_1_1array_1_1Array3D.html">array::Array3D</a> &amp;&#160;</td>
          <td class="paramname"><em>result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a temperature field within the ice from provided ice thickness, surface temperature, surface mass balance, and geothermal flux. </p>
<p>In bootstrapping we need to determine initial values for the temperature within the ice (and the bedrock). There are various data available at bootstrapping, but not the 3<a class="el" href="classD.html">D</a> temperature field needed as initial values for the temperature. Here we take a "guess" based on an assumption of steady state and a simple model of the vertical velocity in the column. The rule is certainly heuristic but it seems to work well anyway.</p>
<p>The result is <em>not</em> the temperature field which is in steady state with the ice dynamics. Spinup is most-definitely needed in many applications. Such spinup usually starts from the temperature field computed by this procedure and then runs for a long time (e.g. \(10^4\) to \(10^6\) years), possibly with fixed geometry, to get closer to thermomechanically-coupled equilibrium.</p>
<p>Consider a horizontal grid point. Suppose the surface temperature \(T_s\), surface mass balance \(m\), and geothermal flux \(g\) are given at that location. Within the column denote the temperature by \(T(z)\) at height \(z\) above the base of the ice. Suppose the column of ice has height \(H\), the ice thickness.</p>
<p>There are two alternative bootstrap methods determined by the configuration parameter <code>config.get_number("bootstrapping.temperature_heuristic"))</code>. Allowed values are <code>"smb"</code> and <code>"quartic_guess"</code>.</p>
<ol type="1">
<li>If the <code>smb</code> method is chosen, which is the default, and if \(m&gt;0\), then the method sets the ice temperature to the solution of the steady problem [<a class="el" href="references.html#Paterson">Paterson</a>] <p class="formulaDsp">
\[\rho_i c w \frac{\partial T}{\partial z} = k_i \frac{\partial^2 T}{\partial z^2} \qquad \text{with boundary conditions} \qquad T(H) = T_s \quad \text{and} \quad \frac{\partial T}{\partial z}(0) = - \frac{g}{k_i}, \]
</p>
 where the vertical velocity is linear between the surface value \(w=-m\) and a velocity of zero at the base: <p class="formulaDsp">
\[w(z) = - m z / H.\]
</p>
 (Note that because \(m&gt;0\), this vertical velocity is downward.) This is a two-point boundary value problem for a linear ODE. In fact, if \(K = k_i / (\rho_i c)\) then we can write the ODE as <p class="formulaDsp">
\[K T&#39;&#39; + \frac{m z}{H} T&#39; = 0.\]
</p>
 Then let <p class="formulaDsp">
\[C_0 = \frac{g \sqrt{\pi H K}}{k_i \sqrt{2 m}}, \qquad \gamma_0 = \sqrt{\frac{mH}{2K}}.\]
</p>
 (Note \(\gamma_0\) is, up to a constant, the square root of the Peclet number [<a class="el" href="references.html#Paterson">Paterson</a>]; compare [<a class="el" href="references.html#vanderWeletal2013">vanderWeletal2013</a>].) The solution to the two-point boundary value problem is then <p class="formulaDsp">
\[T(z) = T_s + C_0 \left(\operatorname{erf}(\gamma_0) - \operatorname{erf}\left(\gamma_0 \frac{z}{H}\right)\right).\]
</p>
 If <code>usesmb</code> is true and \(m \le 0\), then the velocity in the column, relative to the base, is taken to be zero. Thus the solution is <p class="formulaDsp">
\[ T(z) = \frac{g}{k_i} \left( H - z \right) + T_s, \]
</p>
 a straight line whose slope is determined by the geothermal flux and whose value at the ice surface is the surface temperature, \(T(H) = T_s\).</li>
<li>If the <code>quartic_guess</code> method is chosen, the "quartic guess" formula which was in older versions of PISM is used. Namely, within the ice we set <p class="formulaDsp">
\[T(z) = T_s + \alpha (H-z)^2 + \beta (H-z)^4\]
</p>
 where \(\alpha,\beta\) are chosen so that <p class="formulaDsp">
\[\frac{\partial T}{\partial z}\Big|_{z=0} = - \frac{g}{k_i} \qquad \text{and} \qquad \frac{\partial T}{\partial z}\Big|_{z=H/4} = - \frac{g}{2 k_i}.\]
</p>
 The purpose of the second condition is that when ice is advecting downward then the temperature gradient is much larger in roughly the bottom quarter of the ice column. However, without the surface mass balance, much less the solution of the stress balance equations, we cannot estimate the vertical velocity, so we make such a rough guess.</li>
</ol>
<p>In either case the temperature within the ice is not allowed to exceed the pressure-melting temperature.</p>
<p>We set \(T(z)=T_s\) above the top of the ice.</p>
<p>This method determines \(T(0)\), the ice temperature at the ice base. This temperature is used by BedThermalUnit::bootstrap() to determine a bootstrap temperature profile in the bedrock. </p>

<p class="definition">Definition at line <a class="el" href="energy_2utilities_8cc_source.html#l00327">327</a> of file <a class="el" href="energy_2utilities_8cc_source.html">utilities.cc</a>.</p>

<p class="reference">References <a class="el" href="error__handling_8cc_source.html#l00201">pism::ParallelSection::check()</a>, <a class="el" href="error__handling_8cc_source.html#l00185">pism::ParallelSection::failed()</a>, <a class="el" href="error__handling_8cc_source.html#l00047">pism::RuntimeError::formatted()</a>, <a class="el" href="exactTestK_8c_source.html#l00040">G</a>, <a class="el" href="Array3D_8cc_source.html#l00120">pism::array::Array3D::get_column()</a>, <a class="el" href="VariableMetadata_8cc_source.html#l00272">pism::VariableMetadata::get_number()</a>, <a class="el" href="Array_8cc_source.html#l00132">pism::array::Array::grid()</a>, <a class="el" href="bootstrapping_8cc_source.html#l00029">ice_temperature_guess()</a>, <a class="el" href="bootstrapping_8cc_source.html#l00045">ice_temperature_guess_smb()</a>, <a class="el" href="EmptyingProblem_8cc_source.html#l00408">pism::hydrology::K()</a>, <a class="el" href="exactTestP_8cc_source.html#l00042">pism::k</a>, <a class="el" href="Array_8cc_source.html#l00553">pism::array::Array::metadata()</a>, <a class="el" href="Scalar_8cc_source.html#l00193">pism::array::min()</a>, <a class="el" href="error__handling_8hh_source.html#l00043">PISM_ERROR_LOCATION</a>, <a class="el" href="diagnostics_8cc_source.html#l00632">pism::diagnostics::SMB</a>, and <a class="el" href="Array_8cc_source.html#l00693">pism::array::Array::update_ghosts()</a>.</p>

<p class="reference">Referenced by <a class="el" href="energy_2utilities_8cc_source.html#l00439">bootstrap_ice_enthalpy()</a>, <a class="el" href="TemperatureModel_8cc_source.html#l00070">pism::energy::TemperatureModel::bootstrap_impl()</a>, and <a class="el" href="TemperatureModel_8cc_source.html#l00094">pism::energy::TemperatureModel::initialize_impl()</a>.</p>

</div>
</div>
    </td>
  </tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
