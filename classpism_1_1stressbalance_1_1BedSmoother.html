<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: pism::stressbalance::BedSmoother Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.1-1-g6902d5502 committed by Ed Bueler on 2023-12-20 08:38:27 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepism.html">pism</a></li><li class="navelem"><a class="el" href="namespacepism_1_1stressbalance.html">stressbalance</a></li><li class="navelem"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother.html">BedSmoother</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classpism_1_1stressbalance_1_1BedSmoother-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pism::stressbalance::BedSmoother Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003).  
 <a href="classpism_1_1stressbalance_1_1BedSmoother.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="BedSmoother_8hh_source.html">BedSmoother.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a32338d245c30dd4f2a3bb5218f59e3bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a32338d245c30dd4f2a3bb5218f59e3bc.html#a32338d245c30dd4f2a3bb5218f59e3bc">BedSmoother</a> (std::shared_ptr&lt; const <a class="el" href="classpism_1_1Grid.html">Grid</a> &gt; <a class="el" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>)</td></tr>
<tr class="separator:a32338d245c30dd4f2a3bb5218f59e3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a21f0c740b0753ab62e00ce9dba9bdd"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a2a21f0c740b0753ab62e00ce9dba9bdd.html#a2a21f0c740b0753ab62e00ce9dba9bdd">~BedSmoother</a> ()=default</td></tr>
<tr class="separator:a2a21f0c740b0753ab62e00ce9dba9bdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13dd0bbf11b712bbef3eeaf93a8f527"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae13dd0bbf11b712bbef3eeaf93a8f527.html#ae13dd0bbf11b712bbef3eeaf93a8f527">preprocess_bed</a> (const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;topg)</td></tr>
<tr class="separator:ae13dd0bbf11b712bbef3eeaf93a8f527"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b304465661b70e7d2faa4b49aff5eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a38b304465661b70e7d2faa4b49aff5eb.html#a38b304465661b70e7d2faa4b49aff5eb">smoothed_thk</a> (const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;usurf, const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;thk, const <a class="el" href="classpism_1_1array_1_1CellType2.html">array::CellType2</a> &amp;mask, <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;thksmooth) const</td></tr>
<tr class="memdesc:a38b304465661b70e7d2faa4b49aff5eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes a smoothed thickness map.  <a href="classpism_1_1stressbalance_1_1BedSmoother_a38b304465661b70e7d2faa4b49aff5eb.html#a38b304465661b70e7d2faa4b49aff5eb">More...</a><br /></td></tr>
<tr class="separator:a38b304465661b70e7d2faa4b49aff5eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b068f8e7b3d3aa7235e6d1bec1f797"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a71b068f8e7b3d3aa7235e6d1bec1f797.html#a71b068f8e7b3d3aa7235e6d1bec1f797">theta</a> (const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;usurf, <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;result) const</td></tr>
<tr class="separator:a71b068f8e7b3d3aa7235e6d1bec1f797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a706c3a4805bc78586d0e0d8e4973b7bb"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a706c3a4805bc78586d0e0d8e4973b7bb.html#a706c3a4805bc78586d0e0d8e4973b7bb">smoothed_bed</a> () const</td></tr>
<tr class="separator:a706c3a4805bc78586d0e0d8e4973b7bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:addb17716aefc353aee774bc3921eb29b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_addb17716aefc353aee774bc3921eb29b.html#addb17716aefc353aee774bc3921eb29b">preprocess_bed</a> (const <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> &amp;topg, unsigned int Nx_in, unsigned int Ny_in)</td></tr>
<tr class="separator:addb17716aefc353aee774bc3921eb29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58ff28fd406efac160671b5067fcf2e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a58ff28fd406efac160671b5067fcf2e1.html#a58ff28fd406efac160671b5067fcf2e1">smooth_the_bed_on_proc0</a> ()</td></tr>
<tr class="memdesc:a58ff28fd406efac160671b5067fcf2e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the smoothed bed by a simple average over a rectangle of grid points.  <a href="classpism_1_1stressbalance_1_1BedSmoother_a58ff28fd406efac160671b5067fcf2e1.html#a58ff28fd406efac160671b5067fcf2e1">More...</a><br /></td></tr>
<tr class="separator:a58ff28fd406efac160671b5067fcf2e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84c1adc9a37d8099c419c21d14e045d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a84c1adc9a37d8099c419c21d14e045d9.html#a84c1adc9a37d8099c419c21d14e045d9">compute_coefficients_on_proc0</a> ()</td></tr>
<tr class="separator:a84c1adc9a37d8099c419c21d14e045d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ad95e0c783c9d8318bb7eecf09284d1eb"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; const <a class="el" href="classpism_1_1Grid.html">Grid</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ad95e0c783c9d8318bb7eecf09284d1eb.html#ad95e0c783c9d8318bb7eecf09284d1eb">m_grid</a></td></tr>
<tr class="separator:ad95e0c783c9d8318bb7eecf09284d1eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72b3eb0e614bc7111e99f39e66d0187"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1Config_a4dc1634c0eac358eb86303633024f810.html#a4dc1634c0eac358eb86303633024f810">Config::ConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_aa72b3eb0e614bc7111e99f39e66d0187.html#aa72b3eb0e614bc7111e99f39e66d0187">m_config</a></td></tr>
<tr class="separator:aa72b3eb0e614bc7111e99f39e66d0187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c86442bfdbbc2a4ba9e2f20407c4b55"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1array_1_1Scalar2.html">array::Scalar2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a4c86442bfdbbc2a4ba9e2f20407c4b55.html#a4c86442bfdbbc2a4ba9e2f20407c4b55">m_topgsmooth</a></td></tr>
<tr class="memdesc:a4c86442bfdbbc2a4ba9e2f20407c4b55"><td class="mdescLeft">&#160;</td><td class="mdescRight">smoothed bed elevation; set by calling <a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae13dd0bbf11b712bbef3eeaf93a8f527.html#ae13dd0bbf11b712bbef3eeaf93a8f527">preprocess_bed()</a>  <a href="classpism_1_1stressbalance_1_1BedSmoother_a4c86442bfdbbc2a4ba9e2f20407c4b55.html#a4c86442bfdbbc2a4ba9e2f20407c4b55">More...</a><br /></td></tr>
<tr class="separator:a4c86442bfdbbc2a4ba9e2f20407c4b55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b2336a229c4cd4b7e0b08edd7c716eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1array_1_1Scalar2.html">array::Scalar2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a7b2336a229c4cd4b7e0b08edd7c716eb.html#a7b2336a229c4cd4b7e0b08edd7c716eb">m_maxtl</a></td></tr>
<tr class="separator:a7b2336a229c4cd4b7e0b08edd7c716eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487e1e99477f270bc123982315713169"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1array_1_1Scalar2.html">array::Scalar2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a487e1e99477f270bc123982315713169.html#a487e1e99477f270bc123982315713169">m_C2</a></td></tr>
<tr class="separator:a487e1e99477f270bc123982315713169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae744391ca2db8b254d3b037da92cbbba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1array_1_1Scalar2.html">array::Scalar2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae744391ca2db8b254d3b037da92cbbba.html#ae744391ca2db8b254d3b037da92cbbba">m_C3</a></td></tr>
<tr class="separator:ae744391ca2db8b254d3b037da92cbbba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ed491372b68c6e6e8a50010b112b681"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1array_1_1Scalar2.html">array::Scalar2</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a1ed491372b68c6e6e8a50010b112b681.html#a1ed491372b68c6e6e8a50010b112b681">m_C4</a></td></tr>
<tr class="separator:a1ed491372b68c6e6e8a50010b112b681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0db8dcdf5af87a7feb0bdb472b71227"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae0db8dcdf5af87a7feb0bdb472b71227.html#ae0db8dcdf5af87a7feb0bdb472b71227">m_Nx</a></td></tr>
<tr class="separator:ae0db8dcdf5af87a7feb0bdb472b71227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2553d3b7d74feebc688a654cf3cef75e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a2553d3b7d74feebc688a654cf3cef75e.html#a2553d3b7d74feebc688a654cf3cef75e">m_Ny</a></td></tr>
<tr class="separator:a2553d3b7d74feebc688a654cf3cef75e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01b79ef0eb383f13aa8b62bb590d38c0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a01b79ef0eb383f13aa8b62bb590d38c0.html#a01b79ef0eb383f13aa8b62bb590d38c0">m_Glen_exponent</a></td></tr>
<tr class="separator:a01b79ef0eb383f13aa8b62bb590d38c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1da9b441304f82bf6fc8fb7c70c6a7a8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a1da9b441304f82bf6fc8fb7c70c6a7a8.html#a1da9b441304f82bf6fc8fb7c70c6a7a8">m_smoothing_range</a></td></tr>
<tr class="separator:a1da9b441304f82bf6fc8fb7c70c6a7a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d6ca6da2f6513d1a5115d6b5de8332"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a43d6ca6da2f6513d1a5115d6b5de8332.html#a43d6ca6da2f6513d1a5115d6b5de8332">m_topgp0</a></td></tr>
<tr class="memdesc:a43d6ca6da2f6513d1a5115d6b5de8332"><td class="mdescLeft">&#160;</td><td class="mdescRight">original bed elevation on processor 0  <a href="classpism_1_1stressbalance_1_1BedSmoother_a43d6ca6da2f6513d1a5115d6b5de8332.html#a43d6ca6da2f6513d1a5115d6b5de8332">More...</a><br /></td></tr>
<tr class="separator:a43d6ca6da2f6513d1a5115d6b5de8332"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1c917c55fc9b6fc0e3265ed1ee71202"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ab1c917c55fc9b6fc0e3265ed1ee71202.html#ab1c917c55fc9b6fc0e3265ed1ee71202">m_topgsmoothp0</a></td></tr>
<tr class="memdesc:ab1c917c55fc9b6fc0e3265ed1ee71202"><td class="mdescLeft">&#160;</td><td class="mdescRight">smoothed bed elevation on processor 0  <a href="classpism_1_1stressbalance_1_1BedSmoother_ab1c917c55fc9b6fc0e3265ed1ee71202.html#ab1c917c55fc9b6fc0e3265ed1ee71202">More...</a><br /></td></tr>
<tr class="separator:ab1c917c55fc9b6fc0e3265ed1ee71202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f727584546e4cef224c33484d1e41e2"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a4f727584546e4cef224c33484d1e41e2.html#a4f727584546e4cef224c33484d1e41e2">m_maxtlp0</a></td></tr>
<tr class="memdesc:a4f727584546e4cef224c33484d1e41e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">maximum elevation at (i,j) of local topography (nearby patch)  <a href="classpism_1_1stressbalance_1_1BedSmoother_a4f727584546e4cef224c33484d1e41e2.html#a4f727584546e4cef224c33484d1e41e2">More...</a><br /></td></tr>
<tr class="separator:a4f727584546e4cef224c33484d1e41e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af200deb02932da18adb78d12a908346f"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_af200deb02932da18adb78d12a908346f.html#af200deb02932da18adb78d12a908346f">m_C2p0</a></td></tr>
<tr class="separator:af200deb02932da18adb78d12a908346f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02fb4d8d2e000f58a4eabcc1d0bf1ccb"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_a02fb4d8d2e000f58a4eabcc1d0bf1ccb.html#a02fb4d8d2e000f58a4eabcc1d0bf1ccb">m_C3p0</a></td></tr>
<tr class="separator:a02fb4d8d2e000f58a4eabcc1d0bf1ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07977b6a5e8b8df9963203bca80553b"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classpism_1_1petsc_1_1Vec.html">petsc::Vec</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ad07977b6a5e8b8df9963203bca80553b.html#ad07977b6a5e8b8df9963203bca80553b">m_C4p0</a></td></tr>
<tr class="separator:ad07977b6a5e8b8df9963203bca80553b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003). </p>
<p>This class both smooths the bed and computes coefficients for an approximation to Schoof's \(\theta\). The factor \(0\le \theta \le 1\) multiplies the diffusivity in the theory of the effect of bed roughness in the SIA by Christian Schoof (2003; <em>The effect of basal topography on ice sheet dynamics</em>) [<a class="el" href="references.html#Schoofbasaltopg2003">Schoofbasaltopg2003</a>].</p>
<p>For additional information on this class see page bedrough.</p>
<p>The user of this class hands <a class="el" href="classpism_1_1stressbalance_1_1BedSmoother.html" title="PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003).">BedSmoother</a> an "original" topography, and it is preprocessed to fill the smoothed topography <code>topgsmooth</code>, and the coefficients in an approximation to \(\theta\). This is done by a call to <code><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae13dd0bbf11b712bbef3eeaf93a8f527.html#ae13dd0bbf11b712bbef3eeaf93a8f527">preprocess_bed()</a></code>. The call requires the half-width of the smoothing square (a distance in m), or the number of grid points in each direction in the smoothing rectangle, and the Glen exponent.</p>
<p>The call to <code><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae13dd0bbf11b712bbef3eeaf93a8f527.html#ae13dd0bbf11b712bbef3eeaf93a8f527">preprocess_bed()</a></code> <em>must be repeated</em> any time the "original" topography changes, for instance at the start of an <a class="el" href="classpism_1_1IceModel.html">IceModel</a> run, or at a bed deformation step in an <a class="el" href="classpism_1_1IceModel.html">IceModel</a> run.</p>
<p><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother.html" title="PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003).">BedSmoother</a> then provides three major functionalities, all of which <em>must</em> <em>follow</em> the call to <code><a class="el" href="classpism_1_1stressbalance_1_1BedSmoother_ae13dd0bbf11b712bbef3eeaf93a8f527.html#ae13dd0bbf11b712bbef3eeaf93a8f527">preprocess_bed()</a></code>:</p><ol type="1">
<li>User accesses public <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> <code>topgsmooth</code>, the smoothed bed itself.</li>
<li>User asks <code>get_smoothed_thk()</code> for gridded values of the consistent smoothed version of the ice thickness, which is the thickness corresponding to a given surface elevation and the pre-computed smoothed bed.</li>
<li>User asks for gridded values of \(\theta(h,x,y)\) using <code>get_theta()</code>.</li>
</ol>
<p>Here is a basic example of the creation and usage of a <a class="el" href="classpism_1_1stressbalance_1_1BedSmoother.html" title="PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003).">BedSmoother</a> instance. Note that <a class="el" href="classpism_1_1stressbalance_1_1BedSmoother.html" title="PISM bed smoother, plus bed roughness parameterization, based on Schoof (2003).">BedSmoother</a> will update ghosted values in <code>topgsmooth</code>, and other internal fields, and update them in the return fields <code>thksmooth</code>, <code>theta</code>, if asked. In IceModel::velocitySIAStaggered() </p><div class="fragment"><div class="line"><a class="code" href="classpism_1_1stressbalance_1_1BedSmoother_a32338d245c30dd4f2a3bb5218f59e3bc.html#a32338d245c30dd4f2a3bb5218f59e3bc">BedSmoother</a> smoother(grid, 2);</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestM_8c_ad5228cd48403ef9d8b632f5c7c124720.html#ad5228cd48403ef9d8b632f5c7c124720">n</a> = 3.0,</div>
<div class="line">lambda = 50.0e3;</div>
<div class="line">ierr = smoother.preprocess_bed(topg, <a class="code" href="exactTestM_8c_ad5228cd48403ef9d8b632f5c7c124720.html#ad5228cd48403ef9d8b632f5c7c124720">n</a>, lambda); CHKERRQ(ierr);</div>
<div class="line">ierr = smoother.get_smoothed_thk(usurf, thk, 1, &amp;thksmooth); CHKERRQ(ierr);</div>
<div class="line">ierr = smoother.get_theta(usurf, <a class="code" href="exactTestM_8c_ad5228cd48403ef9d8b632f5c7c124720.html#ad5228cd48403ef9d8b632f5c7c124720">n</a>, 1, &amp;<a class="code" href="classpism_1_1stressbalance_1_1BedSmoother_a71b068f8e7b3d3aa7235e6d1bec1f797.html#a71b068f8e7b3d3aa7235e6d1bec1f797">theta</a>); CHKERRQ(ierr);</div>
<div class="ttc" id="aclasspism_1_1stressbalance_1_1BedSmoother_a32338d245c30dd4f2a3bb5218f59e3bc_html_a32338d245c30dd4f2a3bb5218f59e3bc"><div class="ttname"><a href="classpism_1_1stressbalance_1_1BedSmoother_a32338d245c30dd4f2a3bb5218f59e3bc.html#a32338d245c30dd4f2a3bb5218f59e3bc">pism::stressbalance::BedSmoother::BedSmoother</a></div><div class="ttdeci">BedSmoother(std::shared_ptr&lt; const Grid &gt; g)</div><div class="ttdef"><b>Definition:</b> <a href="BedSmoother_8cc_source.html#l00034">BedSmoother.cc:34</a></div></div>
<div class="ttc" id="aclasspism_1_1stressbalance_1_1BedSmoother_a71b068f8e7b3d3aa7235e6d1bec1f797_html_a71b068f8e7b3d3aa7235e6d1bec1f797"><div class="ttname"><a href="classpism_1_1stressbalance_1_1BedSmoother_a71b068f8e7b3d3aa7235e6d1bec1f797.html#a71b068f8e7b3d3aa7235e6d1bec1f797">pism::stressbalance::BedSmoother::theta</a></div><div class="ttdeci">void theta(const array::Scalar &amp;usurf, array::Scalar &amp;result) const</div><div class="ttdef"><b>Definition:</b> <a href="BedSmoother_8cc_source.html#l00350">BedSmoother.cc:350</a></div></div>
<div class="ttc" id="aexactTestM_8c_ad5228cd48403ef9d8b632f5c7c124720_html_ad5228cd48403ef9d8b632f5c7c124720"><div class="ttname"><a href="exactTestM_8c_ad5228cd48403ef9d8b632f5c7c124720.html#ad5228cd48403ef9d8b632f5c7c124720">n</a></div><div class="ttdeci">#define n</div><div class="ttdef"><b>Definition:</b> <a href="exactTestM_8c_source.html#l00037">exactTestM.c:37</a></div></div>
</div><!-- fragment --><p> See <a class="el" href="classpism_1_1Grid.html" title="Describes the PISM grid and the distribution of data across processors.">Grid</a> documentation for initializing <code>grid</code>. Note we assume <code>topg</code>, <code>usurf</code>, <code>thk</code>, <code>thksmooth</code>, and <code>theta</code> are all created <a class="el" href="classpism_1_1array_1_1Scalar.html">array::Scalar</a> instances. </p>

<p class="definition">Definition at line <a class="el" href="BedSmoother_8hh_source.html#l00085">85</a> of file <a class="el" href="BedSmoother_8hh_source.html">BedSmoother.hh</a>.</p>
</div><hr/>The documentation for this class was generated from the following files:<ul>
<li>src/stressbalance/sia/<a class="el" href="BedSmoother_8hh_source.html">BedSmoother.hh</a></li>
<li>src/stressbalance/sia/<a class="el" href="BedSmoother_8cc_source.html">BedSmoother.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
