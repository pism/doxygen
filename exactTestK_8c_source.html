<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: src/verification/tests/exactTestK.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.0.5 committed by Constantine Khrulev on 2022-10-14 09:56:26 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_54b1e6c540d67b59af2f275fe685da39.html">verification</a></li><li class="navelem"><a class="el" href="dir_3fcd1ca60935cb00dc8bfe3f88c02537.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">exactTestK.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="exactTestK_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   Copyright (C) 2007, 2011, 2014, 2016 Ed Bueler</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   This file is part of PISM.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">   PISM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   terms of the GNU General Public License as published by the Free Software</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   Foundation; either version 3 of the License, or (at your option) any later</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   version.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">   PISM is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">   details.</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">   along with PISM; if not, write to the Free Software</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">   Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_errno.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_math.h&gt;</span>       <span class="comment">/* M_PI */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_roots.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="exactTestK_8h.html">exactTestK.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="exactTestK_8c_a7714df5f626688836ecd30d8e12190d5.html#a7714df5f626688836ecd30d8e12190d5">   28</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a7714df5f626688836ecd30d8e12190d5.html#a7714df5f626688836ecd30d8e12190d5">SperA</a> = 31556926.0; <span class="comment">/* seconds per year; 365.2422 days */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">   30</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a> = 2009.0;  <span class="comment">/* J/(kg K)  specific heat capacity of ice */</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">   31</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> = 910.0;   <span class="comment">/* kg/(m^3)  density of ice */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">   32</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>   = 2.10;    <span class="comment">/* J/(m K s) = W/(m K)  thermal conductivity of ice */</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="exactTestK_8c_aebd590b31658d7d68feb56371017aa1b.html#aebd590b31658d7d68feb56371017aa1b">   33</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_aebd590b31658d7d68feb56371017aa1b.html#aebd590b31658d7d68feb56371017aa1b">c_p_BR</a>  = 1000.0;  <span class="comment">/* J/(kg K)  specific heat capacity of bedrock */</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="exactTestK_8c_af137795422e747a1950da7775a50ff47.html#af137795422e747a1950da7775a50ff47">   34</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_af137795422e747a1950da7775a50ff47.html#af137795422e747a1950da7775a50ff47">rho_BR</a>  = 3300.0;  <span class="comment">/* kg/(m^3)  density of bedrock */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">   35</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">k_BR</a>    = 3.0;     <span class="comment">/* J/(m K s) = W/(m K)  thermal conductivity of bedrock */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">   37</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a>  = 3000.0;      <span class="comment">/* m */</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">   38</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>  = 1000.0;      <span class="comment">/* m */</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="exactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9.html#aec9c2ecc66cdfa877ef315970c8227f9">   39</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9.html#aec9c2ecc66cdfa877ef315970c8227f9">Ts</a>  = 223.15;      <span class="comment">/* K */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">   40</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a>   = 0.042;       <span class="comment">/* W/(m^2) */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="exactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd.html#afd45a0ee96a799aec6589e2eb8ce66cd">   41</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd.html#afd45a0ee96a799aec6589e2eb8ce66cd">phi</a> = 0.0125;      <span class="comment">/* K/m */</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/* number of terms in eigenfunction expansion; the exact</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">   solution is deliberately chosen to have finite expansion */</span></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="exactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417.html#a2bd0f679141b378fdebe2f9dd3cdb417">   45</a></span>&#160;<span class="preprocessor">#define Nsum 30</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="exactTestK_8c_a9a6b74f1b23711acfa5838dff89bdfe9.html#a9a6b74f1b23711acfa5838dff89bdfe9">   47</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="exactTestK_8c_a73d0f7d71d6a113900508bfebf387dc6.html#a73d0f7d71d6a113900508bfebf387dc6">exactK_old</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> *TT, <span class="keywordtype">double</span> *FF, <span class="keyword">const</span> <span class="keywordtype">int</span> bedrockIsIce_p) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span> belowB0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">double</span> ZZ, alpha, lambda, beta, my_gamma, XkSQR, Xk,</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;         theta, dthetakdz, P, dPdz,</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;         Ck, I1, I2, aH, bB, mI, mR;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">double</span> c_p_bedrock, rho_bedrock, k_bedrock;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">/* following constants were produced by calling print_alpha_k(30) (below) */</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">double</span> alf[<a class="code" href="exactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417.html#a2bd0f679141b378fdebe2f9dd3cdb417">Nsum</a>] = {3.350087528822397e-04, 1.114576827617396e-03, 1.953590840303518e-03,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                      2.684088585781064e-03, 3.371114869333445e-03, 4.189442265117592e-03,</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                      5.008367405382524e-03, 5.696044031764593e-03, 6.425563506942886e-03,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                      7.264372872913219e-03, 8.044853066396166e-03, 8.714877612414516e-03,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                      9.493529164160654e-03, 1.033273985210279e-02, 1.106421822502108e-02,</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                      1.175060460132703e-02, 1.256832682090360e-02, 1.338784224692084e-02,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                      1.407617951778051e-02, 1.480472324161026e-02, 1.564331999062109e-02,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                      1.642470780103220e-02, 1.709475346624607e-02, 1.787248418996684e-02,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                      1.871188358061674e-02, 1.944434477688470e-02, 2.013010181370026e-02,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                      2.094721145334310e-02, 2.176730968036079e-02, 2.245631776169424e-02};</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (bedrockIsIce_p) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    c_p_bedrock = <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    rho_bedrock = <a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    k_bedrock   = <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; <a class="code" href="exactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417.html#a2bd0f679141b378fdebe2f9dd3cdb417">Nsum</a>; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>++) { <span class="comment">/* overwrite alpha_k with ice-meets-ice values; see preprint */</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      alf[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>] = (2.0 * <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> + 1.0) * M_PI / (2.0 * (<a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> + <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>));</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    c_p_bedrock = <a class="code" href="exactTestK_8c_aebd590b31658d7d68feb56371017aa1b.html#aebd590b31658d7d68feb56371017aa1b">c_p_BR</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    rho_bedrock = <a class="code" href="exactTestK_8c_af137795422e747a1950da7775a50ff47.html#af137795422e747a1950da7775a50ff47">rho_BR</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    k_bedrock   = <a class="code" href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">k_BR</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">if</span> (z &gt; <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a>) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    *TT = <a class="code" href="exactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9.html#aec9c2ecc66cdfa877ef315970c8227f9">Ts</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  belowB0 = (z &lt; -<a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  ZZ = sqrt((rho_bedrock * c_p_bedrock * <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>) / (<a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> * <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a> * k_bedrock));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  mI = (<a class="code" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a> / <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>) - <a class="code" href="exactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd.html#afd45a0ee96a799aec6589e2eb8ce66cd">phi</a>;     mR = (<a class="code" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a> / k_bedrock) - <a class="code" href="exactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd.html#afd45a0ee96a799aec6589e2eb8ce66cd">phi</a>;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">/* DEBUG: printf(&quot;ZZ = %10e, mI = %10e, mR = %10e\n&quot;, ZZ,mI,mR); */</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  *TT = 0.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  *FF = 0.0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = <a class="code" href="exactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417.html#a2bd0f679141b378fdebe2f9dd3cdb417">Nsum</a>-1; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &gt;= 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>--) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">/* constants only having to do with eigenfunctions; theta = theta_k(z) is the</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">       normalized eigenfunction */</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    alpha = alf[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>];</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    beta = ZZ * alpha;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    my_gamma = sin(alpha * <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a>) / cos(beta * <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    XkSQR = (rho_bedrock * c_p_bedrock * my_gamma * my_gamma * <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a> + <a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> * <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a> * <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a>) / 2.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    Xk = sqrt(XkSQR);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">/* theta = ((z &gt; 0) ? sin(alpha * (H0 - z)) : my_gamma * cos(beta * (B0 + z))) / Xk; */</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    theta = (z &gt; 0) ? sin(alpha * (<a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> - z))</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    : my_gamma * cos(beta * (<a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a> + z));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    theta /= Xk;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    dthetakdz = (z &gt; 0) ? - alpha * cos(alpha * (<a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> - z))</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        : - beta * my_gamma * sin(beta * (<a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a> + z));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    dthetakdz /= Xk;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    lambda = (<a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a> * alpha * alpha) / (<a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> * <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">/* DEBUG: printf(&quot;k = %3d:  alpha = %10e, Xk = %10e, theta = %10e, dthetakdz = %10e, lambda = %10e,\n&quot;,</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">           k,alpha,Xk,theta,dthetakdz,lambda); */</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">/* constants involved in computing the expansion coefficients */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    aH = alpha * <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a>;            bB = beta * <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    I1 = - mI * (sin(aH) - aH * cos(aH)) / (alpha * alpha);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    I2 = mR * (cos(bB) - 1.0 + bB * sin(bB)) / (beta * beta)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;         - (<a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a> * mR + <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> * mI) * sin(bB) / beta;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    Ck = (<a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> * <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a> * I1 + rho_bedrock * c_p_bedrock * my_gamma * I2) / Xk;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">/* add the term to the expansion */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    *TT += Ck * exp(- lambda * t) * theta;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    *FF += - ((z &gt; 0) ? <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a> : k_bedrock) * Ck * exp(- lambda * t) * dthetakdz;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">/* DEBUG: printf(&quot;          I1 = %10e, I2 = %10e, Ck = %10e, term = %10f\n&quot;,</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">           I1,I2,Ck, Ck * exp(- lambda * t) * theta); */</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">/* P = (z &gt;= 0) ? (z / k_ice) - (H0 / k_ice) : (z / k_bedrock) - (H0 / k_ice); */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  P = (z / ((z &gt; 0) ? <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a> : k_bedrock)) - (<a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> / <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  dPdz = 1.0 / ((z &gt; 0) ? <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a> : k_bedrock);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  *TT += <a class="code" href="exactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9.html#aec9c2ecc66cdfa877ef315970c8227f9">Ts</a> - <a class="code" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a> * P;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  *FF += ((z &gt; 0) ? <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a> : k_bedrock) * <a class="code" href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a> * dPdz;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">return</span> belowB0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="keyword">struct </span><a class="code" href="structTestKParameters.html">TestKParameters</a> <a class="code" href="exactTestK_8c_a9a6b74f1b23711acfa5838dff89bdfe9.html#a9a6b74f1b23711acfa5838dff89bdfe9">exactK</a>(double t, double z, int bedrock_is_ice) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keyword">struct </span><a class="code" href="structTestKParameters.html">TestKParameters</a> result;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  result.<a class="code" href="structTestKParameters_a8c0a5d078a9173978c25b3e4f2e06d2b.html#a8c0a5d078a9173978c25b3e4f2e06d2b">error_code</a> = <a class="code" href="exactTestK_8c_a73d0f7d71d6a113900508bfebf387dc6.html#a73d0f7d71d6a113900508bfebf387dc6">exactK_old</a>(t, z, &amp;result.T, &amp;result.F, bedrock_is_ice);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="exactTestK_8c_a56808836b62f9906ef4665a173586329.html#a56808836b62f9906ef4665a173586329">  137</a></span>&#160;<span class="preprocessor">#define ALPHA_RELTOL   1.0e-14</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="exactTestK_8c_ac05f7ec86301861a8df2400546394818.html#ac05f7ec86301861a8df2400546394818">  138</a></span>&#160;<span class="preprocessor">#define ITER_MAXED_OUT 999</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">/* parameters needed for root problem: */</span></div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="structcoscross__params.html">  141</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structcoscross__params.html">coscross_params</a> {</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structcoscross__params_a47b99aabf0cd4294723f66a38849268e.html#a47b99aabf0cd4294723f66a38849268e">  142</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structcoscross__params_a47b99aabf0cd4294723f66a38849268e.html#a47b99aabf0cd4294723f66a38849268e">Afrac</a>, <a class="code" href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">HZBsum</a>, <a class="code" href="structcoscross__params_aa4365e8972132024f6fefff85ea866eb.html#aa4365e8972132024f6fefff85ea866eb">HZBdiff</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;};</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/* the root problem is to make this function zero: */</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="exactTestK_8c_ac6fcbc96916f0cc3143f10cee17b6ff0.html#ac6fcbc96916f0cc3143f10cee17b6ff0">  146</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="exactTestK_8c_ac6fcbc96916f0cc3143f10cee17b6ff0.html#ac6fcbc96916f0cc3143f10cee17b6ff0">coscross</a>(<span class="keywordtype">double</span> alpha, <span class="keywordtype">void</span> *params) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcoscross__params.html">coscross_params</a> *p = (<span class="keyword">struct </span><a class="code" href="structcoscross__params.html">coscross_params</a> *) params;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">return</span> cos(p-&gt;<a class="code" href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">HZBsum</a> * alpha) - p-&gt;<a class="code" href="structcoscross__params_a47b99aabf0cd4294723f66a38849268e.html#a47b99aabf0cd4294723f66a38849268e">Afrac</a> * cos(p-&gt;<a class="code" href="structcoscross__params_aa4365e8972132024f6fefff85ea866eb.html#aa4365e8972132024f6fefff85ea866eb">HZBdiff</a> * alpha);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">/* compute the first N roots alpha_k of the equation</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     ((A-1)/(A+1)) cos((H - Z B) alpha) = cos((H + Z B) alpha)</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">where H and B are heights and A, Z are defined in terms of material</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">constants */</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="exactTestK_8c_ae807629be1d2d0967d22615a064c8cb4.html#ae807629be1d2d0967d22615a064c8cb4">  155</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="exactTestK_8c_ae807629be1d2d0967d22615a064c8cb4.html#ae807629be1d2d0967d22615a064c8cb4">print_alpha_k</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> N) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordtype">int</span> status = 0, iter = 0, <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0, max_iter = 200;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">double</span> Z = 0.0, A = 0.0;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">double</span> alpha = 0.0, alpha_lo = 0.0, alpha_hi = 0.0, temp_lo = 0.0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keyword">const</span> gsl_root_fsolver_type *solvT;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  gsl_root_fsolver *solv;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  gsl_function <a class="code" href="namespacepism_a200b1c89a64c718f6b0f585508e55172.html#a200b1c89a64c718f6b0f585508e55172">F</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keyword">struct </span><a class="code" href="structcoscross__params.html">coscross_params</a> params;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  Z = sqrt((<a class="code" href="exactTestK_8c_af137795422e747a1950da7775a50ff47.html#af137795422e747a1950da7775a50ff47">rho_BR</a> * <a class="code" href="exactTestK_8c_aebd590b31658d7d68feb56371017aa1b.html#aebd590b31658d7d68feb56371017aa1b">c_p_BR</a> * <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>) / (<a class="code" href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a> * <a class="code" href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a> * <a class="code" href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">k_BR</a>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  A = (<a class="code" href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">k_BR</a> / <a class="code" href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a>) * Z;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  params.<a class="code" href="structcoscross__params_a47b99aabf0cd4294723f66a38849268e.html#a47b99aabf0cd4294723f66a38849268e">Afrac</a>   = (A - 1.0) / (A + 1.0);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  params.<a class="code" href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">HZBsum</a>  = <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> + Z * <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  params.<a class="code" href="structcoscross__params_aa4365e8972132024f6fefff85ea866eb.html#aa4365e8972132024f6fefff85ea866eb">HZBdiff</a> = <a class="code" href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a> - Z * <a class="code" href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="namespacepism_a200b1c89a64c718f6b0f585508e55172.html#a200b1c89a64c718f6b0f585508e55172">F</a>.function = &amp;<a class="code" href="exactTestK_8c_ac6fcbc96916f0cc3143f10cee17b6ff0.html#ac6fcbc96916f0cc3143f10cee17b6ff0">coscross</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="namespacepism_a200b1c89a64c718f6b0f585508e55172.html#a200b1c89a64c718f6b0f585508e55172">F</a>.params   = &amp;params;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  solvT      = gsl_root_fsolver_brent; <span class="comment">/* faster than bisection but still bracketing */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  solv       = gsl_root_fsolver_alloc(solvT);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> = 0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> &lt; N; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>++) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">/* these numbers bracket exactly one solution */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    alpha_lo = ((double)(<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>) * M_PI) / params.<a class="code" href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">HZBsum</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    alpha_hi = ((<span class="keywordtype">double</span>)(<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a> + 1) * M_PI) / params.<a class="code" href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">HZBsum</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    gsl_root_fsolver_set(solv, &amp;<a class="code" href="namespacepism_a200b1c89a64c718f6b0f585508e55172.html#a200b1c89a64c718f6b0f585508e55172">F</a>, alpha_lo, alpha_hi);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    iter = 0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      iter++;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      status = gsl_root_fsolver_iterate(solv);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keywordflow">if</span> (status != GSL_SUCCESS) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      alpha    = gsl_root_fsolver_root(solv);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      alpha_lo = gsl_root_fsolver_x_lower(solv);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      alpha_hi = gsl_root_fsolver_x_upper(solv);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      temp_lo  = (alpha_lo &gt; 0) ? alpha_lo : (alpha_hi/2.0);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      status = gsl_root_test_interval(temp_lo, alpha_hi, 0, <a class="code" href="exactTestK_8c_a56808836b62f9906ef4665a173586329.html#a56808836b62f9906ef4665a173586329">ALPHA_RELTOL</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    } <span class="keywordflow">while</span> ((status == GSL_CONTINUE) &amp;&amp; (iter &lt; max_iter));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">if</span> (iter &gt;= max_iter) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <a class="code" href="namespacepism_a5d5d5714fb63a96518ffbe7be151e90b.html#a5d5d5714fb63a96518ffbe7be151e90b">printf</a>(<span class="stringliteral">&quot;!!!ERROR: root finding iteration reached maximum iterations; QUITTING!\n&quot;</span>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="namespacepism_a5d5d5714fb63a96518ffbe7be151e90b.html#a5d5d5714fb63a96518ffbe7be151e90b">printf</a>(<span class="stringliteral">&quot;%19.15e,\n&quot;</span>,alpha);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; cleanup:</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  gsl_root_fsolver_free(solv);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">return</span> status;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
<div class="ttc" id="aexactTestK_8c_a15ab13858591a7858b9da91446c609d1_html_a15ab13858591a7858b9da91446c609d1"><div class="ttname"><a href="exactTestK_8c_a15ab13858591a7858b9da91446c609d1.html#a15ab13858591a7858b9da91446c609d1">k_ice</a></div><div class="ttdeci">const double k_ice</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00032">exactTestK.c:32</a></div></div>
<div class="ttc" id="aexactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c_html_a16cd714cec1ab4c7a60c61a47367272c"><div class="ttname"><a href="exactTestK_8c_a16cd714cec1ab4c7a60c61a47367272c.html#a16cd714cec1ab4c7a60c61a47367272c">B0</a></div><div class="ttdeci">const double B0</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00038">exactTestK.c:38</a></div></div>
<div class="ttc" id="aexactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417_html_a2bd0f679141b378fdebe2f9dd3cdb417"><div class="ttname"><a href="exactTestK_8c_a2bd0f679141b378fdebe2f9dd3cdb417.html#a2bd0f679141b378fdebe2f9dd3cdb417">Nsum</a></div><div class="ttdeci">#define Nsum</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00045">exactTestK.c:45</a></div></div>
<div class="ttc" id="aexactTestK_8c_a53fa0fd820021086cbb176f978985cf3_html_a53fa0fd820021086cbb176f978985cf3"><div class="ttname"><a href="exactTestK_8c_a53fa0fd820021086cbb176f978985cf3.html#a53fa0fd820021086cbb176f978985cf3">c_p_ice</a></div><div class="ttdeci">const double c_p_ice</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00030">exactTestK.c:30</a></div></div>
<div class="ttc" id="aexactTestK_8c_a56808836b62f9906ef4665a173586329_html_a56808836b62f9906ef4665a173586329"><div class="ttname"><a href="exactTestK_8c_a56808836b62f9906ef4665a173586329.html#a56808836b62f9906ef4665a173586329">ALPHA_RELTOL</a></div><div class="ttdeci">#define ALPHA_RELTOL</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00137">exactTestK.c:137</a></div></div>
<div class="ttc" id="aexactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9_html_a5d3f3ddea854a779a2666a3a8de400b9"><div class="ttname"><a href="exactTestK_8c_a5d3f3ddea854a779a2666a3a8de400b9.html#a5d3f3ddea854a779a2666a3a8de400b9">H0</a></div><div class="ttdeci">const double H0</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00037">exactTestK.c:37</a></div></div>
<div class="ttc" id="aexactTestK_8c_a73d0f7d71d6a113900508bfebf387dc6_html_a73d0f7d71d6a113900508bfebf387dc6"><div class="ttname"><a href="exactTestK_8c_a73d0f7d71d6a113900508bfebf387dc6.html#a73d0f7d71d6a113900508bfebf387dc6">exactK_old</a></div><div class="ttdeci">static int exactK_old(const double t, const double z, double *TT, double *FF, const int bedrockIsIce_p)</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00047">exactTestK.c:47</a></div></div>
<div class="ttc" id="aexactTestK_8c_a7714df5f626688836ecd30d8e12190d5_html_a7714df5f626688836ecd30d8e12190d5"><div class="ttname"><a href="exactTestK_8c_a7714df5f626688836ecd30d8e12190d5.html#a7714df5f626688836ecd30d8e12190d5">SperA</a></div><div class="ttdeci">const double SperA</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00028">exactTestK.c:28</a></div></div>
<div class="ttc" id="aexactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c_html_a82480c06ebc43bb6591a92f1fe36566c"><div class="ttname"><a href="exactTestK_8c_a82480c06ebc43bb6591a92f1fe36566c.html#a82480c06ebc43bb6591a92f1fe36566c">rho_ice</a></div><div class="ttdeci">const double rho_ice</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00031">exactTestK.c:31</a></div></div>
<div class="ttc" id="aexactTestK_8c_a9a6b74f1b23711acfa5838dff89bdfe9_html_a9a6b74f1b23711acfa5838dff89bdfe9"><div class="ttname"><a href="exactTestK_8c_a9a6b74f1b23711acfa5838dff89bdfe9.html#a9a6b74f1b23711acfa5838dff89bdfe9">exactK</a></div><div class="ttdeci">struct TestKParameters exactK(double t, double z, int bedrock_is_ice)</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00047">exactTestK.c:129</a></div></div>
<div class="ttc" id="aexactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c_html_ab97e4616d23ed4c2961295010c1afc3c"><div class="ttname"><a href="exactTestK_8c_ab97e4616d23ed4c2961295010c1afc3c.html#ab97e4616d23ed4c2961295010c1afc3c">G</a></div><div class="ttdeci">const double G</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00040">exactTestK.c:40</a></div></div>
<div class="ttc" id="aexactTestK_8c_ac6fcbc96916f0cc3143f10cee17b6ff0_html_ac6fcbc96916f0cc3143f10cee17b6ff0"><div class="ttname"><a href="exactTestK_8c_ac6fcbc96916f0cc3143f10cee17b6ff0.html#ac6fcbc96916f0cc3143f10cee17b6ff0">coscross</a></div><div class="ttdeci">double coscross(double alpha, void *params)</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00146">exactTestK.c:146</a></div></div>
<div class="ttc" id="aexactTestK_8c_ae807629be1d2d0967d22615a064c8cb4_html_ae807629be1d2d0967d22615a064c8cb4"><div class="ttname"><a href="exactTestK_8c_ae807629be1d2d0967d22615a064c8cb4.html#ae807629be1d2d0967d22615a064c8cb4">print_alpha_k</a></div><div class="ttdeci">int print_alpha_k(const int N)</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00155">exactTestK.c:155</a></div></div>
<div class="ttc" id="aexactTestK_8c_aebd590b31658d7d68feb56371017aa1b_html_aebd590b31658d7d68feb56371017aa1b"><div class="ttname"><a href="exactTestK_8c_aebd590b31658d7d68feb56371017aa1b.html#aebd590b31658d7d68feb56371017aa1b">c_p_BR</a></div><div class="ttdeci">const double c_p_BR</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00033">exactTestK.c:33</a></div></div>
<div class="ttc" id="aexactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9_html_aec9c2ecc66cdfa877ef315970c8227f9"><div class="ttname"><a href="exactTestK_8c_aec9c2ecc66cdfa877ef315970c8227f9.html#aec9c2ecc66cdfa877ef315970c8227f9">Ts</a></div><div class="ttdeci">const double Ts</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00039">exactTestK.c:39</a></div></div>
<div class="ttc" id="aexactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8_html_aef865b9b807cb3a0419db3858f38bbc8"><div class="ttname"><a href="exactTestK_8c_aef865b9b807cb3a0419db3858f38bbc8.html#aef865b9b807cb3a0419db3858f38bbc8">k_BR</a></div><div class="ttdeci">const double k_BR</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00035">exactTestK.c:35</a></div></div>
<div class="ttc" id="aexactTestK_8c_af137795422e747a1950da7775a50ff47_html_af137795422e747a1950da7775a50ff47"><div class="ttname"><a href="exactTestK_8c_af137795422e747a1950da7775a50ff47.html#af137795422e747a1950da7775a50ff47">rho_BR</a></div><div class="ttdeci">const double rho_BR</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00034">exactTestK.c:34</a></div></div>
<div class="ttc" id="aexactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd_html_afd45a0ee96a799aec6589e2eb8ce66cd"><div class="ttname"><a href="exactTestK_8c_afd45a0ee96a799aec6589e2eb8ce66cd.html#afd45a0ee96a799aec6589e2eb8ce66cd">phi</a></div><div class="ttdeci">const double phi</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00041">exactTestK.c:41</a></div></div>
<div class="ttc" id="aexactTestK_8h_html"><div class="ttname"><a href="exactTestK_8h.html">exactTestK.h</a></div></div>
<div class="ttc" id="anamespacepism_a200b1c89a64c718f6b0f585508e55172_html_a200b1c89a64c718f6b0f585508e55172"><div class="ttname"><a href="namespacepism_a200b1c89a64c718f6b0f585508e55172.html#a200b1c89a64c718f6b0f585508e55172">pism::F</a></div><div class="ttdeci">static double F(double SL, double B, double H, double alpha)</div><div class="ttdef"><b>Definition:</b> <a href="grounded__cell__fraction_8cc_source.html#l00225">grounded_cell_fraction.cc:225</a></div></div>
<div class="ttc" id="anamespacepism_a5d5d5714fb63a96518ffbe7be151e90b_html_a5d5d5714fb63a96518ffbe7be151e90b"><div class="ttname"><a href="namespacepism_a5d5d5714fb63a96518ffbe7be151e90b.html#a5d5d5714fb63a96518ffbe7be151e90b">pism::printf</a></div><div class="ttdeci">std::string printf(const char *format,...)</div><div class="ttdef"><b>Definition:</b> <a href="pism__utilities_8cc_source.html#l00407">pism_utilities.cc:407</a></div></div>
<div class="ttc" id="anamespacepism_a7343afff8d353b59dbdec563bd896812_html_a7343afff8d353b59dbdec563bd896812"><div class="ttname"><a href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">pism::k</a></div><div class="ttdeci">static const double k</div><div class="ttdef"><b>Definition:</b> <a href="exactTestP_8cc_source.html#l00045">exactTestP.cc:45</a></div></div>
<div class="ttc" id="astructTestKParameters_a8c0a5d078a9173978c25b3e4f2e06d2b_html_a8c0a5d078a9173978c25b3e4f2e06d2b"><div class="ttname"><a href="structTestKParameters_a8c0a5d078a9173978c25b3e4f2e06d2b.html#a8c0a5d078a9173978c25b3e4f2e06d2b">TestKParameters::error_code</a></div><div class="ttdeci">int error_code</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8h_source.html#l00041">exactTestK.h:41</a></div></div>
<div class="ttc" id="astructTestKParameters_html"><div class="ttname"><a href="structTestKParameters.html">TestKParameters</a></div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8h_source.html#l00040">exactTestK.h:40</a></div></div>
<div class="ttc" id="astructcoscross__params_a08227665e07c076a970a8995cfbcb70b_html_a08227665e07c076a970a8995cfbcb70b"><div class="ttname"><a href="structcoscross__params_a08227665e07c076a970a8995cfbcb70b.html#a08227665e07c076a970a8995cfbcb70b">coscross_params::HZBsum</a></div><div class="ttdeci">double HZBsum</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00142">exactTestK.c:142</a></div></div>
<div class="ttc" id="astructcoscross__params_a47b99aabf0cd4294723f66a38849268e_html_a47b99aabf0cd4294723f66a38849268e"><div class="ttname"><a href="structcoscross__params_a47b99aabf0cd4294723f66a38849268e.html#a47b99aabf0cd4294723f66a38849268e">coscross_params::Afrac</a></div><div class="ttdeci">double Afrac</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00142">exactTestK.c:142</a></div></div>
<div class="ttc" id="astructcoscross__params_aa4365e8972132024f6fefff85ea866eb_html_aa4365e8972132024f6fefff85ea866eb"><div class="ttname"><a href="structcoscross__params_aa4365e8972132024f6fefff85ea866eb.html#aa4365e8972132024f6fefff85ea866eb">coscross_params::HZBdiff</a></div><div class="ttdeci">double HZBdiff</div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00142">exactTestK.c:142</a></div></div>
<div class="ttc" id="astructcoscross__params_html"><div class="ttname"><a href="structcoscross__params.html">coscross_params</a></div><div class="ttdef"><b>Definition:</b> <a href="exactTestK_8c_source.html#l00141">exactTestK.c:141</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
