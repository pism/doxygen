<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: pism::hydrology::Routing Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.0.4 committed by Constantine Khrulev on 2022-05-25 12:02:27 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepism.html">pism</a></li><li class="navelem"><a class="el" href="namespacepism_1_1hydrology.html">hydrology</a></li><li class="navelem"><a class="el" href="classpism_1_1hydrology_1_1Routing.html">Routing</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="classpism_1_1hydrology_1_1Routing-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pism::hydrology::Routing Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A subglacial hydrology model which assumes water pressure equals overburden pressure.  
 <a href="classpism_1_1hydrology_1_1Routing.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Routing_8hh_source.html">Routing.hh</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for pism::hydrology::Routing:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="classpism_1_1hydrology_1_1Routing__inherit__graph.svg" width="218" height="262"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9ae954fc9262f7cc8483f9ee973dc7d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a9ae954fc9262f7cc8483f9ee973dc7d8.html#a9ae954fc9262f7cc8483f9ee973dc7d8">Routing</a> (<a class="el" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a> <a class="el" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>)</td></tr>
<tr class="separator:a9ae954fc9262f7cc8483f9ee973dc7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f0eec87f03c926829728fdf7be20df5"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a6f0eec87f03c926829728fdf7be20df5.html#a6f0eec87f03c926829728fdf7be20df5">~Routing</a> ()=default</td></tr>
<tr class="separator:a6f0eec87f03c926829728fdf7be20df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59acd542868d5bf1ceecb5db73f36f7e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a59acd542868d5bf1ceecb5db73f36f7e.html#a59acd542868d5bf1ceecb5db73f36f7e">subglacial_water_pressure</a> () const</td></tr>
<tr class="separator:a59acd542868d5bf1ceecb5db73f36f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2568174d1d58352e8a938bc810acb9a"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ad2568174d1d58352e8a938bc810acb9a.html#ad2568174d1d58352e8a938bc810acb9a">velocity_staggered</a> () const</td></tr>
<tr class="separator:ad2568174d1d58352e8a938bc810acb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classpism_1_1hydrology_1_1Hydrology"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classpism_1_1hydrology_1_1Hydrology')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classpism_1_1hydrology_1_1Hydrology.html">pism::hydrology::Hydrology</a></td></tr>
<tr class="memitem:a27d3c16e8978e8a14e8fcb68313181f8 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a27d3c16e8978e8a14e8fcb68313181f8.html#a27d3c16e8978e8a14e8fcb68313181f8">Hydrology</a> (<a class="el" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a> <a class="el" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>)</td></tr>
<tr class="separator:a27d3c16e8978e8a14e8fcb68313181f8 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8717d303cd1469ac2299682487f41e7 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aa8717d303cd1469ac2299682487f41e7.html#aa8717d303cd1469ac2299682487f41e7">~Hydrology</a> ()=default</td></tr>
<tr class="separator:aa8717d303cd1469ac2299682487f41e7 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad32b65c2c2e3d8b530d0de0ac9de5a inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a0ad32b65c2c2e3d8b530d0de0ac9de5a.html#a0ad32b65c2c2e3d8b530d0de0ac9de5a">restart</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;input_file, int record)</td></tr>
<tr class="separator:a0ad32b65c2c2e3d8b530d0de0ac9de5a inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83b82a246125c1556da15b2f02047b9c inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a83b82a246125c1556da15b2f02047b9c.html#a83b82a246125c1556da15b2f02047b9c">bootstrap</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;input_file, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness)</td></tr>
<tr class="separator:a83b82a246125c1556da15b2f02047b9c inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed120ad0f705f9d51aad322f42bd01d0 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aed120ad0f705f9d51aad322f42bd01d0.html#aed120ad0f705f9d51aad322f42bd01d0">init</a> (const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W_till, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;P)</td></tr>
<tr class="separator:aed120ad0f705f9d51aad322f42bd01d0 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ff6d2f03546df9f1077b30cda6b7a94 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a7ff6d2f03546df9f1077b30cda6b7a94.html#a7ff6d2f03546df9f1077b30cda6b7a94">update</a> (double t, double dt, const <a class="el" href="classpism_1_1hydrology_1_1Inputs.html">Inputs</a> &amp;inputs)</td></tr>
<tr class="separator:a7ff6d2f03546df9f1077b30cda6b7a94 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afded3f07594c79239d4d46162da7c256 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_afded3f07594c79239d4d46162da7c256.html#afded3f07594c79239d4d46162da7c256">till_water_thickness</a> () const</td></tr>
<tr class="memdesc:afded3f07594c79239d4d46162da7c256 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the effective thickness of the water stored in till.  <a href="classpism_1_1hydrology_1_1Hydrology_afded3f07594c79239d4d46162da7c256.html#afded3f07594c79239d4d46162da7c256">More...</a><br /></td></tr>
<tr class="separator:afded3f07594c79239d4d46162da7c256 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad837b447bda34a8dfa6b96ce52c45aee inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_ad837b447bda34a8dfa6b96ce52c45aee.html#ad837b447bda34a8dfa6b96ce52c45aee">subglacial_water_thickness</a> () const</td></tr>
<tr class="memdesc:ad837b447bda34a8dfa6b96ce52c45aee inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the effective thickness of the transportable basal water layer.  <a href="classpism_1_1hydrology_1_1Hydrology_ad837b447bda34a8dfa6b96ce52c45aee.html#ad837b447bda34a8dfa6b96ce52c45aee">More...</a><br /></td></tr>
<tr class="separator:ad837b447bda34a8dfa6b96ce52c45aee inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc842e97f86f15fb30a6589b4152ec60 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_adc842e97f86f15fb30a6589b4152ec60.html#adc842e97f86f15fb30a6589b4152ec60">overburden_pressure</a> () const</td></tr>
<tr class="separator:adc842e97f86f15fb30a6589b4152ec60 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ff20c766c8b7a77f65359b8f33d2ca6 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a6ff20c766c8b7a77f65359b8f33d2ca6.html#a6ff20c766c8b7a77f65359b8f33d2ca6">surface_input_rate</a> () const</td></tr>
<tr class="separator:a6ff20c766c8b7a77f65359b8f33d2ca6 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4048fc324182216ff1fb20c5f4ad1e9c inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2V.html">IceModelVec2V</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a4048fc324182216ff1fb20c5f4ad1e9c.html#a4048fc324182216ff1fb20c5f4ad1e9c">flux</a> () const</td></tr>
<tr class="separator:a4048fc324182216ff1fb20c5f4ad1e9c inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a992d5301c2b2dd48d4858fe5d1454efb inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a992d5301c2b2dd48d4858fe5d1454efb.html#a992d5301c2b2dd48d4858fe5d1454efb">mass_change</a> () const</td></tr>
<tr class="separator:a992d5301c2b2dd48d4858fe5d1454efb inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13191a8a613ad5bf76b0b9afa2ae79f7 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a13191a8a613ad5bf76b0b9afa2ae79f7.html#a13191a8a613ad5bf76b0b9afa2ae79f7">mass_change_at_grounded_margin</a> () const</td></tr>
<tr class="separator:a13191a8a613ad5bf76b0b9afa2ae79f7 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4e35413175a604d113240eae934c73 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a4b4e35413175a604d113240eae934c73.html#a4b4e35413175a604d113240eae934c73">mass_change_at_grounding_line</a> () const</td></tr>
<tr class="separator:a4b4e35413175a604d113240eae934c73 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e076671f187ec127175da75014e8678 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a2e076671f187ec127175da75014e8678.html#a2e076671f187ec127175da75014e8678">mass_change_at_domain_boundary</a> () const</td></tr>
<tr class="separator:a2e076671f187ec127175da75014e8678 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a055ced4ed586cbffd5196d155ea45377 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a055ced4ed586cbffd5196d155ea45377.html#a055ced4ed586cbffd5196d155ea45377">mass_change_due_to_conservation_error</a> () const</td></tr>
<tr class="separator:a055ced4ed586cbffd5196d155ea45377 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91976e0a63c9711fbb767a5b23c2f761 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a91976e0a63c9711fbb767a5b23c2f761.html#a91976e0a63c9711fbb767a5b23c2f761">mass_change_due_to_input</a> () const</td></tr>
<tr class="separator:a91976e0a63c9711fbb767a5b23c2f761 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae94d7408874c6686cb29922bda106979 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_ae94d7408874c6686cb29922bda106979.html#ae94d7408874c6686cb29922bda106979">mass_change_due_to_lateral_flow</a> () const</td></tr>
<tr class="separator:ae94d7408874c6686cb29922bda106979 inherit pub_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classpism_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classpism_1_1Component')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classpism_1_1Component.html">pism::Component</a></td></tr>
<tr class="memitem:a3699cbfcfb4d226bc7cd40288b5d944c inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a3699cbfcfb4d226bc7cd40288b5d944c.html#a3699cbfcfb4d226bc7cd40288b5d944c">Component</a> (<a class="el" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a> <a class="el" href="namespacepism_a47d754ed3e959d5866b02a1b78b6a5b5.html#a47d754ed3e959d5866b02a1b78b6a5b5">g</a>)</td></tr>
<tr class="separator:a3699cbfcfb4d226bc7cd40288b5d944c inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b398f7b07b0e414bf14dff7bffff625 inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a6b398f7b07b0e414bf14dff7bffff625.html#a6b398f7b07b0e414bf14dff7bffff625">~Component</a> ()=default</td></tr>
<tr class="separator:a6b398f7b07b0e414bf14dff7bffff625 inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ff4daf2dc8b23ea64b1d635666bdf0 inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacepism_a6154a990ba873c6ca606d8a320c441ac.html#a6154a990ba873c6ca606d8a320c441ac">DiagnosticList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_ac0ff4daf2dc8b23ea64b1d635666bdf0.html#ac0ff4daf2dc8b23ea64b1d635666bdf0">diagnostics</a> () const</td></tr>
<tr class="separator:ac0ff4daf2dc8b23ea64b1d635666bdf0 inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a506566badbb914e76dbf9363993c3124 inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacepism_a5cca85a16d08e7581dbc0ce9e341956a.html#a5cca85a16d08e7581dbc0ce9e341956a">TSDiagnosticList</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a506566badbb914e76dbf9363993c3124.html#a506566badbb914e76dbf9363993c3124">ts_diagnostics</a> () const</td></tr>
<tr class="separator:a506566badbb914e76dbf9363993c3124 inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07d61924cb95e3fec65687585764c24b inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a07d61924cb95e3fec65687585764c24b.html#a07d61924cb95e3fec65687585764c24b">grid</a> () const</td></tr>
<tr class="separator:a07d61924cb95e3fec65687585764c24b inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa04040a5dca5f87fb4bc858ee32b7542 inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_aa04040a5dca5f87fb4bc858ee32b7542.html#aa04040a5dca5f87fb4bc858ee32b7542">define_model_state</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;output) const</td></tr>
<tr class="memdesc:aa04040a5dca5f87fb4bc858ee32b7542 inherit pub_methods_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define model state variables in an output file.  <a href="classpism_1_1Component_aa04040a5dca5f87fb4bc858ee32b7542.html#aa04040a5dca5f87fb4bc858ee32b7542">More...</a><br /></td></tr>
<tr class="separator:aa04040a5dca5f87fb4bc858ee32b7542 inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa68f5361c21f5a4fddf662c002e2554d inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_aa68f5361c21f5a4fddf662c002e2554d.html#aa68f5361c21f5a4fddf662c002e2554d">write_model_state</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;output) const</td></tr>
<tr class="memdesc:aa68f5361c21f5a4fddf662c002e2554d inherit pub_methods_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write model state variables to an output file.  <a href="classpism_1_1Component_aa68f5361c21f5a4fddf662c002e2554d.html#aa68f5361c21f5a4fddf662c002e2554d">More...</a><br /></td></tr>
<tr class="separator:aa68f5361c21f5a4fddf662c002e2554d inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4785e675db5a0f366bab5385668626 inherit pub_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1MaxTimestep.html">MaxTimestep</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_ada4785e675db5a0f366bab5385668626.html#ada4785e675db5a0f366bab5385668626">max_timestep</a> (double t) const</td></tr>
<tr class="memdesc:ada4785e675db5a0f366bab5385668626 inherit pub_methods_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reports the maximum time-step the model can take at time t.  <a href="classpism_1_1Component_ada4785e675db5a0f366bab5385668626.html#ada4785e675db5a0f366bab5385668626">More...</a><br /></td></tr>
<tr class="separator:ada4785e675db5a0f366bab5385668626 inherit pub_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aed523e76326be9509435064dd888b2da"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_aed523e76326be9509435064dd888b2da.html#aed523e76326be9509435064dd888b2da">restart_impl</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;input_file, int record)</td></tr>
<tr class="separator:aed523e76326be9509435064dd888b2da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7999439234c8e153e34b324c02f5630"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_aa7999439234c8e153e34b324c02f5630.html#aa7999439234c8e153e34b324c02f5630">bootstrap_impl</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;input_file, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness)</td></tr>
<tr class="separator:aa7999439234c8e153e34b324c02f5630"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a96033472072f47a01927668ce9d3e8"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a0a96033472072f47a01927668ce9d3e8.html#a0a96033472072f47a01927668ce9d3e8">init_impl</a> (const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W_till, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;P)</td></tr>
<tr class="separator:a0a96033472072f47a01927668ce9d3e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17c6af1723a28056d0bbe61d507f281"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_aa17c6af1723a28056d0bbe61d507f281.html#aa17c6af1723a28056d0bbe61d507f281">update_impl</a> (double t, double dt, const <a class="el" href="classpism_1_1hydrology_1_1Inputs.html">Inputs</a> &amp;inputs)</td></tr>
<tr class="memdesc:aa17c6af1723a28056d0bbe61d507f281"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the model state variables W and Wtill by applying the subglacial hydrology model equations.  <a href="classpism_1_1hydrology_1_1Routing_aa17c6af1723a28056d0bbe61d507f281.html#aa17c6af1723a28056d0bbe61d507f281">More...</a><br /></td></tr>
<tr class="separator:aa17c6af1723a28056d0bbe61d507f281"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a251a760926d8109298ee0f18c3eb3343"><td class="memItemLeft" align="right" valign="top">virtual std::map&lt; std::string, <a class="el" href="classpism_1_1Diagnostic_a94d5717226f2c89299c0c08168f01455.html#a94d5717226f2c89299c0c08168f01455">Diagnostic::Ptr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a251a760926d8109298ee0f18c3eb3343.html#a251a760926d8109298ee0f18c3eb3343">diagnostics_impl</a> () const</td></tr>
<tr class="separator:a251a760926d8109298ee0f18c3eb3343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad51262907b8845c57d28a6766681d090"><td class="memItemLeft" align="right" valign="top">virtual std::map&lt; std::string, <a class="el" href="classpism_1_1TSDiagnostic_ad642866114d7b384b86091ac2c5e2882.html#ad642866114d7b384b86091ac2c5e2882">TSDiagnostic::Ptr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ad51262907b8845c57d28a6766681d090.html#ad51262907b8845c57d28a6766681d090">ts_diagnostics_impl</a> () const</td></tr>
<tr class="separator:ad51262907b8845c57d28a6766681d090"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe97431ee2169b0f54a014b15e387225"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_abe97431ee2169b0f54a014b15e387225.html#abe97431ee2169b0f54a014b15e387225">define_model_state_impl</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;output) const</td></tr>
<tr class="memdesc:abe97431ee2169b0f54a014b15e387225"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default (empty implementation).  <a href="classpism_1_1hydrology_1_1Routing_abe97431ee2169b0f54a014b15e387225.html#abe97431ee2169b0f54a014b15e387225">More...</a><br /></td></tr>
<tr class="separator:abe97431ee2169b0f54a014b15e387225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3aa811b8a3a9904761ceb3a56b871fc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ad3aa811b8a3a9904761ceb3a56b871fc.html#ad3aa811b8a3a9904761ceb3a56b871fc">write_model_state_impl</a> (const <a class="el" href="classpism_1_1File.html">File</a> &amp;output) const</td></tr>
<tr class="memdesc:ad3aa811b8a3a9904761ceb3a56b871fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default (empty implementation).  <a href="classpism_1_1hydrology_1_1Routing_ad3aa811b8a3a9904761ceb3a56b871fc.html#ad3aa811b8a3a9904761ceb3a56b871fc">More...</a><br /></td></tr>
<tr class="separator:ad3aa811b8a3a9904761ceb3a56b871fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dd9ce133a4d8f7bfc5e7a5aa2f1e0f1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a2dd9ce133a4d8f7bfc5e7a5aa2f1e0f1.html#a2dd9ce133a4d8f7bfc5e7a5aa2f1e0f1">max_timestep_W_diff</a> (double KW_max) const</td></tr>
<tr class="separator:a2dd9ce133a4d8f7bfc5e7a5aa2f1e0f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453104db42d2153e8f1caaae5212e0e3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a453104db42d2153e8f1caaae5212e0e3.html#a453104db42d2153e8f1caaae5212e0e3">max_timestep_W_cfl</a> () const</td></tr>
<tr class="separator:a453104db42d2153e8f1caaae5212e0e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a006bf886f9f7c68c0bdac0b7198790e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a006bf886f9f7c68c0bdac0b7198790e6.html#a006bf886f9f7c68c0bdac0b7198790e6">water_thickness_staggered</a> (const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;mask, <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;result)</td></tr>
<tr class="memdesc:a006bf886f9f7c68c0bdac0b7198790e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Average the regular grid water thickness to values at the center of cell edges.  <a href="classpism_1_1hydrology_1_1Routing_a006bf886f9f7c68c0bdac0b7198790e6.html#a006bf886f9f7c68c0bdac0b7198790e6">More...</a><br /></td></tr>
<tr class="separator:a006bf886f9f7c68c0bdac0b7198790e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f3a9b8e749d282179cf346f6f531a4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a2f3a9b8e749d282179cf346f6f531a4f.html#a2f3a9b8e749d282179cf346f6f531a4f">compute_conductivity</a> (const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;P, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;bed, <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;result, double &amp;maxKW) const</td></tr>
<tr class="memdesc:a2f3a9b8e749d282179cf346f6f531a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the nonlinear conductivity at the center of cell edges.  <a href="classpism_1_1hydrology_1_1Routing_a2f3a9b8e749d282179cf346f6f531a4f.html#a2f3a9b8e749d282179cf346f6f531a4f">More...</a><br /></td></tr>
<tr class="separator:a2f3a9b8e749d282179cf346f6f531a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f4d5858ec8b8df0acf4e4a699dbefd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a95f4d5858ec8b8df0acf4e4a699dbefd.html#a95f4d5858ec8b8df0acf4e4a699dbefd">compute_velocity</a> (const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;P, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;bed, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;<a class="el" href="namespacepism_1_1hydrology_a43ff7180d2c0024aaf9da724f7b5ef14.html#a43ff7180d2c0024aaf9da724f7b5ef14">K</a>, const <a class="el" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> *no_model_mask, <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;result) const</td></tr>
<tr class="memdesc:a95f4d5858ec8b8df0acf4e4a699dbefd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the advection velocity V at the center of cell edges.  <a href="classpism_1_1hydrology_1_1Routing_a95f4d5858ec8b8df0acf4e4a699dbefd.html#a95f4d5858ec8b8df0acf4e4a699dbefd">More...</a><br /></td></tr>
<tr class="separator:a95f4d5858ec8b8df0acf4e4a699dbefd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab340f2a9580f03155573edf9ab82e0e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ab340f2a9580f03155573edf9ab82e0e2.html#ab340f2a9580f03155573edf9ab82e0e2">advective_fluxes</a> (const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;V, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;result) const</td></tr>
<tr class="memdesc:ab340f2a9580f03155573edf9ab82e0e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute Q = V W at edge-centers (staggered grid) by first-order upwinding.  <a href="classpism_1_1hydrology_1_1Routing_ab340f2a9580f03155573edf9ab82e0e2.html#ab340f2a9580f03155573edf9ab82e0e2">More...</a><br /></td></tr>
<tr class="separator:ab340f2a9580f03155573edf9ab82e0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fe276a6f43e1a3f2ad2c58b0fdff01c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a1fe276a6f43e1a3f2ad2c58b0fdff01c.html#a1fe276a6f43e1a3f2ad2c58b0fdff01c">W_change_due_to_flow</a> (double dt, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;Wstag, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;<a class="el" href="namespacepism_1_1hydrology_a43ff7180d2c0024aaf9da724f7b5ef14.html#a43ff7180d2c0024aaf9da724f7b5ef14">K</a>, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;Q, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;result)</td></tr>
<tr class="separator:a1fe276a6f43e1a3f2ad2c58b0fdff01c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab819e3e88698dd4e2555437b91701696"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ab819e3e88698dd4e2555437b91701696.html#ab819e3e88698dd4e2555437b91701696">update_W</a> (double dt, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;<a class="el" href="classpism_1_1hydrology_1_1Hydrology_a6ff20c766c8b7a77f65359b8f33d2ca6.html#a6ff20c766c8b7a77f65359b8f33d2ca6">surface_input_rate</a>, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;Wstag, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Wtill, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Wtill_new, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;<a class="el" href="namespacepism_1_1hydrology_a43ff7180d2c0024aaf9da724f7b5ef14.html#a43ff7180d2c0024aaf9da724f7b5ef14">K</a>, const <a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a> &amp;Q, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;W_new)</td></tr>
<tr class="memdesc:ab819e3e88698dd4e2555437b91701696"><td class="mdescLeft">&#160;</td><td class="mdescRight">The computation of Wnew, called by <a class="el" href="classpism_1_1hydrology_1_1Hydrology_a7ff6d2f03546df9f1077b30cda6b7a94.html#a7ff6d2f03546df9f1077b30cda6b7a94">update()</a>.  <a href="classpism_1_1hydrology_1_1Routing_ab819e3e88698dd4e2555437b91701696.html#ab819e3e88698dd4e2555437b91701696">More...</a><br /></td></tr>
<tr class="separator:ab819e3e88698dd4e2555437b91701696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0e355734aef587eb682edb7c86f4dfb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_af0e355734aef587eb682edb7c86f4dfb.html#af0e355734aef587eb682edb7c86f4dfb">update_Wtill</a> (double dt, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Wtill, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;<a class="el" href="classpism_1_1hydrology_1_1Hydrology_a6ff20c766c8b7a77f65359b8f33d2ca6.html#a6ff20c766c8b7a77f65359b8f33d2ca6">surface_input_rate</a>, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;Wtill_new)</td></tr>
<tr class="memdesc:af0e355734aef587eb682edb7c86f4dfb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The computation of Wtillnew, called by <a class="el" href="classpism_1_1hydrology_1_1Hydrology_a7ff6d2f03546df9f1077b30cda6b7a94.html#a7ff6d2f03546df9f1077b30cda6b7a94">update()</a>.  <a href="classpism_1_1hydrology_1_1Routing_af0e355734aef587eb682edb7c86f4dfb.html#af0e355734aef587eb682edb7c86f4dfb">More...</a><br /></td></tr>
<tr class="separator:af0e355734aef587eb682edb7c86f4dfb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classpism_1_1hydrology_1_1Hydrology"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classpism_1_1hydrology_1_1Hydrology')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classpism_1_1hydrology_1_1Hydrology.html">pism::hydrology::Hydrology</a></td></tr>
<tr class="memitem:ac6bec2ccbc1e6e3cce83fc6715f12012 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_ac6bec2ccbc1e6e3cce83fc6715f12012.html#ac6bec2ccbc1e6e3cce83fc6715f12012">compute_overburden_pressure</a> (const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;ice_thickness, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;result) const</td></tr>
<tr class="memdesc:ac6bec2ccbc1e6e3cce83fc6715f12012 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the overburden pressure from ice thickness.  <a href="classpism_1_1hydrology_1_1Hydrology_ac6bec2ccbc1e6e3cce83fc6715f12012.html#ac6bec2ccbc1e6e3cce83fc6715f12012">More...</a><br /></td></tr>
<tr class="separator:ac6bec2ccbc1e6e3cce83fc6715f12012 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a731fc92d068452b71169647d2df9ccfd inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a731fc92d068452b71169647d2df9ccfd.html#a731fc92d068452b71169647d2df9ccfd">compute_surface_input_rate</a> (const <a class="el" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;mask, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> *<a class="el" href="classpism_1_1hydrology_1_1Hydrology_a6ff20c766c8b7a77f65359b8f33d2ca6.html#a6ff20c766c8b7a77f65359b8f33d2ca6">surface_input_rate</a>, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;result)</td></tr>
<tr class="separator:a731fc92d068452b71169647d2df9ccfd inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6966196cedbc0f991ea2bb193e336b66 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a6966196cedbc0f991ea2bb193e336b66.html#a6966196cedbc0f991ea2bb193e336b66">compute_basal_melt_rate</a> (const <a class="el" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;mask, const <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;basal_melt_rate, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;result)</td></tr>
<tr class="separator:a6966196cedbc0f991ea2bb193e336b66 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fccc516819331d5386a47a3367fc53 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_af1fccc516819331d5386a47a3367fc53.html#af1fccc516819331d5386a47a3367fc53">enforce_bounds</a> (const <a class="el" href="classpism_1_1IceModelVec2CellType.html">IceModelVec2CellType</a> &amp;cell_type, const <a class="el" href="classpism_1_1IceModelVec2Int.html">IceModelVec2Int</a> *no_model_mask, double max_thickness, double ocean_water_thickness, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;water_thickness, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;grounded_margin_change, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;grounding_line_change, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;conservation_error_change, <a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a> &amp;no_model_mask_change)</td></tr>
<tr class="memdesc:af1fccc516819331d5386a47a3367fc53 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">Correct the new water thickness based on boundary requirements.  <a href="classpism_1_1hydrology_1_1Hydrology_af1fccc516819331d5386a47a3367fc53.html#af1fccc516819331d5386a47a3367fc53">More...</a><br /></td></tr>
<tr class="separator:af1fccc516819331d5386a47a3367fc53 inherit pro_methods_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classpism_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classpism_1_1Component')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classpism_1_1Component.html">pism::Component</a></td></tr>
<tr class="memitem:ad7f4a5833dcc590b6b86a3048925ac9a inherit pro_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classpism_1_1MaxTimestep.html">MaxTimestep</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_ad7f4a5833dcc590b6b86a3048925ac9a.html#ad7f4a5833dcc590b6b86a3048925ac9a">max_timestep_impl</a> (double t) const</td></tr>
<tr class="separator:ad7f4a5833dcc590b6b86a3048925ac9a inherit pro_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85da8daa4d3f6d265bc0d17dd8b3988f inherit pro_methods_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a85da8daa4d3f6d265bc0d17dd8b3988f.html#a85da8daa4d3f6d265bc0d17dd8b3988f">regrid</a> (const std::string &amp;module_name, <a class="el" href="classpism_1_1IceModelVec.html">IceModelVec</a> &amp;variable, <a class="el" href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7f">RegriddingFlag</a> flag=<a class="el" href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7fa40db21687f40497645ef1b899d9d5d95">NO_REGRID_WITHOUT_REGRID_VARS</a>)</td></tr>
<tr class="separator:a85da8daa4d3f6d265bc0d17dd8b3988f inherit pro_methods_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:acf16ce2e9c49b7ebd3d57242736e5e09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_acf16ce2e9c49b7ebd3d57242736e5e09.html#acf16ce2e9c49b7ebd3d57242736e5e09">m_Qstag</a></td></tr>
<tr class="separator:acf16ce2e9c49b7ebd3d57242736e5e09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2bd8ed804db13d0181bb64996d822cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ab2bd8ed804db13d0181bb64996d822cb.html#ab2bd8ed804db13d0181bb64996d822cb">m_Qstag_average</a></td></tr>
<tr class="separator:ab2bd8ed804db13d0181bb64996d822cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c374c74a4d58809d8dbef1331aa232"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a38c374c74a4d58809d8dbef1331aa232.html#a38c374c74a4d58809d8dbef1331aa232">m_Vstag</a></td></tr>
<tr class="separator:a38c374c74a4d58809d8dbef1331aa232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af697b4a50abeb6b24e1fcc362df09bbb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_af697b4a50abeb6b24e1fcc362df09bbb.html#af697b4a50abeb6b24e1fcc362df09bbb">m_Wstag</a></td></tr>
<tr class="separator:af697b4a50abeb6b24e1fcc362df09bbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81ebf2d62cd115d4c6b0484ab06cbb58"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2Stag.html">IceModelVec2Stag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a81ebf2d62cd115d4c6b0484ab06cbb58.html#a81ebf2d62cd115d4c6b0484ab06cbb58">m_Kstag</a></td></tr>
<tr class="separator:a81ebf2d62cd115d4c6b0484ab06cbb58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a075a0008eeeddc09b0bcb3df0a6a0ccb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a075a0008eeeddc09b0bcb3df0a6a0ccb.html#a075a0008eeeddc09b0bcb3df0a6a0ccb">m_Wnew</a></td></tr>
<tr class="separator:a075a0008eeeddc09b0bcb3df0a6a0ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482442dc74fdc5ca56884dce96042ee8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a482442dc74fdc5ca56884dce96042ee8.html#a482442dc74fdc5ca56884dce96042ee8">m_Wtillnew</a></td></tr>
<tr class="separator:a482442dc74fdc5ca56884dce96042ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42b88400f3f1a36b8c2384b8a042107d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a42b88400f3f1a36b8c2384b8a042107d.html#a42b88400f3f1a36b8c2384b8a042107d">m_R</a></td></tr>
<tr class="separator:a42b88400f3f1a36b8c2384b8a042107d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3059b4ef0b41e490436c63e7391137"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a8d3059b4ef0b41e490436c63e7391137.html#a8d3059b4ef0b41e490436c63e7391137">m_dx</a></td></tr>
<tr class="separator:a8d3059b4ef0b41e490436c63e7391137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ed9eb90059457106fcea783f59a0ef"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_ab7ed9eb90059457106fcea783f59a0ef.html#ab7ed9eb90059457106fcea783f59a0ef">m_dy</a></td></tr>
<tr class="separator:ab7ed9eb90059457106fcea783f59a0ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadc77c982fdd51a60ffdc05e55e3615a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_aadc77c982fdd51a60ffdc05e55e3615a.html#aadc77c982fdd51a60ffdc05e55e3615a">m_rg</a></td></tr>
<tr class="separator:aadc77c982fdd51a60ffdc05e55e3615a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fc4bbfb22eec656f204d0a091b3a8ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a7fc4bbfb22eec656f204d0a091b3a8ae.html#a7fc4bbfb22eec656f204d0a091b3a8ae">m_bottom_surface</a></td></tr>
<tr class="separator:a7fc4bbfb22eec656f204d0a091b3a8ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classpism_1_1hydrology_1_1Hydrology')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classpism_1_1hydrology_1_1Hydrology.html">pism::hydrology::Hydrology</a></td></tr>
<tr class="memitem:aa418abcdf7aecb7ccea178f4091cc907 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2V.html">IceModelVec2V</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aa418abcdf7aecb7ccea178f4091cc907.html#aa418abcdf7aecb7ccea178f4091cc907">m_Q</a></td></tr>
<tr class="separator:aa418abcdf7aecb7ccea178f4091cc907 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16d2c2ddafb328169d4a856fc9d0452 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aa16d2c2ddafb328169d4a856fc9d0452.html#aa16d2c2ddafb328169d4a856fc9d0452">m_Wtill</a></td></tr>
<tr class="memdesc:aa16d2c2ddafb328169d4a856fc9d0452 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">effective thickness of basal water stored in till  <a href="classpism_1_1hydrology_1_1Hydrology_aa16d2c2ddafb328169d4a856fc9d0452.html#aa16d2c2ddafb328169d4a856fc9d0452">More...</a><br /></td></tr>
<tr class="separator:aa16d2c2ddafb328169d4a856fc9d0452 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409dc5b945d5a691593b6ecd22483083 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a409dc5b945d5a691593b6ecd22483083.html#a409dc5b945d5a691593b6ecd22483083">m_W</a></td></tr>
<tr class="memdesc:a409dc5b945d5a691593b6ecd22483083 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">effective thickness of transportable basal water  <a href="classpism_1_1hydrology_1_1Hydrology_a409dc5b945d5a691593b6ecd22483083.html#a409dc5b945d5a691593b6ecd22483083">More...</a><br /></td></tr>
<tr class="separator:a409dc5b945d5a691593b6ecd22483083 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ecceed1e793a9b6dadc8cf9b48b0d3 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a91ecceed1e793a9b6dadc8cf9b48b0d3.html#a91ecceed1e793a9b6dadc8cf9b48b0d3">m_Pover</a></td></tr>
<tr class="memdesc:a91ecceed1e793a9b6dadc8cf9b48b0d3 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="mdescLeft">&#160;</td><td class="mdescRight">overburden pressure  <a href="classpism_1_1hydrology_1_1Hydrology_a91ecceed1e793a9b6dadc8cf9b48b0d3.html#a91ecceed1e793a9b6dadc8cf9b48b0d3">More...</a><br /></td></tr>
<tr class="separator:a91ecceed1e793a9b6dadc8cf9b48b0d3 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a311f8160101b98a059546e7f57d8d428 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a311f8160101b98a059546e7f57d8d428.html#a311f8160101b98a059546e7f57d8d428">m_surface_input_rate</a></td></tr>
<tr class="separator:a311f8160101b98a059546e7f57d8d428 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5104748e93c6b0b0a9c5f16c1da139 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a3a5104748e93c6b0b0a9c5f16c1da139.html#a3a5104748e93c6b0b0a9c5f16c1da139">m_basal_melt_rate</a></td></tr>
<tr class="separator:a3a5104748e93c6b0b0a9c5f16c1da139 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36dea0fa45c1b97d71aa96511d4d377b inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a36dea0fa45c1b97d71aa96511d4d377b.html#a36dea0fa45c1b97d71aa96511d4d377b">m_flow_change_incremental</a></td></tr>
<tr class="separator:a36dea0fa45c1b97d71aa96511d4d377b inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f437b1914fb9e843b58197f569f524 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aa4f437b1914fb9e843b58197f569f524.html#aa4f437b1914fb9e843b58197f569f524">m_conservation_error_change</a></td></tr>
<tr class="separator:aa4f437b1914fb9e843b58197f569f524 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7207a927e040caa82f0ff89924db186e inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a7207a927e040caa82f0ff89924db186e.html#a7207a927e040caa82f0ff89924db186e">m_grounded_margin_change</a></td></tr>
<tr class="separator:a7207a927e040caa82f0ff89924db186e inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2639e7e12cb0b5583e41377455ba0b1 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_aa2639e7e12cb0b5583e41377455ba0b1.html#aa2639e7e12cb0b5583e41377455ba0b1">m_grounding_line_change</a></td></tr>
<tr class="separator:aa2639e7e12cb0b5583e41377455ba0b1 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f60c57d3a2f1d10f62259ca160ebc21 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a2f60c57d3a2f1d10f62259ca160ebc21.html#a2f60c57d3a2f1d10f62259ca160ebc21">m_input_change</a></td></tr>
<tr class="separator:a2f60c57d3a2f1d10f62259ca160ebc21 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34335232e6ba2dcfadf2eeef2d4d5093 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a34335232e6ba2dcfadf2eeef2d4d5093.html#a34335232e6ba2dcfadf2eeef2d4d5093">m_no_model_mask_change</a></td></tr>
<tr class="separator:a34335232e6ba2dcfadf2eeef2d4d5093 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b9b6ecf74973440183ba81e69122a3 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a18b9b6ecf74973440183ba81e69122a3.html#a18b9b6ecf74973440183ba81e69122a3">m_total_change</a></td></tr>
<tr class="separator:a18b9b6ecf74973440183ba81e69122a3 inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14673702e2aa70c0456c775e6554263a inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpism_1_1IceModelVec2S.html">IceModelVec2S</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Hydrology_a14673702e2aa70c0456c775e6554263a.html#a14673702e2aa70c0456c775e6554263a">m_flow_change</a></td></tr>
<tr class="separator:a14673702e2aa70c0456c775e6554263a inherit pro_attribs_classpism_1_1hydrology_1_1Hydrology"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classpism_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classpism_1_1Component')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classpism_1_1Component.html">pism::Component</a></td></tr>
<tr class="memitem:ab55ef37caaaad9b22733942d54057141 inherit pro_attribs_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">m_grid</a></td></tr>
<tr class="memdesc:ab55ef37caaaad9b22733942d54057141 inherit pro_attribs_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">grid used by this component  <a href="classpism_1_1Component_ab55ef37caaaad9b22733942d54057141.html#ab55ef37caaaad9b22733942d54057141">More...</a><br /></td></tr>
<tr class="separator:ab55ef37caaaad9b22733942d54057141 inherit pro_attribs_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28f298fc2133baae8cebf9dedf3b4d84 inherit pro_attribs_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1Config_a4dc1634c0eac358eb86303633024f810.html#a4dc1634c0eac358eb86303633024f810">Config::ConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">m_config</a></td></tr>
<tr class="memdesc:a28f298fc2133baae8cebf9dedf3b4d84 inherit pro_attribs_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">configuration database used by this component  <a href="classpism_1_1Component_a28f298fc2133baae8cebf9dedf3b4d84.html#a28f298fc2133baae8cebf9dedf3b4d84">More...</a><br /></td></tr>
<tr class="separator:a28f298fc2133baae8cebf9dedf3b4d84 inherit pro_attribs_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08f6b5a8e759c471d1a003804a8160ad inherit pro_attribs_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1units_1_1System_afd20a5cddd2a92044ad97097c5474a67.html#afd20a5cddd2a92044ad97097c5474a67">units::System::Ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a08f6b5a8e759c471d1a003804a8160ad.html#a08f6b5a8e759c471d1a003804a8160ad">m_sys</a></td></tr>
<tr class="memdesc:a08f6b5a8e759c471d1a003804a8160ad inherit pro_attribs_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">unit system used by this component  <a href="classpism_1_1Component_a08f6b5a8e759c471d1a003804a8160ad.html#a08f6b5a8e759c471d1a003804a8160ad">More...</a><br /></td></tr>
<tr class="separator:a08f6b5a8e759c471d1a003804a8160ad inherit pro_attribs_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29575eba605feccf4403d6b4ff0954a4 inherit pro_attribs_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classpism_1_1Logger_a18135415c4090dc0f946beca43fdcc76.html#a18135415c4090dc0f946beca43fdcc76">Logger::ConstPtr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">m_log</a></td></tr>
<tr class="memdesc:a29575eba605feccf4403d6b4ff0954a4 inherit pro_attribs_classpism_1_1Component"><td class="mdescLeft">&#160;</td><td class="mdescRight">logger (for easy access)  <a href="classpism_1_1Component_a29575eba605feccf4403d6b4ff0954a4.html#a29575eba605feccf4403d6b4ff0954a4">More...</a><br /></td></tr>
<tr class="separator:a29575eba605feccf4403d6b4ff0954a4 inherit pro_attribs_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a1bcf5a2d125fc92ed08fcf063b258670"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1hydrology_1_1Routing_a1bcf5a2d125fc92ed08fcf063b258670.html#a1bcf5a2d125fc92ed08fcf063b258670">initialization_message</a> () const</td></tr>
<tr class="separator:a1bcf5a2d125fc92ed08fcf063b258670"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_types_classpism_1_1Component"><td colspan="2" onclick="javascript:toggleInherit('pro_types_classpism_1_1Component')"><img src="closed.png" alt="-"/>&#160;Protected Types inherited from <a class="el" href="classpism_1_1Component.html">pism::Component</a></td></tr>
<tr class="memitem:a48f8d0b81b7853d4e3fba0de79ec4a7f inherit pro_types_classpism_1_1Component"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7f">RegriddingFlag</a> { <a class="el" href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7fa27f687170795f16d7eb334423b0bc9de">REGRID_WITHOUT_REGRID_VARS</a>
, <a class="el" href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7fa40db21687f40497645ef1b899d9d5d95">NO_REGRID_WITHOUT_REGRID_VARS</a>
 }</td></tr>
<tr class="memdesc:a48f8d0b81b7853d4e3fba0de79ec4a7f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This flag determines whether a variable is read from the <code>-regrid_file</code> file even if it is not listed among variables in <code>-regrid_vars</code>.  <a href="classpism_1_1Component_a48f8d0b81b7853d4e3fba0de79ec4a7f.html#a48f8d0b81b7853d4e3fba0de79ec4a7f">More...</a><br /></td></tr>
<tr class="separator:a48f8d0b81b7853d4e3fba0de79ec4a7f inherit pro_types_classpism_1_1Component"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A subglacial hydrology model which assumes water pressure equals overburden pressure. </p>
<p>This PISM hydrology model has lateral motion of subglacial water and which conserves the water mass. Further documentation is in [BuelervanPeltDRAFT].</p>
<p>The water velocity is along the steepest descent route for the hydraulic potential. This potential is (mostly) a function of ice sheet geometry, because the water pressure is set to the overburden pressure, a simplified but well-established model [<a class="el" href="references.html#Shreve1972">Shreve1972</a>]. However, the water layer thickness is also a part of the hydraulic potential because it is actually the potential of the <em>top</em> of the water layer.</p>
<p>This (essential) model has been used for finding locations of subglacial lakes [<a class="el" href="references.html#Siegertetal2007">Siegertetal2007</a>, <a class="el" href="references.html#Livingstoneetal2013">Livingstoneetal2013</a>]. Subglacial lakes occur at local minima of the hydraulic potential. If water builds up significantly (e.g. thickness of 10s of meters or more) then in the model here the resulting lakes diffuse instead of becoming infinitely deep. Thus we avoid delta functions of water thickness at the minima of the hydraulic potential in this well-posed model.</p>
<p>This model should generally be tested using static ice geometry first.</p>
<p>The state space includes both the till water effective thickness \(W_{till}\), which is in <a class="el" href="classpism_1_1hydrology_1_1Hydrology.html" title="The PISM subglacial hydrology model interface.">Hydrology</a>, and the transportable water layer thickness \(W\).</p>
<p>For more complete modeling where the water pressure is determined by a physical model for the opening and closing of cavities, and where the state space includes a nontrivial pressure variable, see <a class="el" href="classpism_1_1hydrology_1_1Distributed.html" title="The PISM subglacial hydrology model for a distributed linked-cavity system.">hydrology::Distributed</a>.</p>
<p>There is an option <code>-hydrology_null_strip</code> <code>X</code> which produces a strip of <code>X</code> km around the edge of the computational domain. In that strip the water flow velocity is set to zero. The water amount is also reset to zero at the end of each time step in this strip (in an accounted way).</p>
<p>As noted this is the minimal model which has a lateral water flux. This flux is </p><p class="formulaDsp">
\[ \mathbf{q} = - K \nabla \psi = \mathbf{V} W - D \nabla W \]
</p>
<p> where \(\psi\) is the hydraulic potential </p><p class="formulaDsp">
\[ \psi = P + \rho_w g (b + W). \]
</p>
<p> The generalized conductivity \(K\) is nontrivial and it generally also depends on the water thickness: </p><p class="formulaDsp">
\[ K = k W^{\alpha-1} |\nabla (P+\rho_w g b)|^{\beta-2}. \]
</p>
<p>This model contains enough information (enough modeled fields) so that we can compute the wall melt generated by dissipating the gravitational potential energy in the moving, presumably turbulent, subglacial water. If we suppose that this heat is dissipated immediately as melt on the cavity/conduit walls then we get a formula for a wall melt contribution. (This is in addition to the <code>basal_melt_rate_grounded</code> field coming from conserving energy in the flowing ice.) See <a class="el" href="namespacepism_1_1hydrology_a2ff5c19885e763b8b10a22a6796e9eb4.html#a2ff5c19885e763b8b10a22a6796e9eb4" title="Compute the wall melt rate which comes from (turbulent) dissipation of flow energy.">wall_melt()</a>. At this time the wall melt is diagnostic only and does not add to the water amount W; such an addition is generally unstable. </p>

<p class="definition">Definition at line <a class="el" href="Routing_8hh_source.html#l00081">81</a> of file <a class="el" href="Routing_8hh_source.html">Routing.hh</a>.</p>
</div><hr/>The documentation for this class was generated from the following files:<ul>
<li>src/hydrology/<a class="el" href="Routing_8hh_source.html">Routing.hh</a></li>
<li>src/hydrology/<a class="el" href="Routing_8cc_source.html">Routing.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
