<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: src/util/fem/FEM.hh File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7878ad5ecbf2506f4125b9d34c97e45.html">util</a></li><li class="navelem"><a class="el" href="dir_afb44fef33f8c53b10b723a4af81b49e.html">fem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">FEM.hh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Classes for implementing the Finite Element Method on an IceGrid.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="DirichletData_8hh_source.html">DirichletData.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Element_8hh_source.html">Element.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ElementIterator_8hh_source.html">ElementIterator.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Quadrature_8hh_source.html">Quadrature.hh</a>&quot;</code><br />
</div>
<p><a href="FEM_8hh_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpism_1_1fem_1_1Germ.html">pism::fem::Germ</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct for gathering the value and derivative of a function at a point.  <a href="structpism_1_1fem_1_1Germ.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpism_1_1fem_1_1QuadPoint.html">pism::fem::QuadPoint</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacepism"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism.html">pism</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem.html">pism::fem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem_1_1linear"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1linear.html">pism::fem::linear</a></td></tr>
<tr class="memdesc:namespacepism_1_1fem_1_1linear"><td class="mdescLeft">&#160;</td><td class="mdescRight">1<a class="el" href="classD.html">D</a> (linear) elements <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem_1_1q0"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q0.html">pism::fem::q0</a></td></tr>
<tr class="memdesc:namespacepism_1_1fem_1_1q0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q0 element information. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem_1_1q1"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q1.html">pism::fem::q1</a></td></tr>
<tr class="memdesc:namespacepism_1_1fem_1_1q1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q1 element information. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem_1_1p1"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1p1.html">pism::fem::p1</a></td></tr>
<tr class="memdesc:namespacepism_1_1fem_1_1p1"><td class="mdescLeft">&#160;</td><td class="mdescRight">P1 element information. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacepism_1_1fem_1_1q13d"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d.html">pism::fem::q13d</a></td></tr>
<tr class="memdesc:namespacepism_1_1fem_1_1q13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q1 element information. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ac18e0822794daf89a2d3f3ba0cf11335"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335">pism::fem::ElementType</a> { <br />
&#160;&#160;<a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335a17eacea17ef0dcaaaea1148728154253">pism::fem::ELEMENT_Q</a> = -1
, <a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335a9df9f88b59512cc92bb2d740b9dccc79">pism::fem::ELEMENT_P0</a> = 0
, <a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335a465464f3ca3f863e3a62aa70fec7be6a">pism::fem::ELEMENT_P1</a> = 1
, <a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335a3d9527de038357ce389f1d321d6e6acb">pism::fem::ELEMENT_P2</a> = 2
, <br />
&#160;&#160;<a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335af2dbc56701988ea0fea3cc413405fd3f">pism::fem::ELEMENT_P3</a> = 3
, <a class="el" href="namespacepism_1_1fem_ac18e0822794daf89a2d3f3ba0cf11335.html#ac18e0822794daf89a2d3f3ba0cf11335a909b03268404ae56a97f091e62b6bbd8">pism::fem::ELEMENT_EXTERIOR</a>
<br />
 }</td></tr>
<tr class="separator:ac18e0822794daf89a2d3f3ba0cf11335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e6454a1dbc885581ebfe9a52f392b17"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17">pism::fem::q13d::ElementFace</a> { <br />
&#160;&#160;<a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17ada265250db7d123740ae112b17691e5e">pism::fem::q13d::FACE_LEFT</a> = 0
, <a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17a6416ba405f5bcf4d234eaca2897afb3d">pism::fem::q13d::FACE_RIGHT</a> = 1
, <a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17a29350ddc60e874bb628b3dae59890cac">pism::fem::q13d::FACE_FRONT</a> = 2
, <a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17ad9abd5268c82de90f1d5359a99ebf6ca">pism::fem::q13d::FACE_BACK</a> = 3
, <br />
&#160;&#160;<a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17aabe1774a433464482b52e7bc98006135">pism::fem::q13d::FACE_BOTTOM</a> = 4
, <a class="el" href="namespacepism_1_1fem_1_1q13d_a2e6454a1dbc885581ebfe9a52f392b17.html#a2e6454a1dbc885581ebfe9a52f392b17af9e3f1d3d04088a8ee9556cac9eb7eed">pism::fem::q13d::FACE_TOP</a> = 5
<br />
 }</td></tr>
<tr class="separator:a2e6454a1dbc885581ebfe9a52f392b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a652778253be65fd8cea9263d14523989"><td class="memItemLeft" align="right" valign="top">Germ&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1linear_a652778253be65fd8cea9263d14523989.html#a652778253be65fd8cea9263d14523989">pism::fem::linear::chi</a> (unsigned int k, const QuadPoint &amp;pt)</td></tr>
<tr class="memdesc:a652778253be65fd8cea9263d14523989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Linear basis functions on the interval [-1, -1].  <a href="namespacepism_1_1fem_1_1linear_a652778253be65fd8cea9263d14523989.html#a652778253be65fd8cea9263d14523989">More...</a><br /></td></tr>
<tr class="separator:a652778253be65fd8cea9263d14523989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a530d42a573a2cb17df31ae05f190fd49"><td class="memItemLeft" align="right" valign="top">Germ&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q0_a530d42a573a2cb17df31ae05f190fd49.html#a530d42a573a2cb17df31ae05f190fd49">pism::fem::q0::chi</a> (unsigned int k, const QuadPoint &amp;pt)</td></tr>
<tr class="separator:a530d42a573a2cb17df31ae05f190fd49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfa544887339b3bbb60accb406b6ce6f"><td class="memItemLeft" align="right" valign="top">Germ&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q1_adfa544887339b3bbb60accb406b6ce6f.html#adfa544887339b3bbb60accb406b6ce6f">pism::fem::q1::chi</a> (unsigned int k, const QuadPoint &amp;pt)</td></tr>
<tr class="memdesc:adfa544887339b3bbb60accb406b6ce6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q1 basis functions on the reference element with nodes (-1,-1), (1,-1), (1,1), (-1,1).  <a href="namespacepism_1_1fem_1_1q1_adfa544887339b3bbb60accb406b6ce6f.html#adfa544887339b3bbb60accb406b6ce6f">More...</a><br /></td></tr>
<tr class="separator:adfa544887339b3bbb60accb406b6ce6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac81e34235785b11bbe0c75df78e60f88"><td class="memItemLeft" align="right" valign="top">Germ&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1p1_ac81e34235785b11bbe0c75df78e60f88.html#ac81e34235785b11bbe0c75df78e60f88">pism::fem::p1::chi</a> (unsigned int k, const QuadPoint &amp;pt)</td></tr>
<tr class="memdesc:ac81e34235785b11bbe0c75df78e60f88"><td class="mdescLeft">&#160;</td><td class="mdescRight">P1 basis functions on the reference element with nodes (0,0), (1,0), (0,1).  <a href="namespacepism_1_1fem_1_1p1_ac81e34235785b11bbe0c75df78e60f88.html#ac81e34235785b11bbe0c75df78e60f88">More...</a><br /></td></tr>
<tr class="separator:ac81e34235785b11bbe0c75df78e60f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c69e98698083b05a597741ef3e71fa"><td class="memItemLeft" align="right" valign="top">ElementType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_ac8c69e98698083b05a597741ef3e71fa.html#ac8c69e98698083b05a597741ef3e71fa">pism::fem::element_type</a> (int node_type[q1::n_chi])</td></tr>
<tr class="separator:ac8c69e98698083b05a597741ef3e71fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e07c5c86778fd21bef53d1291bae117"><td class="memItemLeft" align="right" valign="top">Germ&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d_a1e07c5c86778fd21bef53d1291bae117.html#a1e07c5c86778fd21bef53d1291bae117">pism::fem::q13d::chi</a> (unsigned int k, const QuadPoint &amp;p)</td></tr>
<tr class="memdesc:a1e07c5c86778fd21bef53d1291bae117"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate a Q1 shape function and its derivatives with respect to xi and eta.  <a href="namespacepism_1_1fem_1_1q13d_a1e07c5c86778fd21bef53d1291bae117.html#a1e07c5c86778fd21bef53d1291bae117">More...</a><br /></td></tr>
<tr class="separator:a1e07c5c86778fd21bef53d1291bae117"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1067ebced8fd7d22495d6b2affda2035"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_a1067ebced8fd7d22495d6b2affda2035.html#a1067ebced8fd7d22495d6b2affda2035">pism::fem::MAX_QUADRATURE_SIZE</a> = 9</td></tr>
<tr class="separator:a1067ebced8fd7d22495d6b2affda2035"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8ffed8f2d82cf41bf9c9c681782b9b0"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1linear_ad8ffed8f2d82cf41bf9c9c681782b9b0.html#ad8ffed8f2d82cf41bf9c9c681782b9b0">pism::fem::linear::n_chi</a> = 2</td></tr>
<tr class="separator:ad8ffed8f2d82cf41bf9c9c681782b9b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ba74adcfbeb7fad387265c154e8afa"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q0_ab8ba74adcfbeb7fad387265c154e8afa.html#ab8ba74adcfbeb7fad387265c154e8afa">pism::fem::q0::n_chi</a> = 4</td></tr>
<tr class="separator:ab8ba74adcfbeb7fad387265c154e8afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefc9dab5f289f2fbc6d06682a31a6456"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q0_aefc9dab5f289f2fbc6d06682a31a6456.html#aefc9dab5f289f2fbc6d06682a31a6456">pism::fem::q0::n_sides</a> = 4</td></tr>
<tr class="separator:aefc9dab5f289f2fbc6d06682a31a6456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac174d66fdbd953c89d3094cf72801f9e"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q1_ac174d66fdbd953c89d3094cf72801f9e.html#ac174d66fdbd953c89d3094cf72801f9e">pism::fem::q1::n_chi</a> = 4</td></tr>
<tr class="separator:ac174d66fdbd953c89d3094cf72801f9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80d99f3538f1bba15e5db4a9bcd37c39"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q1_a80d99f3538f1bba15e5db4a9bcd37c39.html#a80d99f3538f1bba15e5db4a9bcd37c39">pism::fem::q1::n_sides</a> = 4</td></tr>
<tr class="separator:a80d99f3538f1bba15e5db4a9bcd37c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0039f65e0a433910822d97306a11b26"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1p1_ac0039f65e0a433910822d97306a11b26.html#ac0039f65e0a433910822d97306a11b26">pism::fem::p1::n_chi</a> = 3</td></tr>
<tr class="separator:ac0039f65e0a433910822d97306a11b26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22ff25ae80703605bf698453555085d"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1p1_af22ff25ae80703605bf698453555085d.html#af22ff25ae80703605bf698453555085d">pism::fem::p1::n_sides</a> = 3</td></tr>
<tr class="separator:af22ff25ae80703605bf698453555085d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a7b2ec0e759c45002166d1bd5fb683"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d_a15a7b2ec0e759c45002166d1bd5fb683.html#a15a7b2ec0e759c45002166d1bd5fb683">pism::fem::q13d::n_chi</a> = 8</td></tr>
<tr class="memdesc:a15a7b2ec0e759c45002166d1bd5fb683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of shape functions on a Q1 element.  <a href="namespacepism_1_1fem_1_1q13d_a15a7b2ec0e759c45002166d1bd5fb683.html#a15a7b2ec0e759c45002166d1bd5fb683">More...</a><br /></td></tr>
<tr class="separator:a15a7b2ec0e759c45002166d1bd5fb683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00a4bc91e0c71822e74192e58a83edfe"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d_a00a4bc91e0c71822e74192e58a83edfe.html#a00a4bc91e0c71822e74192e58a83edfe">pism::fem::q13d::n_faces</a> = 6</td></tr>
<tr class="memdesc:a00a4bc91e0c71822e74192e58a83edfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of sides per element.  <a href="namespacepism_1_1fem_1_1q13d_a00a4bc91e0c71822e74192e58a83edfe.html#a00a4bc91e0c71822e74192e58a83edfe">More...</a><br /></td></tr>
<tr class="separator:a00a4bc91e0c71822e74192e58a83edfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa17b814c434bd5ce04062bbf0a914c1b"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepism_1_1fem_1_1q13d_aa17b814c434bd5ce04062bbf0a914c1b.html#aa17b814c434bd5ce04062bbf0a914c1b">pism::fem::q13d::incident_nodes</a> [n_faces][4]</td></tr>
<tr class="separator:aa17b814c434bd5ce04062bbf0a914c1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Classes for implementing the Finite Element Method on an IceGrid. </p>
<p>We assume that the reader has a basic understanding of the finite element method. The following is a reminder of the method that also gives the background for the how to implement it on an IceGrid with the tools in this module.</p>
<p>The IceGrid domain \(\Omega\) is decomposed into a grid of rectangular physical elements indexed by indices (i,j):</p>
<div class="fragment"><div class="line">(0,1)       (1,1)</div>
<div class="line">    ---------</div>
<div class="line">    |   |   |</div>
<div class="line">    ---------</div>
<div class="line">    |   |   |</div>
<div class="line">    ---------</div>
<div class="line">(0,0)       (1,0)</div>
</div><!-- fragment --><p>The index of an element corresponds with the index of its lower-left vertex in the grid.</p>
<p>The reference element is the square \([-1,1]\times[-1,1]\). For each physical element \(E_{ij}\), there is an map \(F_{ij}\) from the reference element \(R\) to \(E_{ij}\). In this implementation, the rectangles in the domain are all congruent, and the maps F_{ij} are all the same up to a translation.</p>
<p>On the reference element, vertices are ordered as follows:</p>
<div class="fragment"><div class="line">3 o---------o 2</div>
<div class="line">  |         |</div>
<div class="line">  |         |</div>
<div class="line">  |         |</div>
<div class="line">0 o---------o 1</div>
</div><!-- fragment --><p>For each vertex \(k\in\{0,1,2,3\}\) there is an element basis function \(\phi_k\) that is bilinear, equals 1 at vertex \(k\), and equals 0 at the remaining vertices.</p>
<p>For each node \((i,j)\) in the physical domain there is a basis function \(\psi_{ij}\) that equals 1 at vertex \((i,j)\), and equals zero at all other vertices, and that on element \(E_{i&#39;j&#39;}\) can be written as \(\phi_k\circ F_{i&#39;,j&#39;}^{-1}\) for some index \(k\): </p><p class="formulaDsp">
\[ \psi_{ij}\Big|_{E_{i&#39;j&#39;}} = \phi_k\circ F_{i&#39;,j&#39;}^{-1}. \]
</p>
<p>The hat functions \(\psi_{ij}\) form a basis of the function space of piecewise-linear functions. A (scalar) piecewise-linear function \(v=v(x,y)\) on the domain is a linear combination </p><p class="formulaDsp">
\[ v = \sum_{i,j} c_{ij}\psi_{ij}. \]
</p>
<p>Let \(G(w,v)\) denote the weak form of the PDE under consideration. For example, for the scalar Poisson equation \(-\Delta w = f\), </p><p class="formulaDsp">
\[ G(w,v) = \int_\Omega \nabla w \cdot \nabla v -f v \;dx. \]
</p>
<p> The SSA weak form is more complicated, in particular because there is dimension 2 at each vertex, corresponding to x- and y-velocity components, but it is in many ways like the Poisson weak form.</p>
<p>In the continuous problem we seek to find a trial function \(w\) such that \(G(w,v)=0\) for all suitable test functions \(v\).</p>
<p>In the discrete problem, we seek a finite element function \(w_h\) such that \(G(w_h,\psi_{ij})=0\) for all suitable indices \((i,j)\). For realistic problems, the integral defining \(G\) cannot be evaluated exactly, but is approximated with some \(G_h\) that arises from numerical quadrature rule: integration on an element \(E\) is approximated with </p><p class="formulaDsp">
\[ \int_E f dx \approx \sum_{q} f(x_q) j_q \]
</p>
<p> for certain points \(x_q\) and weights \(j_q\) (specific details are found in Quadrature).</p>
<p>The unknown \(w_h\) is represented by an IceVec, \(w_h=\sum_{ij} c_{ij} \psi_{ij}\) where \(c_{ij}\) are the coefficients of the vector. The solution of the finite element problem requires the following computations:</p>
<ol type="1">
<li>Evaluation of the residuals \(r_{ij} = G_h(w_h,\psi_{ij})\)</li>
<li>Evaluation of the Jacobian matrix <p class="formulaDsp">
\[ J_{(ij)\;(kl)}=\frac{d}{dc_{kl}} G_h(w_h,\psi_{ij}). \]
</p>
</li>
</ol>
<p>Computations of these 'integrals' are done by adding up the contributions from each element (an ElementIterator helps with iterating over the elements). For a fixed element, there is a locally defined trial function \(\hat w_h\) (with 4 degrees of freedom in the scalar case) and 4 local test functions \(\hat\psi_k\), one for each vertex.</p>
<p>The contribution to the integrals proceeds as follows (for concreteness in the case of computing the residual):</p>
<ul>
<li>Extract from the global degrees of freedom \(c\) defining \(w_h\) the local degrees of freedom \(d\) defining \(\hat w_h\). (Element)</li>
<li>Evaluate the local trial function \(w_h\) (values and derivatives as needed) at the quadrature points \(x_q\) (Quadrature)</li>
<li>Evaluate the local test functions (again values and derivatives) at the quadrature points. (Quadrature)</li>
<li>Obtain the quadrature weights \(j_q\) for the element (Quadrature)</li>
<li>Compute the values of the integrand \(G(\hat w_h,\psi_k)\) at each quadrature point (call these \(g_{qk}\)) and form the weighted sums \(y_k=\sum_{q} j_q g_{qk}\).</li>
<li>Each sum \(y_k\) is the contribution of the current element to a residual entry \(r_{ij}\), where local degree of freedom \(k\) corresponds with global degree of freedom \((i,j)\). The local contibutions now need to be added to the global residual vector (Element).</li>
</ul>
<p>Computation of the Jacobian is similar, except that there are now multiple integrals per element (one for each local degree of freedom of \(\hat w_h\)).</p>
<p>All of the above is a simplified description of what happens in practice. The complications below treated by the following classes, and discussed in their documentation:</p>
<ul>
<li>Ghost elements (as well as periodic boundary conditions): ElementIterator</li>
<li>Dirichlet data: Element</li>
<li>Vector valued functions: (Element, Quadrature)</li>
</ul>
<p>The classes in this module are not intended to be a fancy finite element package. Their purpose is to clarify the steps that occur in the computation of residuals and Jacobians in SSAFEM, and to isolate and consolidate the hard steps so that they are not scattered about the code. </p>

<p class="definition">Definition in file <a class="el" href="FEM_8hh_source.html">FEM.hh</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
