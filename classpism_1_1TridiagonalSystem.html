<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: pism::TridiagonalSystem Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.0.4 committed by Constantine Khrulev on 2022-05-25 12:02:27 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepism.html">pism</a></li><li class="navelem"><a class="el" href="classpism_1_1TridiagonalSystem.html">TridiagonalSystem</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classpism_1_1TridiagonalSystem-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">pism::TridiagonalSystem Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Virtual base class. Abstracts a tridiagonal system to solve in a column of ice and/or bedrock.  
 <a href="classpism_1_1TridiagonalSystem.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ColumnSystem_8hh_source.html">ColumnSystem.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3fea9a4c36f4c6e4a17ac7e8f13ef5c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a3fea9a4c36f4c6e4a17ac7e8f13ef5c2.html#a3fea9a4c36f4c6e4a17ac7e8f13ef5c2">TridiagonalSystem</a> (unsigned int max_size, const std::string &amp;<a class="el" href="classpism_1_1TridiagonalSystem_a27ee53b9a87619082860168d902931bf.html#a27ee53b9a87619082860168d902931bf">prefix</a>)</td></tr>
<tr class="memdesc:a3fea9a4c36f4c6e4a17ac7e8f13ef5c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate a tridiagonal system of maximum size max_system_size.  <a href="classpism_1_1TridiagonalSystem_a3fea9a4c36f4c6e4a17ac7e8f13ef5c2.html#a3fea9a4c36f4c6e4a17ac7e8f13ef5c2">More...</a><br /></td></tr>
<tr class="separator:a3fea9a4c36f4c6e4a17ac7e8f13ef5c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b54e64a78de67a290eec54f6216aa8b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a7b54e64a78de67a290eec54f6216aa8b.html#a7b54e64a78de67a290eec54f6216aa8b">norm1</a> (unsigned int system_size) const</td></tr>
<tr class="memdesc:a7b54e64a78de67a290eec54f6216aa8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute 1-norm, which is max sum of absolute values of columns.  <a href="classpism_1_1TridiagonalSystem_a7b54e64a78de67a290eec54f6216aa8b.html#a7b54e64a78de67a290eec54f6216aa8b">More...</a><br /></td></tr>
<tr class="separator:a7b54e64a78de67a290eec54f6216aa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b1da825804de182668b3f725486f9c4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a6b1da825804de182668b3f725486f9c4.html#a6b1da825804de182668b3f725486f9c4">ddratio</a> (unsigned int system_size) const</td></tr>
<tr class="memdesc:a6b1da825804de182668b3f725486f9c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute diagonal-dominance ratio. If this is less than one then the matrix is strictly diagonally-dominant.  <a href="classpism_1_1TridiagonalSystem_a6b1da825804de182668b3f725486f9c4.html#a6b1da825804de182668b3f725486f9c4">More...</a><br /></td></tr>
<tr class="separator:a6b1da825804de182668b3f725486f9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac806ac534e41601639a12bf2f47dc2c3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_ac806ac534e41601639a12bf2f47dc2c3.html#ac806ac534e41601639a12bf2f47dc2c3">reset</a> ()</td></tr>
<tr class="memdesc:ac806ac534e41601639a12bf2f47dc2c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zero all entries.  <a href="classpism_1_1TridiagonalSystem_ac806ac534e41601639a12bf2f47dc2c3.html#ac806ac534e41601639a12bf2f47dc2c3">More...</a><br /></td></tr>
<tr class="separator:ac806ac534e41601639a12bf2f47dc2c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a557d48fec7e6cbc7770d310fb36601e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a557d48fec7e6cbc7770d310fb36601e9.html#a557d48fec7e6cbc7770d310fb36601e9">solve</a> (unsigned int system_size, std::vector&lt; double &gt; &amp;result)</td></tr>
<tr class="separator:a557d48fec7e6cbc7770d310fb36601e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae898ecc812d3e36cb3dfc310940cb6e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_ae898ecc812d3e36cb3dfc310940cb6e1.html#ae898ecc812d3e36cb3dfc310940cb6e1">solve</a> (unsigned int system_size, double *result)</td></tr>
<tr class="memdesc:ae898ecc812d3e36cb3dfc310940cb6e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">The actual code for solving a tridiagonal system.  <a href="classpism_1_1TridiagonalSystem_ae898ecc812d3e36cb3dfc310940cb6e1.html#ae898ecc812d3e36cb3dfc310940cb6e1">More...</a><br /></td></tr>
<tr class="separator:ae898ecc812d3e36cb3dfc310940cb6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0818564140321c65caf9d3454eebc75"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_ad0818564140321c65caf9d3454eebc75.html#ad0818564140321c65caf9d3454eebc75">save_system_with_solution</a> (const std::string &amp;filename, unsigned int system_size, const std::vector&lt; double &gt; &amp;solution)</td></tr>
<tr class="separator:ad0818564140321c65caf9d3454eebc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a1af43a4162e635f0505dd5f0d2e7d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a1a1af43a4162e635f0505dd5f0d2e7d8.html#a1a1af43a4162e635f0505dd5f0d2e7d8">save_system</a> (std::ostream &amp;output, unsigned int system_size) const</td></tr>
<tr class="memdesc:a1a1af43a4162e635f0505dd5f0d2e7d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">View the tridiagonal system A x = b to an output stream, both A as a full matrix and b as a vector.  <a href="classpism_1_1TridiagonalSystem_a1a1af43a4162e635f0505dd5f0d2e7d8.html#a1a1af43a4162e635f0505dd5f0d2e7d8">More...</a><br /></td></tr>
<tr class="separator:a1a1af43a4162e635f0505dd5f0d2e7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a060cb3c47628681b2dbae147dadfa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a19a060cb3c47628681b2dbae147dadfa.html#a19a060cb3c47628681b2dbae147dadfa">save_matrix</a> (std::ostream &amp;output, unsigned int system_size, const std::string &amp;variable) const</td></tr>
<tr class="memdesc:a19a060cb3c47628681b2dbae147dadfa"><td class="mdescLeft">&#160;</td><td class="mdescRight">View the tridiagonal matrix.  <a href="classpism_1_1TridiagonalSystem_a19a060cb3c47628681b2dbae147dadfa.html#a19a060cb3c47628681b2dbae147dadfa">More...</a><br /></td></tr>
<tr class="separator:a19a060cb3c47628681b2dbae147dadfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ee53b9a87619082860168d902931bf"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a27ee53b9a87619082860168d902931bf.html#a27ee53b9a87619082860168d902931bf">prefix</a> () const</td></tr>
<tr class="separator:a27ee53b9a87619082860168d902931bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a999e3e59c2a720d74685e8e2b47e43db"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a999e3e59c2a720d74685e8e2b47e43db.html#a999e3e59c2a720d74685e8e2b47e43db">L</a> (size_t i)</td></tr>
<tr class="separator:a999e3e59c2a720d74685e8e2b47e43db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97cb81a38dbcb2cf2139cebec889b9c4"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a97cb81a38dbcb2cf2139cebec889b9c4.html#a97cb81a38dbcb2cf2139cebec889b9c4">D</a> (size_t i)</td></tr>
<tr class="separator:a97cb81a38dbcb2cf2139cebec889b9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d7c1f82e9aaf6200c69dbdf57e0caa"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a97d7c1f82e9aaf6200c69dbdf57e0caa.html#a97d7c1f82e9aaf6200c69dbdf57e0caa">U</a> (size_t i)</td></tr>
<tr class="separator:a97d7c1f82e9aaf6200c69dbdf57e0caa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d58571f96beffe94d7f03d1807381f8"><td class="memItemLeft" align="right" valign="top">double &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a2d58571f96beffe94d7f03d1807381f8.html#a2d58571f96beffe94d7f03d1807381f8">RHS</a> (size_t i)</td></tr>
<tr class="separator:a2d58571f96beffe94d7f03d1807381f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a9e7cd17edb66b05af7df5170d95a9694"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a9e7cd17edb66b05af7df5170d95a9694.html#a9e7cd17edb66b05af7df5170d95a9694">save_vector</a> (std::ostream &amp;output, const std::vector&lt; double &gt; &amp;v, unsigned int system_size, const std::string &amp;variable)</td></tr>
<tr class="memdesc:a9e7cd17edb66b05af7df5170d95a9694"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utility for simple ascii view of a vector (one-dimensional column) quantity.  <a href="classpism_1_1TridiagonalSystem_a9e7cd17edb66b05af7df5170d95a9694.html#a9e7cd17edb66b05af7df5170d95a9694">More...</a><br /></td></tr>
<tr class="separator:a9e7cd17edb66b05af7df5170d95a9694"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a32361c3f8885a30a527f01bd4827af83"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a32361c3f8885a30a527f01bd4827af83.html#a32361c3f8885a30a527f01bd4827af83">m_max_system_size</a></td></tr>
<tr class="separator:a32361c3f8885a30a527f01bd4827af83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac83658eac7e4b469a0a353f22638a80e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_ac83658eac7e4b469a0a353f22638a80e.html#ac83658eac7e4b469a0a353f22638a80e">m_L</a></td></tr>
<tr class="separator:ac83658eac7e4b469a0a353f22638a80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa468199390aaa31d80bb06b5f63dc43b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_aa468199390aaa31d80bb06b5f63dc43b.html#aa468199390aaa31d80bb06b5f63dc43b">m_D</a></td></tr>
<tr class="separator:aa468199390aaa31d80bb06b5f63dc43b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b1b8480868be15a6de52b04fe1403a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_aa4b1b8480868be15a6de52b04fe1403a.html#aa4b1b8480868be15a6de52b04fe1403a">m_U</a></td></tr>
<tr class="separator:aa4b1b8480868be15a6de52b04fe1403a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec55e16a2a5f88ac1799a26013fc11b8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_aec55e16a2a5f88ac1799a26013fc11b8.html#aec55e16a2a5f88ac1799a26013fc11b8">m_rhs</a></td></tr>
<tr class="separator:aec55e16a2a5f88ac1799a26013fc11b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fa3e9e15cd7740a3f16273c12ff2e9d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_a1fa3e9e15cd7740a3f16273c12ff2e9d.html#a1fa3e9e15cd7740a3f16273c12ff2e9d">m_work</a></td></tr>
<tr class="separator:a1fa3e9e15cd7740a3f16273c12ff2e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafabe296ecca54da6edf2bbb7d9ce37e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpism_1_1TridiagonalSystem_aafabe296ecca54da6edf2bbb7d9ce37e.html#aafabe296ecca54da6edf2bbb7d9ce37e">m_prefix</a></td></tr>
<tr class="separator:aafabe296ecca54da6edf2bbb7d9ce37e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Virtual base class. Abstracts a tridiagonal system to solve in a column of ice and/or bedrock. </p>
<p>Because both the age evolution and conservation of energy equations require us to set up and solve a tridiagonal system of equations, this is structure is worth abstracting.</p>
<p>This base class just holds the tridiagonal system and the ability to solve it, but does not insert entries into the relevant matrix locations. Derived classes will actually set up instances of the system.</p>
<p>The sequence requires setting the column-independent (public) data members, calling the initAllColumns() routine, and then setting up and solving the system in each column.</p>
<p>The tridiagonal algorithm here comes from Numerical Recipes in C Section 2.4, page 50. It solves the system:</p>
<pre class="fragment">  [b_1  c_1   0   ...                           ] [  u_1  ]   [   r_1   ]
  [a_2  b_2  c_2  ...                           ] [  u_2  ]   [   r_2   ]
  [               ...                           ].[  ...  ] = [   ...   ]
  [               ...  a_{N-1}  b_{N-1}  c_{N-1}] [u_{N-1}]   [ r_{N-1} ]
  [               ...     0     a_N      b_N    ] [  u_N  ]   [   r_N   ]
</pre><p>HOWEVER... the version in this code is different from Numerical Recipes in two ways:</p>
<ul>
<li>Indexing is zero-based</li>
<li>Variables have been renamed.</li>
</ul>
<pre class="fragment">  NR      PISM
  ==================
  a       L       "Lower Diagonal" (L doesn't use index 0)
  b       D       "Diagonal"
  c       U       "Upper Diagonal"
  u       x
  r       rhs
  bet     b
  j       k
  n       n
  gam     work
</pre><p>Therefore... this version of the code solves the following problem:</p>
<pre class="fragment">  [D_0  U_0   0   ...                           ] [  x_0  ]   [   r_0   ]
  [L_1  D_1  U_1  ...                           ] [  x_1  ]   [   r_1   ]
  [               ...                           ].[  ...  ] = [   ...   ]
  [               ...  L_{N-2}  D_{N-2}  U_{N-2}] [x_{N-2}]   [ r_{N-2} ]
  [               ...     0     L_{N-1}  D_{N-1}] [x_{N-1}]   [ r_{N-1} ]
</pre> 
<p class="definition">Definition at line <a class="el" href="ColumnSystem_8hh_source.html#l00082">82</a> of file <a class="el" href="ColumnSystem_8hh_source.html">ColumnSystem.hh</a>.</p>
</div><hr/>The documentation for this class was generated from the following files:<ul>
<li>src/util/<a class="el" href="ColumnSystem_8hh_source.html">ColumnSystem.hh</a></li>
<li>src/util/<a class="el" href="ColumnSystem_8cc_source.html">ColumnSystem.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
