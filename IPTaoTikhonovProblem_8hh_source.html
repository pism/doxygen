<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: src/inverse/IPTaoTikhonovProblem.hh Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.0.7 committed by Constantine Khrulev on 2023-11-21 12:49:11 -0900</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_aa9ce82b198302bbaa53ad916ca500e4.html">inverse</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">IPTaoTikhonovProblem.hh</div>  </div>
</div><!--header-->
<div class="contents">
<a href="IPTaoTikhonovProblem_8hh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright (C) 2012,2013,2014,2015,2016,2017,2020  David Maxwell and Constantine Khroulev</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// This file is part of PISM.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// PISM is free software; you can redistribute it and/or modify it under the</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// terms of the GNU General Public License as published by the Free Software</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// Foundation; either version 3 of the License, or (at your option) any later</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// PISM is distributed in the hope that it will be useful, but WITHOUT ANY</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// along with PISM; if not, write to the Free Software</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifndef IPTAOTIKHONOVPROBLEM_HH_4NMM724B</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#define IPTAOTIKHONOVPROBLEM_HH_4NMM724B</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TaoUtil_8hh.html">TaoUtil.hh</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IPFunctional_8hh.html">functional/IPFunctional.hh</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;pism/util/ConfigInterface.hh&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;pism/util/IceGrid.hh&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;pism/util/Logger.hh&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;pism/util/Context.hh&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;pism/util/petscwrappers/Vec.hh&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacepism.html">pism</a> {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">namespace </span>inverse {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt; <span class="keyword">class </span>IPTaoTikhonovProblem;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//! Iteration callback class for IPTaoTikhonovProblem</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span><span class="comment">/** A class for objects receiving iteration callbacks from a</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> * IPTaoTikhonovProblem. These callbacks can be used to monitor the</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * solution, plot iterations, print diagnostic messages, etc.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * IPTaoTikhonovProblemListeners are ususally used via a reference</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * counted pointer IPTaoTikhonovProblemListener::Ptr to allow for good</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * memory management when Listeners are created as subclasses of</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * python classes. It would have been better to nest this inside of</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * IPTaoTikhonovProblem, but SWIG has a hard time with nested classes,</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * so it&#39;s outer instead.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener.html">   48</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt; <span class="keyword">class </span><a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener.html">IPTaoTikhonovProblemListener</a> {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a1555be9a95a5f5f81cb09f3a102f0ae0.html#a1555be9a95a5f5f81cb09f3a102f0ae0">   50</a></span>&#160;  <span class="keyword">typedef</span> std::shared_ptr&lt;IPTaoTikhonovProblemListener&gt; <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a1555be9a95a5f5f81cb09f3a102f0ae0.html#a1555be9a95a5f5f81cb09f3a102f0ae0">Ptr</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">   53</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ForwardProblem::DesignVec::Ptr <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd.html#a072120bdbc646a59ef7bff1a7775a6cd">   54</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ForwardProblem::StateVec::Ptr <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd.html#a072120bdbc646a59ef7bff1a7775a6cd">StateVecPtr</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a6fa50f3a53fa61ce02411552106f5a6b.html#a6fa50f3a53fa61ce02411552106f5a6b">   56</a></span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a6fa50f3a53fa61ce02411552106f5a6b.html#a6fa50f3a53fa61ce02411552106f5a6b">IPTaoTikhonovProblemListener</a>() {}</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a9992ed7a78ce4bbbff899fba618de735.html#a9992ed7a78ce4bbbff899fba618de735">   57</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a9992ed7a78ce4bbbff899fba618de735.html#a9992ed7a78ce4bbbff899fba618de735">~IPTaoTikhonovProblemListener</a>() {}</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">  //! The method called after each minimization iteration.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a62a824aa5299555d21590e68266bf063.html#a62a824aa5299555d21590e68266bf063">   60</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a62a824aa5299555d21590e68266bf063.html#a62a824aa5299555d21590e68266bf063">iteration</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem.html">IPTaoTikhonovProblem&lt;ForwardProblem&gt;</a> &amp;problem,</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                         <span class="keywordtype">double</span> eta, <span class="keywordtype">int</span> iter,</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                         <span class="keywordtype">double</span> objectiveValue, <span class="keywordtype">double</span> designValue,</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a> d,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a> diff_d,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a> grad_d,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd.html#a072120bdbc646a59ef7bff1a7775a6cd">StateVecPtr</a> u,</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd.html#a072120bdbc646a59ef7bff1a7775a6cd">StateVecPtr</a> diff_u,</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a> grad_u,</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">DesignVecPtr</a> gradient) = 0;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;};</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">//! \brief Defines a Tikhonov minimization problem to be solved with a TaoBasicSolver.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span><span class="comment">/*! Suppose \f$F\f$ is a map from a space \f$D\f$ of design variables to a space \f$S\f$ of</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">  state variables and we wish to solve a possibly ill-posed problem of the form</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">  \f[ F(d) = u \f]</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">  where \f$u\f$ is know and \f$d\f$ is unknown.  Approximate solutions can be obtained by </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">  finding minimizers of an associated Tikhonov functional</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">  J(d) = J_{S}(F(d)-u) + \frac{1}{\eta}J_{D}(d-d_0)</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">  where \$J_{D}\$ and \$J_{S}\$ are functionals on the spaces \f$D\f$ and \f$S\f$ respectively,</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">  \f$\eta\f$ is a penalty parameter, and \f$d_0\f$ is a best a-priori guess for the the solution.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">  The IPTaoTikhonovProblem class encapuslates all of the data required to formulate the minimization</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">  problem as a Problem tha can be solved using a TaoBasicSolver. It is templated on the</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">  the class ForwardProblem which defines the class of the forward map \f$F\f$ as well as the</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">  spaces \f$D\f$ and \f$S\f$. An instance of ForwardProblem, along with </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">  specific functionals \f$J_D\f$ and \f$J_S\f$, the parameter \f$\eta\f$, and the data </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">  \f$y\f$ and \f$x_0\f$ are provided on constructing a IPTaoTikhonovProblem.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">  For example, if the SSATaucForwardProblem class defines the map taking yield stresses \f$\tau_c\f$</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">  to the corresponding surface velocity field solving the SSA, a schematic setup of solving</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">  the associated Tikhonov problem goes as follows.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">  SSATaucForwardProblem forwardProblem(grid);</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">  L2NormFunctional2S designFunctional(grid); //J_X</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">  L2NormFunctional2V stateFunctional(grid);  //J_Y</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">  IceModelVec2V u_obs;     // Set this to the surface velocity observations.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">  IceModelVec2S tauc_0;    // Set this to the initial guess for tauc.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">  double eta;           // Set this to the desired penalty parameter.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">  typedef InvSSATauc IPTaoTikhonovProblem&lt;SSATaucForwardProblem&gt;;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">  InvSSATauc tikhonovProblem(forwardProblem,tauc_0,u_obs,eta,designFunctional,stateFunctional);</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  TaoBasicSolver&lt;InvSSATauc&gt; solver(com, &quot;cg&quot;, tikhonovProblem);</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">  TerminationReason::Ptr reason = solver.solve();</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">  if (reason-&gt;succeeded()) {</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">  printf(&quot;Success: %s\n&quot;,reason-&gt;description().c_str());</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">  } else {</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">  printf(&quot;Failure: %s\n&quot;,reason-&gt;description().c_str());</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">  }</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  The class ForwardProblem that defines the forward problem</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">  must have the following characteristics:</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">  &lt;ol&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">  &lt;li&gt; Contains typedefs for DesignVec and StateVec that effectively</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">  define the function spaces \f$D\f$ and \f$S\f$.  E.g. </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">  typedef IceModelVec2S DesignVec;</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">  typedef IceModelVec2V StateVec;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  would be appropriate for a map from basal yeild stress to surface velocities.</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  &lt;li&gt; A method</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  TerminationReason::Ptr linearize_at(DesignVec &amp;d);</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">  that instructs the class to compute the value of F and </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">  anything needed to compute its linearization at \a d.   This is the first method</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">  called when working with a new iterate of \a d.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">  &lt;li&gt; A method</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">  StateVec &amp;solution()</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">  that returns the most recently computed value of \f$F(d)\f$ </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">  as computed by a call to linearize_at.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">  &lt;li&gt; A method</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">  \code</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">  void apply_linearization_transpose(StateVec &amp;du, DesignVec &amp;dzeta);</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">  \endcode</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">  that computes the action of \f$(F&#39;)^t\f$,</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">  where \f$F&#39;\f$ is the linearization of \f$F\f$ at the current iterate, and the transpose</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">  is computed in the standard sense (i.e. thinking of \f$F&#39;\f$ as a matrix with respect</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">  to the bases implied by the DesignVec and StateVec spaces).  The need for a transpose arises</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">  because</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">  \frac{d}{dt} J_{S}(F(d+t\delta d)-u) = [DJ_S]_{k}\; F&#39;_{kj} \; \delta d</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">  and hence the gradient of the term \f$J_{S}(F(d)-u)\f$ with respect to \f$d\f$ is given</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">  by</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">  (F&#39;)^t (\nabla J_S)^t.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">  &lt;/ol&gt;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem.html">  164</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt; <span class="keyword">class </span><a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem.html">IPTaoTikhonovProblem</a></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">  168</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="namespacepism_1_1inverse_a16bd15a34127cc491455ba03e95c30ae.html#a16bd15a34127cc491455ba03e95c30ae">ForwardProblem::DesignVec</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">  169</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="namespacepism_1_1inverse_a87a083e9db7f2fbc1ee5ed79cbb9a5d7.html#a87a083e9db7f2fbc1ee5ed79cbb9a5d7">ForwardProblem::StateVec</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">  171</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ForwardProblem::DesignVec::Ptr <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566.html#ab794caff0bdd53d1e28ff6ab483bd566">  172</a></span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> ForwardProblem::StateVec::Ptr <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566.html#ab794caff0bdd53d1e28ff6ab483bd566">StateVecPtr</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">  /*! Constructs a Tikhonov problem:</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">    Minimize \f$J(d) = J_S(F(d)-u_obs) + \frac{1}{\eta} J_D(d-d0)  \f$</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">    that can be solved with a TaoBasicSolver.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">      </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">    @param forward Class defining the map F.  See class-level documentation for requirements of F.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">    @param      d0 Best a-priori guess for the design parameter.</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">    @param   u_obs State parameter to match (i.e. approximately solve F(d)=u_obs)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">    @param     eta Penalty parameter/Lagrange multiplier.  Take eta to zero to impose more regularization to an ill posed problem.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">    @param   designFunctional The functional \f$J_D\f$</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">    @param    stateFunctional The functional \f$J_S\f$</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa.html#aee4a70d8414a699934b329a3ef7105aa">  188</a></span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa.html#aee4a70d8414a699934b329a3ef7105aa">IPTaoTikhonovProblem</a>(ForwardProblem &amp;forward, <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a> &amp;d0, <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a> &amp;u_obs, <span class="keywordtype">double</span> eta, </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                       <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;DesignVec&gt;</a>&amp;designFunctional, <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;StateVec&gt;</a>&amp;stateFunctional);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391.html#acb518c3c1c627b335f02a922f4afe391">  191</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391.html#acb518c3c1c627b335f02a922f4afe391">~IPTaoTikhonovProblem</a>();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">  //! Sets the initial guess for minimization iterations. If this isn&#39;t set explicitly,</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span>  <span class="comment">//  the parameter \f$d0\f$ appearing the in the Tikhonov functional will be used.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a57f48f254a266edf33fa71c2c3f81134.html#a57f48f254a266edf33fa71c2c3f81134">  196</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a57f48f254a266edf33fa71c2c3f81134.html#a57f48f254a266edf33fa71c2c3f81134">setInitialGuess</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a> &amp;d) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">m_dGlobal</a>.copy_from(d);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">  //! Callback provided to TAO for objective evaluation.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e.html#a940cdc2a9b098911afdf40e55b4d9e7e">  201</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e.html#a940cdc2a9b098911afdf40e55b4d9e7e">evaluateObjectiveAndGradient</a>(Tao tao, Vec x, <span class="keywordtype">double</span> *value, Vec gradient);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">  //! Add an object to the list of objects to be called after each iteration.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a2600a14b65a262665851b80e619ca435.html#a2600a14b65a262665851b80e619ca435">  204</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a2600a14b65a262665851b80e619ca435.html#a2600a14b65a262665851b80e619ca435">addListener</a>(<span class="keyword">typename</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a1555be9a95a5f5f81cb09f3a102f0ae0.html#a1555be9a95a5f5f81cb09f3a102f0ae0">IPTaoTikhonovProblemListener&lt;ForwardProblem&gt;::Ptr</a> listener) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a13132798f7377eaae11b4b19ae09ff71.html#a13132798f7377eaae11b4b19ae09ff71">m_listeners</a>.push_back(listener);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  //! Final value of \f$F(d)\f$, where \f$d\f$ is the solution of the minimization.</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af557b18cf4ecbf3ed234349f10e3015f.html#af557b18cf4ecbf3ed234349f10e3015f">  209</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566.html#ab794caff0bdd53d1e28ff6ab483bd566">StateVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af557b18cf4ecbf3ed234349f10e3015f.html#af557b18cf4ecbf3ed234349f10e3015f">stateSolution</a>() {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a1bd5d6d3633d3481335d5ae8d0eb9bc5.html#a1bd5d6d3633d3481335d5ae8d0eb9bc5">m_forward</a>.solution();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  }</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">  //! Value of \f$d\f$, the solution of the minimization problem.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac06b84b9acc75cf95e8d73dd78509ded.html#ac06b84b9acc75cf95e8d73dd78509ded">  214</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac06b84b9acc75cf95e8d73dd78509ded.html#ac06b84b9acc75cf95e8d73dd78509ded">designSolution</a>() {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c.html#a96f71f09e367dcdbbe4f57d398eafe2c">m_d</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">  //! Callback from TaoBasicSolver, used to wire the connections between a Tao and</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment"></span>  <span class="comment">//  the current class.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e.html#a68e057199fe18c9fd59e8cb6ccc0e84e">  220</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e.html#a68e057199fe18c9fd59e8cb6ccc0e84e">connect</a>(Tao tao);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  //! Callback from TAO after each iteration.  The call is forwarded to each element of our list of listeners.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9.html#ae6a1aee0fa51158fe135ad508d627af9">  223</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9.html#ae6a1aee0fa51158fe135ad508d627af9">monitorTao</a>(Tao tao);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">  //! Callback from TAO to detect convergence.  Allows us to implement a custom convergence check.</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de.html#a138b20abb431a05b58dc76771785e0de">  226</a></span>&#160;<span class="comment"></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de.html#a138b20abb431a05b58dc76771785e0de">convergenceTest</a>(Tao tao);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">  //! Callback from TaoBasicSolver to form the starting iterate for the minimization.  See also</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span>  <span class="comment">//  setInitialGuess.</span></div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac2901aa76eac4a26b1a4144454d3a1f7.html#ac2901aa76eac4a26b1a4144454d3a1f7">  230</a></span>&#160;  <span class="keyword">virtual</span> <a class="code" href="classpism_1_1TerminationReason_a1477a9427838815f537ee44d6df00c3e.html#a1477a9427838815f537ee44d6df00c3e">TerminationReason::Ptr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac2901aa76eac4a26b1a4144454d3a1f7.html#ac2901aa76eac4a26b1a4144454d3a1f7">formInitialGuess</a>(Vec *v) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    *v = <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">m_dGlobal</a>.vec();</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classpism_1_1GenericTerminationReason_acafda70bc8691ed81c472a2375084c25.html#acafda70bc8691ed81c472a2375084c25">GenericTerminationReason::success</a>();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">  237</a></span>&#160;  <a class="code" href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">IceGrid::ConstPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a1bd5d6d3633d3481335d5ae8d0eb9bc5.html#a1bd5d6d3633d3481335d5ae8d0eb9bc5">  239</a></span>&#160;  ForwardProblem &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a1bd5d6d3633d3481335d5ae8d0eb9bc5.html#a1bd5d6d3633d3481335d5ae8d0eb9bc5">m_forward</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">  /// Current iterate of design parameter</span></div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c.html#a96f71f09e367dcdbbe4f57d398eafe2c">  242</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c.html#a96f71f09e367dcdbbe4f57d398eafe2c">m_d</a>;<span class="comment"></span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">  /// Initial iterate of design parameter, stored without ghosts for the benefit of TAO.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">  244</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">m_dGlobal</a>;<span class="comment"></span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">  /// A-priori estimate of design parameter</span></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0.html#a9de4cc697f5ba0e81860ba64221937d0">  246</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a> &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0.html#a9de4cc697f5ba0e81860ba64221937d0">m_d0</a>;<span class="comment"></span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">  /// Storage for (m_d-m_d0)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a597720995d702a27b9a8563343d61b46.html#a597720995d702a27b9a8563343d61b46">  248</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a597720995d702a27b9a8563343d61b46.html#a597720995d702a27b9a8563343d61b46">m_d_diff</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">  /// State parameter to match via F(d)=u_obs</span></div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac906313d02c440dc7476e525224fbd08.html#ac906313d02c440dc7476e525224fbd08">  251</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a> &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac906313d02c440dc7476e525224fbd08.html#ac906313d02c440dc7476e525224fbd08">m_u_obs</a>;<span class="comment"></span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">  /// Storage for F(d)-u_obs</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af40c55f8691e92d032ba862a6e2989cb.html#af40c55f8691e92d032ba862a6e2989cb">  253</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566.html#ab794caff0bdd53d1e28ff6ab483bd566">StateVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af40c55f8691e92d032ba862a6e2989cb.html#af40c55f8691e92d032ba862a6e2989cb">m_u_diff</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">  /// Temporary storage used in gradient computation.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae214d16de406b622c729905866165bd1.html#ae214d16de406b622c729905866165bd1">  256</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae214d16de406b622c729905866165bd1.html#ae214d16de406b622c729905866165bd1">m_adjointRHS</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">  /// Gradient of \f$J_D\f$ at the current iterate.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aca531a5be4cd3a804bf45a0fde6a44ac.html#aca531a5be4cd3a804bf45a0fde6a44ac">  259</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aca531a5be4cd3a804bf45a0fde6a44ac.html#aca531a5be4cd3a804bf45a0fde6a44ac">m_grad_design</a>;<span class="comment"></span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">  /// Gradient of \f$J_S\f$ at the current iterate.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a5461392a3fee237ba08fd4019e9bf48b.html#a5461392a3fee237ba08fd4019e9bf48b">  261</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a5461392a3fee237ba08fd4019e9bf48b.html#a5461392a3fee237ba08fd4019e9bf48b">m_grad_state</a>;<span class="comment"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">  /** Weighted sum of the design and state gradients corresponding to</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">   * the gradient of the Tikhonov functional \f$J\f$.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa574198052ab1e4334ba94ef0f167e6f.html#aa574198052ab1e4334ba94ef0f167e6f">  265</a></span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">DesignVecPtr</a> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa574198052ab1e4334ba94ef0f167e6f.html#aa574198052ab1e4334ba94ef0f167e6f">m_grad</a>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">  ///  Penalty parameter/Lagrange multiplier.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a00b797ead0ba716fe1293d4fec2c3ac7.html#a00b797ead0ba716fe1293d4fec2c3ac7">  268</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a00b797ead0ba716fe1293d4fec2c3ac7.html#a00b797ead0ba716fe1293d4fec2c3ac7">m_eta</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">  ///  Value of \f$J_D\f$ at the current iterate.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa52148a17749a97848cf59a1ef1da7ca.html#aa52148a17749a97848cf59a1ef1da7ca">  271</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa52148a17749a97848cf59a1ef1da7ca.html#aa52148a17749a97848cf59a1ef1da7ca">m_val_design</a>;<span class="comment"></span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">  ///  Value of \f$J_S\f$ at the current iterate.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a17bf17059247681f91c70ec64092cc3a.html#a17bf17059247681f91c70ec64092cc3a">  273</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a17bf17059247681f91c70ec64092cc3a.html#a17bf17059247681f91c70ec64092cc3a">m_val_state</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">  /// Implementation of \f$J_D\f$.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af498e6f7454abb58e47984e393c9b483.html#af498e6f7454abb58e47984e393c9b483">  276</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;IceModelVec2S&gt;</a> &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af498e6f7454abb58e47984e393c9b483.html#af498e6f7454abb58e47984e393c9b483">m_designFunctional</a>;<span class="comment"></span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">  /// Implementation of \f$J_S\f$.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a89e57c715ed314d084938d1157298aae.html#a89e57c715ed314d084938d1157298aae">  278</a></span>&#160;<span class="comment"></span>  <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;IceModelVec2V&gt;</a> &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a89e57c715ed314d084938d1157298aae.html#a89e57c715ed314d084938d1157298aae">m_stateFunctional</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">  /// List of iteration callbacks.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a13132798f7377eaae11b4b19ae09ff71.html#a13132798f7377eaae11b4b19ae09ff71">  281</a></span>&#160;<span class="comment"></span>  std::vector&lt;typename IPTaoTikhonovProblemListener&lt;ForwardProblem&gt;::Ptr&gt; <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a13132798f7377eaae11b4b19ae09ff71.html#a13132798f7377eaae11b4b19ae09ff71">m_listeners</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">  /// Convergence parameter: convergence stops when \f$||J_D||_2 &lt;\f$ m_tikhonov_rtol.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a3b3dfd23c88dde03caba0ca79eb3a4ce.html#a3b3dfd23c88dde03caba0ca79eb3a4ce">  284</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a3b3dfd23c88dde03caba0ca79eb3a4ce.html#a3b3dfd23c88dde03caba0ca79eb3a4ce">m_tikhonov_atol</a>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">  /** Convergence parameter: convergence stops when \f$||J_D||_2 \f$</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">   * is less than m_tikhonov_rtol times the maximum of the gradient of</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">   * \f$J_S\f$ and \f$(1/\eta)J_D\f$. This occurs when the two terms</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">   * forming the sum of the gradient of \f$J\f$ point in roughly</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">   * opposite directions with the same magnitude.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a143983161c571dc652f34047454f288d.html#a143983161c571dc652f34047454f288d">  292</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a143983161c571dc652f34047454f288d.html#a143983161c571dc652f34047454f288d">m_tikhonov_rtol</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;};</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa.html#aee4a70d8414a699934b329a3ef7105aa">  297</a></span>&#160;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa.html#aee4a70d8414a699934b329a3ef7105aa">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::IPTaoTikhonovProblem</a>(ForwardProblem &amp;forward,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                           <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a> &amp;d0, <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a> &amp;u_obs,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                           <span class="keywordtype">double</span> eta,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                           <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;DesignVec&gt;</a> &amp;designFunctional,</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                                                           <a class="code" href="classpism_1_1inverse_1_1IPFunctional.html">IPFunctional&lt;StateVec&gt;</a> &amp;stateFunctional)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  : m_grid(d0.grid()),</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    m_forward(forward),</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    m_dGlobal(d0.grid(), <span class="stringliteral">&quot;design variable (global)&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>, d0.stencil_width()),</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    m_d0(d0),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    m_u_obs(u_obs),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    m_adjointRHS(d0.grid(), <span class="stringliteral">&quot;work vector&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>),</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    m_eta(eta),</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    m_designFunctional(designFunctional),</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    m_stateFunctional(stateFunctional)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a3b3dfd23c88dde03caba0ca79eb3a4ce.html#a3b3dfd23c88dde03caba0ca79eb3a4ce">m_tikhonov_atol</a> = <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>-&gt;ctx()-&gt;config()-&gt;get_number(<span class="stringliteral">&quot;inverse.tikhonov.atol&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a143983161c571dc652f34047454f288d.html#a143983161c571dc652f34047454f288d">m_tikhonov_rtol</a> = <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>-&gt;ctx()-&gt;config()-&gt;get_number(<span class="stringliteral">&quot;inverse.tikhonov.rtol&quot;</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">int</span> design_stencil_width = <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0.html#a9de4cc697f5ba0e81860ba64221937d0">m_d0</a>.stencil_width();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">int</span> state_stencil_width = <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac906313d02c440dc7476e525224fbd08.html#ac906313d02c440dc7476e525224fbd08">m_u_obs</a>.stencil_width();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c.html#a96f71f09e367dcdbbe4f57d398eafe2c">m_d</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;design variable&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">WITH_GHOSTS</a>, design_stencil_width));</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">m_dGlobal</a>.copy_from(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0.html#a9de4cc697f5ba0e81860ba64221937d0">m_d0</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af40c55f8691e92d032ba862a6e2989cb.html#af40c55f8691e92d032ba862a6e2989cb">m_u_diff</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">StateVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;state residual&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">WITH_GHOSTS</a>, state_stencil_width));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a597720995d702a27b9a8563343d61b46.html#a597720995d702a27b9a8563343d61b46">m_d_diff</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;design residual&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">WITH_GHOSTS</a>, design_stencil_width));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a5461392a3fee237ba08fd4019e9bf48b.html#a5461392a3fee237ba08fd4019e9bf48b">m_grad_state</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;state gradient&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>, design_stencil_width));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aca531a5be4cd3a804bf45a0fde6a44ac.html#aca531a5be4cd3a804bf45a0fde6a44ac">m_grad_design</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;design gradient&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>, design_stencil_width));</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa574198052ab1e4334ba94ef0f167e6f.html#aa574198052ab1e4334ba94ef0f167e6f">m_grad</a>.reset(<span class="keyword">new</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">DesignVec</a>(<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">m_grid</a>, <span class="stringliteral">&quot;gradient&quot;</span>, <a class="code" href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">WITHOUT_GHOSTS</a>, design_stencil_width));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt;</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391.html#acb518c3c1c627b335f02a922f4afe391">  336</a></span>&#160;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391.html#acb518c3c1c627b335f02a922f4afe391">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::~IPTaoTikhonovProblem</a>() {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// empty</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt;</div>
<div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e.html#a68e057199fe18c9fd59e8cb6ccc0e84e">  341</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e.html#a68e057199fe18c9fd59e8cb6ccc0e84e">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::connect</a>(Tao tao) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="classpism_1_1taoutil_1_1TaoObjGradCallback.html">taoutil::TaoObjGradCallback&lt;IPTaoTikhonovProblem&lt;ForwardProblem&gt;</a>,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                             &amp;<a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem.html">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::evaluateObjectiveAndGradient</a>&gt; ObjGradCallback; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  ObjGradCallback::connect(tao,*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="classpism_1_1taoutil_1_1TaoMonitorCallback.html">taoutil::TaoMonitorCallback&lt; IPTaoTikhonovProblem&lt;ForwardProblem&gt;</a> &gt;::connect(tao,*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="classpism_1_1taoutil_1_1TaoConvergenceCallback.html">taoutil::TaoConvergenceCallback&lt; IPTaoTikhonovProblem&lt;ForwardProblem&gt;</a> &gt;::connect(tao,*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">double</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    gatol = PETSC_DEFAULT,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    grtol = PETSC_DEFAULT,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    gttol = PETSC_DEFAULT;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#if PETSC_VERSION_LT(3,7,0)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordtype">double</span> fatol = 1e-10, frtol = 1e-20;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  PetscErrorCode ierr = TaoSetTolerances(tao, fatol, frtol, gatol, grtol, gttol);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;TaoSetTolerances&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  PetscErrorCode ierr = TaoSetTolerances(tao, gatol, grtol, gttol);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;TaoSetTolerances&quot;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;}</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt;</div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9.html#ae6a1aee0fa51158fe135ad508d627af9">  367</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9.html#ae6a1aee0fa51158fe135ad508d627af9">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::monitorTao</a>(Tao tao) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  PetscInt its;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  TaoGetSolutionStatus(tao, &amp;its, NULL, NULL, NULL, NULL, NULL);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordtype">int</span> nListeners = m_listeners.size();</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>=0; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>&lt;nListeners; <a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>++) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    m_listeners[<a class="code" href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">k</a>]-&gt;iteration(*<span class="keyword">this</span>, m_eta,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                              its, m_val_design, m_val_state,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                              m_d, m_d_diff, m_grad_design,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                              m_forward.solution(), m_u_diff, m_grad_state,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                              m_grad);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de.html#a138b20abb431a05b58dc76771785e0de">  381</a></span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt; <span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de.html#a138b20abb431a05b58dc76771785e0de">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::convergenceTest</a>(Tao tao) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordtype">double</span> designNorm, stateNorm, sumNorm;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordtype">double</span> dWeight, sWeight;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  dWeight = 1/m_eta;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  sWeight = 1;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  designNorm = m_grad_design-&gt;norm(NORM_2)[0];</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  stateNorm  = m_grad_state-&gt;norm(NORM_2)[0];</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  sumNorm    = m_grad-&gt;norm(NORM_2)[0];</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  designNorm *= dWeight;    </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  stateNorm  *= sWeight;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keywordflow">if</span> (sumNorm &lt; m_tikhonov_atol) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    TaoSetConvergedReason(tao, TAO_CONVERGED_GATOL);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sumNorm &lt; m_tikhonov_rtol*<a class="code" href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">std::max</a>(designNorm,stateNorm)) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    TaoSetConvergedReason(tao, TAO_CONVERGED_USER);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    TaoDefaultConvergenceTest(tao, NULL);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ForwardProblem&gt;</div>
<div class="line"><a name="l00404"></a><span class="lineno"><a class="line" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e.html#a940cdc2a9b098911afdf40e55b4d9e7e">  404</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e.html#a940cdc2a9b098911afdf40e55b4d9e7e">IPTaoTikhonovProblem&lt;ForwardProblem&gt;::evaluateObjectiveAndGradient</a>(Tao tao, Vec x,</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                                                        <span class="keywordtype">double</span> *value, Vec gradient) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  PetscErrorCode ierr;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Variable &#39;x&#39; has no ghosts.  We need ghosts for computation with the design variable.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    ierr = DMGlobalToLocalBegin(*m_d-&gt;dm(), x, INSERT_VALUES, m_d-&gt;vec());</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;DMGlobalToLocalBegin&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    ierr = DMGlobalToLocalEnd(*m_d-&gt;dm(), x, INSERT_VALUES, m_d-&gt;vec());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;DMGlobalToLocalEnd&quot;</span>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="classpism_1_1TerminationReason_a1477a9427838815f537ee44d6df00c3e.html#a1477a9427838815f537ee44d6df00c3e">TerminationReason::Ptr</a> reason = m_forward.linearize_at(*m_d);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (reason-&gt;failed()) {</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="classpism_1_1Logger_a18135415c4090dc0f946beca43fdcc76.html#a18135415c4090dc0f946beca43fdcc76">Logger::ConstPtr</a> log = m_grid-&gt;ctx()-&gt;log();</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    log-&gt;message(2,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                 <span class="stringliteral">&quot;IPTaoTikhonovProblem::evaluateObjectiveAndGradient&quot;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                 <span class="stringliteral">&quot; failure in forward solve\n%s\n&quot;</span>, reason-&gt;description().c_str());</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ierr = TaoSetConvergedReason(tao, TAO_DIVERGED_USER);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;TaoSetConvergedReason&quot;</span>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  m_d_diff-&gt;copy_from(*m_d);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  m_d_diff-&gt;add(-1, m_d0);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  m_designFunctional.gradientAt(*m_d_diff, *m_grad_design);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  m_u_diff-&gt;copy_from(*m_forward.solution());</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  m_u_diff-&gt;add(-1, m_u_obs);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// The following computes the reduced gradient.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  m_stateFunctional.gradientAt(*m_u_diff, m_adjointRHS);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  m_forward.apply_linearization_transpose(m_adjointRHS, *m_grad_state);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  m_grad-&gt;copy_from(*m_grad_design);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  m_grad-&gt;scale(1.0 / m_eta);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  m_grad-&gt;add(1, *m_grad_state);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  ierr = VecCopy(m_grad-&gt;vec(), gradient);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a>(ierr, <span class="stringliteral">&quot;VecCopy&quot;</span>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordtype">double</span> valDesign, valState;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  m_designFunctional.valueAt(*m_d_diff, &amp;valDesign);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  m_stateFunctional.valueAt(*m_u_diff, &amp;valState);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  m_val_design = valDesign;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  m_val_state = valState;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  *value = valDesign / m_eta + valState;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;} <span class="comment">// end of namespace inverse</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;} <span class="comment">// end of namespace pism</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* end of include guard: IPTAOTIKHONOVPROBLEM_HH_4NMM724B */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aIPFunctional_8hh_html"><div class="ttname"><a href="IPFunctional_8hh.html">IPFunctional.hh</a></div></div>
<div class="ttc" id="aTaoUtil_8hh_html"><div class="ttname"><a href="TaoUtil_8hh.html">TaoUtil.hh</a></div></div>
<div class="ttc" id="aclasspism_1_1GenericTerminationReason_acafda70bc8691ed81c472a2375084c25_html_acafda70bc8691ed81c472a2375084c25"><div class="ttname"><a href="classpism_1_1GenericTerminationReason_acafda70bc8691ed81c472a2375084c25.html#acafda70bc8691ed81c472a2375084c25">pism::GenericTerminationReason::success</a></div><div class="ttdeci">static TerminationReason::Ptr success()</div><div class="ttdef"><b>Definition:</b> <a href="TerminationReason_8hh_source.html#l00141">TerminationReason.hh:141</a></div></div>
<div class="ttc" id="aclasspism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac_html_aa59b13ca1f14efc1555016e2b8a8b1ac"><div class="ttname"><a href="classpism_1_1IceGrid_aa59b13ca1f14efc1555016e2b8a8b1ac.html#aa59b13ca1f14efc1555016e2b8a8b1ac">pism::IceGrid::ConstPtr</a></div><div class="ttdeci">std::shared_ptr&lt; const IceGrid &gt; ConstPtr</div><div class="ttdef"><b>Definition:</b> <a href="IceGrid_8hh_source.html#l00233">IceGrid.hh:233</a></div></div>
<div class="ttc" id="aclasspism_1_1Logger_a18135415c4090dc0f946beca43fdcc76_html_a18135415c4090dc0f946beca43fdcc76"><div class="ttname"><a href="classpism_1_1Logger_a18135415c4090dc0f946beca43fdcc76.html#a18135415c4090dc0f946beca43fdcc76">pism::Logger::ConstPtr</a></div><div class="ttdeci">std::shared_ptr&lt; const Logger &gt; ConstPtr</div><div class="ttdef"><b>Definition:</b> <a href="Logger_8hh_source.html#l00046">Logger.hh:46</a></div></div>
<div class="ttc" id="aclasspism_1_1TerminationReason_a1477a9427838815f537ee44d6df00c3e_html_a1477a9427838815f537ee44d6df00c3e"><div class="ttname"><a href="classpism_1_1TerminationReason_a1477a9427838815f537ee44d6df00c3e.html#a1477a9427838815f537ee44d6df00c3e">pism::TerminationReason::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; TerminationReason &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="TerminationReason_8hh_source.html#l00044">TerminationReason.hh:44</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPFunctional_html"><div class="ttname"><a href="classpism_1_1inverse_1_1IPFunctional.html">pism::inverse::IPFunctional</a></div><div class="ttdoc">Abstract base class for functions from ice model vectors to .</div><div class="ttdef"><b>Definition:</b> <a href="IPFunctional_8hh_source.html#l00040">IPFunctional.hh:40</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd_html_a072120bdbc646a59ef7bff1a7775a6cd"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a072120bdbc646a59ef7bff1a7775a6cd.html#a072120bdbc646a59ef7bff1a7775a6cd">pism::inverse::IPTaoTikhonovProblemListener::StateVecPtr</a></div><div class="ttdeci">ForwardProblem::StateVec::Ptr StateVecPtr</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00054">IPTaoTikhonovProblem.hh:54</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a1555be9a95a5f5f81cb09f3a102f0ae0_html_a1555be9a95a5f5f81cb09f3a102f0ae0"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a1555be9a95a5f5f81cb09f3a102f0ae0.html#a1555be9a95a5f5f81cb09f3a102f0ae0">pism::inverse::IPTaoTikhonovProblemListener::Ptr</a></div><div class="ttdeci">std::shared_ptr&lt; IPTaoTikhonovProblemListener &gt; Ptr</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00050">IPTaoTikhonovProblem.hh:50</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546_html_a28bdabc482faaaef187bc8c512bf1546"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a28bdabc482faaaef187bc8c512bf1546.html#a28bdabc482faaaef187bc8c512bf1546">pism::inverse::IPTaoTikhonovProblemListener::DesignVecPtr</a></div><div class="ttdeci">ForwardProblem::DesignVec::Ptr DesignVecPtr</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00053">IPTaoTikhonovProblem.hh:53</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a62a824aa5299555d21590e68266bf063_html_a62a824aa5299555d21590e68266bf063"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a62a824aa5299555d21590e68266bf063.html#a62a824aa5299555d21590e68266bf063">pism::inverse::IPTaoTikhonovProblemListener::iteration</a></div><div class="ttdeci">virtual void iteration(IPTaoTikhonovProblem&lt; ForwardProblem &gt; &amp;problem, double eta, int iter, double objectiveValue, double designValue, const DesignVecPtr d, const DesignVecPtr diff_d, const DesignVecPtr grad_d, const StateVecPtr u, const StateVecPtr diff_u, const DesignVecPtr grad_u, const DesignVecPtr gradient)=0</div><div class="ttdoc">The method called after each minimization iteration.</div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a6fa50f3a53fa61ce02411552106f5a6b_html_a6fa50f3a53fa61ce02411552106f5a6b"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a6fa50f3a53fa61ce02411552106f5a6b.html#a6fa50f3a53fa61ce02411552106f5a6b">pism::inverse::IPTaoTikhonovProblemListener::IPTaoTikhonovProblemListener</a></div><div class="ttdeci">IPTaoTikhonovProblemListener()</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00056">IPTaoTikhonovProblem.hh:56</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_a9992ed7a78ce4bbbff899fba618de735_html_a9992ed7a78ce4bbbff899fba618de735"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener_a9992ed7a78ce4bbbff899fba618de735.html#a9992ed7a78ce4bbbff899fba618de735">pism::inverse::IPTaoTikhonovProblemListener::~IPTaoTikhonovProblemListener</a></div><div class="ttdeci">virtual ~IPTaoTikhonovProblemListener()</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00057">IPTaoTikhonovProblem.hh:57</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblemListener_html"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblemListener.html">pism::inverse::IPTaoTikhonovProblemListener</a></div><div class="ttdoc">Iteration callback class for IPTaoTikhonovProblem.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00048">IPTaoTikhonovProblem.hh:48</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a00b797ead0ba716fe1293d4fec2c3ac7_html_a00b797ead0ba716fe1293d4fec2c3ac7"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a00b797ead0ba716fe1293d4fec2c3ac7.html#a00b797ead0ba716fe1293d4fec2c3ac7">pism::inverse::IPTaoTikhonovProblem::m_eta</a></div><div class="ttdeci">double m_eta</div><div class="ttdoc">Penalty parameter/Lagrange multiplier.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00268">IPTaoTikhonovProblem.hh:268</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a13132798f7377eaae11b4b19ae09ff71_html_a13132798f7377eaae11b4b19ae09ff71"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a13132798f7377eaae11b4b19ae09ff71.html#a13132798f7377eaae11b4b19ae09ff71">pism::inverse::IPTaoTikhonovProblem::m_listeners</a></div><div class="ttdeci">std::vector&lt; typename IPTaoTikhonovProblemListener&lt; ForwardProblem &gt;::Ptr &gt; m_listeners</div><div class="ttdoc">List of iteration callbacks.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00281">IPTaoTikhonovProblem.hh:281</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de_html_a138b20abb431a05b58dc76771785e0de"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a138b20abb431a05b58dc76771785e0de.html#a138b20abb431a05b58dc76771785e0de">pism::inverse::IPTaoTikhonovProblem::convergenceTest</a></div><div class="ttdeci">virtual void convergenceTest(Tao tao)</div><div class="ttdoc">Callback from TAO to detect convergence. Allows us to implement a custom convergence check.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00381">IPTaoTikhonovProblem.hh:381</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a143983161c571dc652f34047454f288d_html_a143983161c571dc652f34047454f288d"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a143983161c571dc652f34047454f288d.html#a143983161c571dc652f34047454f288d">pism::inverse::IPTaoTikhonovProblem::m_tikhonov_rtol</a></div><div class="ttdeci">double m_tikhonov_rtol</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00292">IPTaoTikhonovProblem.hh:292</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a17bf17059247681f91c70ec64092cc3a_html_a17bf17059247681f91c70ec64092cc3a"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a17bf17059247681f91c70ec64092cc3a.html#a17bf17059247681f91c70ec64092cc3a">pism::inverse::IPTaoTikhonovProblem::m_val_state</a></div><div class="ttdeci">double m_val_state</div><div class="ttdoc">Value of  at the current iterate.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00273">IPTaoTikhonovProblem.hh:273</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a1bd5d6d3633d3481335d5ae8d0eb9bc5_html_a1bd5d6d3633d3481335d5ae8d0eb9bc5"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a1bd5d6d3633d3481335d5ae8d0eb9bc5.html#a1bd5d6d3633d3481335d5ae8d0eb9bc5">pism::inverse::IPTaoTikhonovProblem::m_forward</a></div><div class="ttdeci">ForwardProblem &amp; m_forward</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00239">IPTaoTikhonovProblem.hh:239</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2_html_a20a462fc1a99ea56ad776b8d287d37d2"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a20a462fc1a99ea56ad776b8d287d37d2.html#a20a462fc1a99ea56ad776b8d287d37d2">pism::inverse::IPTaoTikhonovProblem::DesignVecPtr</a></div><div class="ttdeci">ForwardProblem::DesignVec::Ptr DesignVecPtr</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00171">IPTaoTikhonovProblem.hh:171</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a2600a14b65a262665851b80e619ca435_html_a2600a14b65a262665851b80e619ca435"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a2600a14b65a262665851b80e619ca435.html#a2600a14b65a262665851b80e619ca435">pism::inverse::IPTaoTikhonovProblem::addListener</a></div><div class="ttdeci">virtual void addListener(typename IPTaoTikhonovProblemListener&lt; ForwardProblem &gt;::Ptr listener)</div><div class="ttdoc">Add an object to the list of objects to be called after each iteration.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00204">IPTaoTikhonovProblem.hh:204</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a3b3dfd23c88dde03caba0ca79eb3a4ce_html_a3b3dfd23c88dde03caba0ca79eb3a4ce"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a3b3dfd23c88dde03caba0ca79eb3a4ce.html#a3b3dfd23c88dde03caba0ca79eb3a4ce">pism::inverse::IPTaoTikhonovProblem::m_tikhonov_atol</a></div><div class="ttdeci">double m_tikhonov_atol</div><div class="ttdoc">Convergence parameter: convergence stops when  m_tikhonov_rtol.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00284">IPTaoTikhonovProblem.hh:284</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a5461392a3fee237ba08fd4019e9bf48b_html_a5461392a3fee237ba08fd4019e9bf48b"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a5461392a3fee237ba08fd4019e9bf48b.html#a5461392a3fee237ba08fd4019e9bf48b">pism::inverse::IPTaoTikhonovProblem::m_grad_state</a></div><div class="ttdeci">DesignVecPtr m_grad_state</div><div class="ttdoc">Gradient of  at the current iterate.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00261">IPTaoTikhonovProblem.hh:261</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a57f48f254a266edf33fa71c2c3f81134_html_a57f48f254a266edf33fa71c2c3f81134"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a57f48f254a266edf33fa71c2c3f81134.html#a57f48f254a266edf33fa71c2c3f81134">pism::inverse::IPTaoTikhonovProblem::setInitialGuess</a></div><div class="ttdeci">virtual void setInitialGuess(DesignVec &amp;d)</div><div class="ttdoc">Sets the initial guess for minimization iterations. If this isn't set explicitly,.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00196">IPTaoTikhonovProblem.hh:196</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a597720995d702a27b9a8563343d61b46_html_a597720995d702a27b9a8563343d61b46"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a597720995d702a27b9a8563343d61b46.html#a597720995d702a27b9a8563343d61b46">pism::inverse::IPTaoTikhonovProblem::m_d_diff</a></div><div class="ttdeci">DesignVecPtr m_d_diff</div><div class="ttdoc">Storage for (m_d-m_d0)</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00248">IPTaoTikhonovProblem.hh:248</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e_html_a68e057199fe18c9fd59e8cb6ccc0e84e"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a68e057199fe18c9fd59e8cb6ccc0e84e.html#a68e057199fe18c9fd59e8cb6ccc0e84e">pism::inverse::IPTaoTikhonovProblem::connect</a></div><div class="ttdeci">virtual void connect(Tao tao)</div><div class="ttdoc">Callback from TaoBasicSolver, used to wire the connections between a Tao and.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00341">IPTaoTikhonovProblem.hh:341</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a89e57c715ed314d084938d1157298aae_html_a89e57c715ed314d084938d1157298aae"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a89e57c715ed314d084938d1157298aae.html#a89e57c715ed314d084938d1157298aae">pism::inverse::IPTaoTikhonovProblem::m_stateFunctional</a></div><div class="ttdeci">IPFunctional&lt; IceModelVec2V &gt; &amp; m_stateFunctional</div><div class="ttdoc">Implementation of .</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00278">IPTaoTikhonovProblem.hh:278</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e_html_a940cdc2a9b098911afdf40e55b4d9e7e"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a940cdc2a9b098911afdf40e55b4d9e7e.html#a940cdc2a9b098911afdf40e55b4d9e7e">pism::inverse::IPTaoTikhonovProblem::evaluateObjectiveAndGradient</a></div><div class="ttdeci">virtual void evaluateObjectiveAndGradient(Tao tao, Vec x, double *value, Vec gradient)</div><div class="ttdoc">Callback provided to TAO for objective evaluation.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00404">IPTaoTikhonovProblem.hh:404</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c_html_a96f71f09e367dcdbbe4f57d398eafe2c"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a96f71f09e367dcdbbe4f57d398eafe2c.html#a96f71f09e367dcdbbe4f57d398eafe2c">pism::inverse::IPTaoTikhonovProblem::m_d</a></div><div class="ttdeci">DesignVecPtr m_d</div><div class="ttdoc">Current iterate of design parameter.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00242">IPTaoTikhonovProblem.hh:242</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152_html_a9c074a779759c682d0afa9af53708152"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9c074a779759c682d0afa9af53708152.html#a9c074a779759c682d0afa9af53708152">pism::inverse::IPTaoTikhonovProblem::DesignVec</a></div><div class="ttdeci">ForwardProblem::DesignVec DesignVec</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00168">IPTaoTikhonovProblem.hh:168</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0_html_a9de4cc697f5ba0e81860ba64221937d0"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_a9de4cc697f5ba0e81860ba64221937d0.html#a9de4cc697f5ba0e81860ba64221937d0">pism::inverse::IPTaoTikhonovProblem::m_d0</a></div><div class="ttdeci">DesignVec &amp; m_d0</div><div class="ttdoc">A-priori estimate of design parameter.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00246">IPTaoTikhonovProblem.hh:246</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_aa52148a17749a97848cf59a1ef1da7ca_html_aa52148a17749a97848cf59a1ef1da7ca"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa52148a17749a97848cf59a1ef1da7ca.html#aa52148a17749a97848cf59a1ef1da7ca">pism::inverse::IPTaoTikhonovProblem::m_val_design</a></div><div class="ttdeci">double m_val_design</div><div class="ttdoc">Value of  at the current iterate.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00271">IPTaoTikhonovProblem.hh:271</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_aa574198052ab1e4334ba94ef0f167e6f_html_aa574198052ab1e4334ba94ef0f167e6f"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aa574198052ab1e4334ba94ef0f167e6f.html#aa574198052ab1e4334ba94ef0f167e6f">pism::inverse::IPTaoTikhonovProblem::m_grad</a></div><div class="ttdeci">DesignVecPtr m_grad</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00265">IPTaoTikhonovProblem.hh:265</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046_html_aac0600bed8994c58dd96f1641900c046"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aac0600bed8994c58dd96f1641900c046.html#aac0600bed8994c58dd96f1641900c046">pism::inverse::IPTaoTikhonovProblem::StateVec</a></div><div class="ttdeci">ForwardProblem::StateVec StateVec</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00169">IPTaoTikhonovProblem.hh:169</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26_html_ab066034485cefff4d9547cc365f7cf26"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab066034485cefff4d9547cc365f7cf26.html#ab066034485cefff4d9547cc365f7cf26">pism::inverse::IPTaoTikhonovProblem::m_grid</a></div><div class="ttdeci">IceGrid::ConstPtr m_grid</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00237">IPTaoTikhonovProblem.hh:237</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566_html_ab794caff0bdd53d1e28ff6ab483bd566"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ab794caff0bdd53d1e28ff6ab483bd566.html#ab794caff0bdd53d1e28ff6ab483bd566">pism::inverse::IPTaoTikhonovProblem::StateVecPtr</a></div><div class="ttdeci">ForwardProblem::StateVec::Ptr StateVecPtr</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00172">IPTaoTikhonovProblem.hh:172</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ac06b84b9acc75cf95e8d73dd78509ded_html_ac06b84b9acc75cf95e8d73dd78509ded"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac06b84b9acc75cf95e8d73dd78509ded.html#ac06b84b9acc75cf95e8d73dd78509ded">pism::inverse::IPTaoTikhonovProblem::designSolution</a></div><div class="ttdeci">virtual DesignVecPtr designSolution()</div><div class="ttdoc">Value of , the solution of the minimization problem.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00214">IPTaoTikhonovProblem.hh:214</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ac2901aa76eac4a26b1a4144454d3a1f7_html_ac2901aa76eac4a26b1a4144454d3a1f7"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac2901aa76eac4a26b1a4144454d3a1f7.html#ac2901aa76eac4a26b1a4144454d3a1f7">pism::inverse::IPTaoTikhonovProblem::formInitialGuess</a></div><div class="ttdeci">virtual TerminationReason::Ptr formInitialGuess(Vec *v)</div><div class="ttdoc">Callback from TaoBasicSolver to form the starting iterate for the minimization. See also.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00230">IPTaoTikhonovProblem.hh:230</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ac906313d02c440dc7476e525224fbd08_html_ac906313d02c440dc7476e525224fbd08"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ac906313d02c440dc7476e525224fbd08.html#ac906313d02c440dc7476e525224fbd08">pism::inverse::IPTaoTikhonovProblem::m_u_obs</a></div><div class="ttdeci">StateVec &amp; m_u_obs</div><div class="ttdoc">State parameter to match via F(d)=u_obs.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00251">IPTaoTikhonovProblem.hh:251</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_aca531a5be4cd3a804bf45a0fde6a44ac_html_aca531a5be4cd3a804bf45a0fde6a44ac"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aca531a5be4cd3a804bf45a0fde6a44ac.html#aca531a5be4cd3a804bf45a0fde6a44ac">pism::inverse::IPTaoTikhonovProblem::m_grad_design</a></div><div class="ttdeci">DesignVecPtr m_grad_design</div><div class="ttdoc">Gradient of  at the current iterate.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00259">IPTaoTikhonovProblem.hh:259</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391_html_acb518c3c1c627b335f02a922f4afe391"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acb518c3c1c627b335f02a922f4afe391.html#acb518c3c1c627b335f02a922f4afe391">pism::inverse::IPTaoTikhonovProblem::~IPTaoTikhonovProblem</a></div><div class="ttdeci">virtual ~IPTaoTikhonovProblem()</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00336">IPTaoTikhonovProblem.hh:336</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5_html_acd3d4339ffa7ba9db5457425629e34b5"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_acd3d4339ffa7ba9db5457425629e34b5.html#acd3d4339ffa7ba9db5457425629e34b5">pism::inverse::IPTaoTikhonovProblem::m_dGlobal</a></div><div class="ttdeci">DesignVec m_dGlobal</div><div class="ttdoc">Initial iterate of design parameter, stored without ghosts for the benefit of TAO.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00244">IPTaoTikhonovProblem.hh:244</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ae214d16de406b622c729905866165bd1_html_ae214d16de406b622c729905866165bd1"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae214d16de406b622c729905866165bd1.html#ae214d16de406b622c729905866165bd1">pism::inverse::IPTaoTikhonovProblem::m_adjointRHS</a></div><div class="ttdeci">StateVec m_adjointRHS</div><div class="ttdoc">Temporary storage used in gradient computation.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00256">IPTaoTikhonovProblem.hh:256</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9_html_ae6a1aee0fa51158fe135ad508d627af9"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_ae6a1aee0fa51158fe135ad508d627af9.html#ae6a1aee0fa51158fe135ad508d627af9">pism::inverse::IPTaoTikhonovProblem::monitorTao</a></div><div class="ttdeci">virtual void monitorTao(Tao tao)</div><div class="ttdoc">Callback from TAO after each iteration. The call is forwarded to each element of our list of listener...</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00367">IPTaoTikhonovProblem.hh:367</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa_html_aee4a70d8414a699934b329a3ef7105aa"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_aee4a70d8414a699934b329a3ef7105aa.html#aee4a70d8414a699934b329a3ef7105aa">pism::inverse::IPTaoTikhonovProblem::IPTaoTikhonovProblem</a></div><div class="ttdeci">IPTaoTikhonovProblem(ForwardProblem &amp;forward, DesignVec &amp;d0, StateVec &amp;u_obs, double eta, IPFunctional&lt; DesignVec &gt; &amp;designFunctional, IPFunctional&lt; StateVec &gt; &amp;stateFunctional)</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00297">IPTaoTikhonovProblem.hh:297</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_af40c55f8691e92d032ba862a6e2989cb_html_af40c55f8691e92d032ba862a6e2989cb"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af40c55f8691e92d032ba862a6e2989cb.html#af40c55f8691e92d032ba862a6e2989cb">pism::inverse::IPTaoTikhonovProblem::m_u_diff</a></div><div class="ttdeci">StateVecPtr m_u_diff</div><div class="ttdoc">Storage for F(d)-u_obs.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00253">IPTaoTikhonovProblem.hh:253</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_af498e6f7454abb58e47984e393c9b483_html_af498e6f7454abb58e47984e393c9b483"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af498e6f7454abb58e47984e393c9b483.html#af498e6f7454abb58e47984e393c9b483">pism::inverse::IPTaoTikhonovProblem::m_designFunctional</a></div><div class="ttdeci">IPFunctional&lt; IceModelVec2S &gt; &amp; m_designFunctional</div><div class="ttdoc">Implementation of .</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00276">IPTaoTikhonovProblem.hh:276</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_af557b18cf4ecbf3ed234349f10e3015f_html_af557b18cf4ecbf3ed234349f10e3015f"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem_af557b18cf4ecbf3ed234349f10e3015f.html#af557b18cf4ecbf3ed234349f10e3015f">pism::inverse::IPTaoTikhonovProblem::stateSolution</a></div><div class="ttdeci">virtual StateVecPtr stateSolution()</div><div class="ttdoc">Final value of , where  is the solution of the minimization.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00209">IPTaoTikhonovProblem.hh:209</a></div></div>
<div class="ttc" id="aclasspism_1_1inverse_1_1IPTaoTikhonovProblem_html"><div class="ttname"><a href="classpism_1_1inverse_1_1IPTaoTikhonovProblem.html">pism::inverse::IPTaoTikhonovProblem</a></div><div class="ttdoc">Defines a Tikhonov minimization problem to be solved with a TaoBasicSolver.</div><div class="ttdef"><b>Definition:</b> <a href="IPTaoTikhonovProblem_8hh_source.html#l00164">IPTaoTikhonovProblem.hh:165</a></div></div>
<div class="ttc" id="aclasspism_1_1taoutil_1_1TaoConvergenceCallback_html"><div class="ttname"><a href="classpism_1_1taoutil_1_1TaoConvergenceCallback.html">pism::taoutil::TaoConvergenceCallback</a></div><div class="ttdoc">Adaptor to connect a TAO objective function callback to a C++ object method.</div><div class="ttdef"><b>Definition:</b> <a href="TaoUtil_8hh_source.html#l00363">TaoUtil.hh:363</a></div></div>
<div class="ttc" id="aclasspism_1_1taoutil_1_1TaoMonitorCallback_html"><div class="ttname"><a href="classpism_1_1taoutil_1_1TaoMonitorCallback.html">pism::taoutil::TaoMonitorCallback</a></div><div class="ttdoc">Adaptor to connect a TAO monitoring callback to a C++ object method.</div><div class="ttdef"><b>Definition:</b> <a href="TaoUtil_8hh_source.html#l00230">TaoUtil.hh:230</a></div></div>
<div class="ttc" id="aclasspism_1_1taoutil_1_1TaoObjGradCallback_html"><div class="ttname"><a href="classpism_1_1taoutil_1_1TaoObjGradCallback.html">pism::taoutil::TaoObjGradCallback</a></div><div class="ttdoc">Adaptor to connect a TAO objective and gradient function callback to a C++ object method.</div><div class="ttdef"><b>Definition:</b> <a href="TaoUtil_8hh_source.html#l00407">TaoUtil.hh:407</a></div></div>
<div class="ttc" id="aerror__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad_html_a970ec877c0e54c6e16c039bfa1b88bad"><div class="ttname"><a href="error__handling_8hh_a970ec877c0e54c6e16c039bfa1b88bad.html#a970ec877c0e54c6e16c039bfa1b88bad">PISM_CHK</a></div><div class="ttdeci">#define PISM_CHK(errcode, name)</div><div class="ttdef"><b>Definition:</b> <a href="error__handling_8hh_source.html#l00091">error_handling.hh:91</a></div></div>
<div class="ttc" id="anamespacepism_1_1inverse_a16bd15a34127cc491455ba03e95c30ae_html_a16bd15a34127cc491455ba03e95c30ae"><div class="ttname"><a href="namespacepism_1_1inverse_a16bd15a34127cc491455ba03e95c30ae.html#a16bd15a34127cc491455ba03e95c30ae">pism::inverse::DesignVec</a></div><div class="ttdeci">IceModelVec2S DesignVec</div><div class="ttdef"><b>Definition:</b> <a href="IP__SSATaucTaoTikhonovProblemLCL_8cc_source.html#l00027">IP_SSATaucTaoTikhonovProblemLCL.cc:27</a></div></div>
<div class="ttc" id="anamespacepism_1_1inverse_a87a083e9db7f2fbc1ee5ed79cbb9a5d7_html_a87a083e9db7f2fbc1ee5ed79cbb9a5d7"><div class="ttname"><a href="namespacepism_1_1inverse_a87a083e9db7f2fbc1ee5ed79cbb9a5d7.html#a87a083e9db7f2fbc1ee5ed79cbb9a5d7">pism::inverse::StateVec</a></div><div class="ttdeci">IceModelVec2V StateVec</div><div class="ttdef"><b>Definition:</b> <a href="IP__SSATaucTaoTikhonovProblemLCL_8cc_source.html#l00028">IP_SSATaucTaoTikhonovProblemLCL.cc:28</a></div></div>
<div class="ttc" id="anamespacepism_a1c38bf61f42eeb099d3356ab93fefb5b_html_a1c38bf61f42eeb099d3356ab93fefb5b"><div class="ttname"><a href="namespacepism_a1c38bf61f42eeb099d3356ab93fefb5b.html#a1c38bf61f42eeb099d3356ab93fefb5b">pism::max</a></div><div class="ttdeci">double max(const IceModelVec2S &amp;input)</div><div class="ttdoc">Finds maximum over all the values in an IceModelVec2S object. Ignores ghosts.</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec2_8cc_source.html#l00191">iceModelVec2.cc:191</a></div></div>
<div class="ttc" id="anamespacepism_a7343afff8d353b59dbdec563bd896812_html_a7343afff8d353b59dbdec563bd896812"><div class="ttname"><a href="namespacepism_a7343afff8d353b59dbdec563bd896812.html#a7343afff8d353b59dbdec563bd896812">pism::k</a></div><div class="ttdeci">static const double k</div><div class="ttdef"><b>Definition:</b> <a href="exactTestP_8cc_source.html#l00045">exactTestP.cc:45</a></div></div>
<div class="ttc" id="anamespacepism_af0700c6771420c20ac873c2779475d57_html_af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9"><div class="ttname"><a href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57a64e797222853badb3592d5d01f623da9">pism::WITHOUT_GHOSTS</a></div><div class="ttdeci">@ WITHOUT_GHOSTS</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00049">iceModelVec.hh:49</a></div></div>
<div class="ttc" id="anamespacepism_af0700c6771420c20ac873c2779475d57_html_af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3"><div class="ttname"><a href="namespacepism_af0700c6771420c20ac873c2779475d57.html#af0700c6771420c20ac873c2779475d57adad77f6206cd0215efe0cbcfbf57c0d3">pism::WITH_GHOSTS</a></div><div class="ttdeci">@ WITH_GHOSTS</div><div class="ttdef"><b>Definition:</b> <a href="iceModelVec_8hh_source.html#l00049">iceModelVec.hh:49</a></div></div>
<div class="ttc" id="anamespacepism_html"><div class="ttname"><a href="namespacepism.html">pism</a></div><div class="ttdef"><b>Definition:</b> <a href="AgeColumnSystem_8cc_source.html#l00024">AgeColumnSystem.cc:24</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
