<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PISM, A Parallel Ice Sheet Model: pism::AgeModel::update</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="browser.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PISM, A Parallel Ice Sheet Model
   &#160;<span id="projectnumber">stable v2.1-1-g6902d5502 committed by Ed Bueler on 2023-12-20 08:38:27 -0800</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepism.html">pism</a></li><li class="navelem"><a class="el" href="classpism_1_1AgeModel.html">AgeModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="contents">
<table cellspacing="0" cellpadding="0" border="0">
  <tr>
   <td valign="top">
      <div class="navtab">
        <table>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a99bba09ffa5ebf65fd134046ab088215.html#a99bba09ffa5ebf65fd134046ab088215">age</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a35942a52ef43e4888b6233be0f2b7223.html#a35942a52ef43e4888b6233be0f2b7223">AgeModel</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a06c55a1925b7e2b4497f11b14b81929f.html#a06c55a1925b7e2b4497f11b14b81929f">define_model_state_impl</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_ae481458c40e7f475459608351fb9b03d.html#ae481458c40e7f475459608351fb9b03d">init</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a0a4e7ebc58694d40cfb11373659dae16.html#a0a4e7ebc58694d40cfb11373659dae16">m_ice_age</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a4760c33bae01cbff5e411e150bf6e17a.html#a4760c33bae01cbff5e411e150bf6e17a">m_stress_balance</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a5275eded2a708da7169851cc2a80a445.html#a5275eded2a708da7169851cc2a80a445">m_work</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_a92bf232666aca98064f0cc162fbbde62.html#a92bf232666aca98064f0cc162fbbde62">max_timestep_impl</a></td></tr>
          <tr><td class="navtabHL"><a class="navtab" href="classpism_1_1AgeModel_afbd21474c2ec641251ebaa77a4dfd6cc.html#afbd21474c2ec641251ebaa77a4dfd6cc">update</a></td></tr>
          <tr><td class="navtab"><a class="navtab" href="classpism_1_1AgeModel_ac9123c74eaec3dc86680fd48fbf858f5.html#ac9123c74eaec3dc86680fd48fbf858f5">write_model_state_impl</a></td></tr>
        </table>
      </div>
   </td>
   <td valign="top" class="mempage">
<a id="afbd21474c2ec641251ebaa77a4dfd6cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbd21474c2ec641251ebaa77a4dfd6cc">&#9670;&nbsp;</a></span>update()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pism::AgeModel::update </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classpism_1_1AgeModelInputs.html">AgeModelInputs</a> &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Let \(\tau(t,x,y,z)\) be the age of the ice. Denote the three-dimensional velocity field within the ice fluid as \((u,v,w)\). The age equation is \(d\tau/dt = 1\), that is, ice may move but it gets one year older in one year. Thus </p><p class="formulaDsp">
\[ \frac{\partial \tau}{\partial t} + u \frac{\partial \tau}{\partial x} + v \frac{\partial \tau}{\partial y} + w \frac{\partial \tau}{\partial z} = 1 \]
</p>
<p> This equation is purely advective and hyperbolic. The right-hand side is "1" as long as age \(\tau\) and time \(t\) are measured in the same units. Because the velocity field is incompressible, \(\nabla \cdot (u,v,w) = 0\), we can rewrite the equation as </p><p class="formulaDsp">
\[ \frac{\partial \tau}{\partial t} + \nabla \left( (u,v,w) \tau \right) = 1 \]
</p>
<p> There is a conservative first-order numerical method; see AgeColumnSystem::solveThisColumn().</p>
<p>The boundary condition is that when the ice falls as snow it has age zero. That is, \(\tau(t,x,y,h(t,x,y)) = 0\) in accumulation areas. There is no boundary condition elsewhere on the ice upper surface, as the characteristics go outward in the ablation zone. If the velocity in the bottom cell of ice is upward ( \(w&gt;0\)) then we also apply a zero age boundary condition, \(\tau(t,x,y,0) = 0\). This is the case where ice freezes on at the base, either grounded basal ice freezing on stored water in till, or marine basal ice. (Note that the water that is frozen-on as ice might be quite "old" in the sense that its most recent time in the atmosphere was long ago; this comment is relevant to any analysis which relates isotope ratios to modeled age.)</p>
<p>The numerical method is a conservative form of first-order upwinding, but the vertical advection term is computed implicitly. Thus there is no CFL-type stability condition from the vertical velocity; CFL is only for the horizontal velocity. We use a finely-spaced, equally-spaced vertical grid in the calculation. Note that the <a class="el" href="classpism_1_1columnSystemCtx.html" title="Base class for tridiagonal systems in the ice.">columnSystemCtx</a> methods coarse_to_fine() and fine_to_coarse() interpolate back and forth between this fine grid and the storage grid. The storage grid may or may not be equally-spaced. See <a class="el" href="classpism_1_1AgeColumnSystem_ae4c72554404675fc0f564ec401033020.html#ae4c72554404675fc0f564ec401033020" title="First-order upwind scheme with implicit in the vertical: one column solve.">AgeColumnSystem::solve()</a> for the actual method. </p>

<p class="definition">Definition at line <a class="el" href="AgeModel_8cc_source.html#l00108">108</a> of file <a class="el" href="AgeModel_8cc_source.html">AgeModel.cc</a>.</p>

<p class="reference">References <a class="el" href="error__handling_8cc_source.html#l00201">pism::ParallelSection::check()</a>, <a class="el" href="AgeModel_8cc_source.html#l00050">pism::AgeModelInputs::check()</a>, <a class="el" href="Element_8cc_source.html#l00051">pism::fem::column()</a>, <a class="el" href="Array3D_8cc_source.html#l00208">pism::array::Array3D::copy_from()</a>, <a class="el" href="error__handling_8cc_source.html#l00185">pism::ParallelSection::failed()</a>, <a class="el" href="ColumnSystem_8cc_source.html#l00287">pism::columnSystemCtx::fine_to_coarse()</a>, <a class="el" href="Array3D_8cc_source.html#l00120">pism::array::Array3D::get_column()</a>, <a class="el" href="AgeModel_8hh_source.html#l00038">pism::AgeModelInputs::ice_thickness</a>, <a class="el" href="AgeColumnSystem_8cc_source.html#l00045">pism::AgeColumnSystem::init()</a>, <a class="el" href="exactTestP_8cc_source.html#l00042">pism::k</a>, <a class="el" href="ColumnSystem_8cc_source.html#l00275">pism::columnSystemCtx::ks()</a>, <a class="el" href="Component_8hh_source.html#l00156">pism::Component::m_grid</a>, <a class="el" href="AgeModel_8hh_source.html#l00059">m_ice_age</a>, <a class="el" href="AgeModel_8hh_source.html#l00060">m_work</a>, <a class="el" href="Array3D_8cc_source.html#l00049">pism::array::Array3D::set_column()</a>, <a class="el" href="AgeColumnSystem_8cc_source.html#l00068">pism::AgeColumnSystem::solve()</a>, <a class="el" href="AgeModel_8hh_source.html#l00039">pism::AgeModelInputs::u3</a>, <a class="el" href="AgeModel_8hh_source.html#l00040">pism::AgeModelInputs::v3</a>, <a class="el" href="AgeModel_8hh_source.html#l00041">pism::AgeModelInputs::w3</a>, and <a class="el" href="ColumnSystem_8cc_source.html#l00283">pism::columnSystemCtx::z()</a>.</p>

</div>
</div>
    </td>
  </tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
